parser = argparse.ArgumentParser()
parser.add_argument('--t0', type=int, default=0, help='temps initial')
parser.add_argument('--t_final', type=int, default=1, help='temps final')
parser.add_argument('--N', type=int, default=20, help='Number of time step')
parser.add_argument('--dim', type=int, default=10, help='dimension')
parser.add_argument('--num_samples_hjb', type=int, default=512, help='Number of Samples for training HJB')
parser.add_argument('--num_samples_mfg', type=int, default=512, help='Number of Samples for training MFG')
parser.add_argument('--num_samples_bvp', type=int, default=128, help='Number of Samples for  BVP')
parser.add_argument('--num_samples_gen', type=int, default=256, help='Number of Samples for training Generator')
parser.add_argument('--num_samples_conv', type=int, default=256, help='Number of Samples for compute convolution')
parser.add_argument('--num_points_test', type=int, default=10000)
parser.add_argument('--Max_Round', type=float, default=1, help='Number of Round')
parser.add_argument('--num_epoch_hjb', type=float, default=3000, help='Number of training iterations for approximate HJB')
parser.add_argument('--num_epoch_mfg', type=float, default=3000, help='Number of training iterations for approximate MFG')
parser.add_argument('--num_epoch_v', type=float, default=3000, help='Number of training iterations for approximate V')
parser.add_argument('--num_epoch_gen', type=float, default=3000, help='Number of training iterations for approximate GEN')
parser.add_argument('--freq', type=float, default=1000)
parser.add_argument('--ns_v', default=128, help='Network size of V_net')
parser.add_argument('--ns_g', default=128, help='Network sizeof G_net')
parser.add_argument('--lr', default=1e-3, help='learning rate of MFG')
parser.add_argument('--lr_v', default=1e-3, help='learning rate of V')
parser.add_argument('--lr_v2', default=1e-3, help='learning rate of V')
parser.add_argument('--lr_g', default=1e-4, help='learning rate of G')
parser.add_argument('--betas', default=(0.5, 0.9), help='Adam only')
parser.add_argument('--weight_decay',default=1e-3)
parser.add_argument('--act_func_v',default= lambda x: torch.tanh(x), help='Activation function for v')
parser.add_argument('--act_func_g',default= lambda x: torch.relu(x), help='Activation function for g')
parser.add_argument('--hh', default=0.5, help='ResNet step-size')
args = parser.parse_args()








Round:  0 


 Computing The Best Response 0: 

Approximate solution of MFG 

Starting Joint Training of V and G (MFG)...
Iteration 0: Loss_HJB = 4.7612e+01, Loss_ODE = 1.9068e-01
Iteration 1000: Loss_HJB = 2.3221e-01, Loss_ODE = 4.2394e-04
Iteration 2000: Loss_HJB = 5.8756e-02, Loss_ODE = 2.6217e-04
Iteration 3000: Loss_HJB = 2.9253e-02, Loss_ODE = 2.2828e-04


Time t = 0.0
  Relative L2 Error    = 2.9520e-02
  Relative Linf Error  = 9.2071e-02

Time t = 0.5
  Relative L2 Error    = 2.1719e-02
  Relative Linf Error  = 6.1721e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 12471 data from 128/128 BVP solutions in 15.7 sec
  → Speed: 8.2 BVP/sec, 797 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 9.2614e-03, Loss_V_x = 4.4820e-03, Loss_HJB = 3.9287e-02, Loss_total = 3.3387e-02
Iteration 1000: Loss_V = 2.3774e-03, Loss_V_x = 9.9660e-04, Loss_HJB = 6.5152e-03, Loss_total = 6.6316e-03
Iteration 2000: Loss_V = 1.5866e-04, Loss_V_x = 6.7319e-04, Loss_HJB = 3.2821e-04, Loss_total = 9.9595e-04
Iteration 3000: Loss_V = 1.0339e-04, Loss_V_x = 5.0570e-04, Loss_HJB = 2.9612e-04, Loss_total = 7.5715e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 14.4 sec 

Iteration 0:  Loss_G = 4.6589e-04,  Loss_ODE = 1.8502e-03,  Loss_total = 6.5091e-04
Iteration 1000:  Loss_G = 1.2278e-05,  Loss_ODE = 1.1837e-04,  Loss_total = 2.4115e-05
Iteration 2000:  Loss_G = 7.6222e-06,  Loss_ODE = 6.4489e-05,  Loss_total = 1.4071e-05
Iteration 3000:  Loss_G = 5.6183e-06,  Loss_ODE = 5.3189e-05,  Loss_total = 1.0937e-05


Time t = 0.0
  Relative L2 Error    = 1.5768e-02
  Relative Linf Error  = 4.6586e-02

Time t = 0.5
  Relative L2 Error    = 1.6187e-02
  Relative Linf Error  = 7.2386e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  0 │ L1=2.832e-02 │ L2=7.309e-03 │ L∞=2.368e-03

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 12101 data from 128/128 BVP solutions in 15.1 sec
  → Speed: 8.4 BVP/sec, 799 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 7.8454e+00, Loss_V_x = 2.7483e-01, Loss_total = 8.1202e+00
Iteration 1000: Loss_V = 1.0953e-03, Loss_V_x = 4.4543e-03, Loss_total = 5.5496e-03
Iteration 2000: Loss_V = 1.8180e-04, Loss_V_x = 1.5134e-03, Loss_total = 1.6952e-03
Iteration 3000: Loss_V = 9.3666e-05, Loss_V_x = 9.0541e-04, Loss_total = 9.9907e-04


The Exploitibility is : 0.0827590823173523

 Computing The Best Response 1: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 12087 data from 128/128 BVP solutions in 18.9 sec
  → Speed: 6.8 BVP/sec, 641 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.4956e-03, Loss_V_x = 8.4678e-04, Loss_HJB = 3.0231e-02, Loss_total = 1.7458e-02
Iteration 1000: Loss_V = 2.0287e-04, Loss_V_x = 5.6650e-04, Loss_HJB = 5.3375e-04, Loss_total = 1.0362e-03
Iteration 2000: Loss_V = 2.4103e-04, Loss_V_x = 4.3589e-04, Loss_HJB = 8.7238e-04, Loss_total = 1.1131e-03
Iteration 3000: Loss_V = 6.0406e-05, Loss_V_x = 3.5740e-04, Loss_HJB = 1.2592e-04, Loss_total = 4.8077e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 14.3 sec 

Iteration 0:  Loss_G = 5.9383e-05,  Loss_ODE = 5.4212e-04,  Loss_total = 1.1360e-04
Iteration 1000:  Loss_G = 7.0736e-06,  Loss_ODE = 6.7590e-05,  Loss_total = 1.3833e-05
Iteration 2000:  Loss_G = 4.6736e-06,  Loss_ODE = 4.6395e-05,  Loss_total = 9.3131e-06
Iteration 3000:  Loss_G = 3.9766e-06,  Loss_ODE = 3.8418e-05,  Loss_total = 7.8183e-06


Time t = 0.0
  Relative L2 Error    = 1.4043e-02
  Relative Linf Error  = 5.5705e-02

Time t = 0.5
  Relative L2 Error    = 1.4952e-02
  Relative Linf Error  = 5.3574e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  1 │ L1=1.058e-02 │ L2=2.711e-03 │ L∞=8.917e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11892 data from 128/128 BVP solutions in 15.3 sec
  → Speed: 8.4 BVP/sec, 779 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 7.2588e-02, Loss_V_x = 1.9765e-02, Loss_total = 9.2352e-02
Iteration 1000: Loss_V = 3.8256e-04, Loss_V_x = 1.6745e-03, Loss_total = 2.0571e-03
Iteration 2000: Loss_V = 7.6915e-05, Loss_V_x = 7.7379e-04, Loss_total = 8.5071e-04
Iteration 3000: Loss_V = 5.2608e-05, Loss_V_x = 5.1062e-04, Loss_total = 5.6323e-04


The Exploitibility is : 0.024064332246780396

 Computing The Best Response 2: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11969 data from 128/128 BVP solutions in 21.7 sec
  → Speed: 5.9 BVP/sec, 552 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.0409e-03, Loss_V_x = 5.8767e-04, Loss_HJB = 2.6467e-02, Loss_total = 1.4862e-02
Iteration 1000: Loss_V = 1.8702e-04, Loss_V_x = 4.5172e-04, Loss_HJB = 5.1320e-04, Loss_total = 8.9533e-04
Iteration 2000: Loss_V = 9.0907e-05, Loss_V_x = 3.1866e-04, Loss_HJB = 2.1734e-04, Loss_total = 5.1824e-04
Iteration 3000: Loss_V = 4.4644e-04, Loss_V_x = 2.6184e-04, Loss_HJB = 1.3116e-03, Loss_total = 1.3641e-03


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 14.6 sec 

Iteration 0:  Loss_G = 5.9057e-05,  Loss_ODE = 4.7327e-04,  Loss_total = 1.0638e-04
Iteration 1000:  Loss_G = 6.3225e-06,  Loss_ODE = 5.8870e-05,  Loss_total = 1.2209e-05
Iteration 2000:  Loss_G = 4.4955e-06,  Loss_ODE = 4.2705e-05,  Loss_total = 8.7661e-06
Iteration 3000:  Loss_G = 3.8706e-06,  Loss_ODE = 3.9080e-05,  Loss_total = 7.7786e-06


Time t = 0.0
  Relative L2 Error    = 1.3346e-02
  Relative Linf Error  = 3.7776e-02

Time t = 0.5
  Relative L2 Error    = 1.4602e-02
  Relative Linf Error  = 3.3679e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  2 │ L1=7.951e-03 │ L2=2.017e-03 │ L∞=6.533e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11951 data from 128/128 BVP solutions in 15.4 sec
  → Speed: 8.3 BVP/sec, 774 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.2836e-02, Loss_V_x = 6.0032e-03, Loss_total = 1.8839e-02
Iteration 1000: Loss_V = 1.1830e-04, Loss_V_x = 1.1427e-03, Loss_total = 1.2610e-03
Iteration 2000: Loss_V = 6.8398e-05, Loss_V_x = 6.1117e-04, Loss_total = 6.7957e-04
Iteration 3000: Loss_V = 1.1781e-03, Loss_V_x = 4.3184e-04, Loss_total = 1.6099e-03


The Exploitibility is : 0.06348311901092529

 Computing The Best Response 3: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11905 data from 128/128 BVP solutions in 26.3 sec
  → Speed: 4.9 BVP/sec, 453 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.2983e-03, Loss_V_x = 4.0733e-04, Loss_HJB = 1.6887e-02, Loss_total = 1.0149e-02
Iteration 1000: Loss_V = 9.5019e-05, Loss_V_x = 3.4111e-04, Loss_HJB = 3.6040e-04, Loss_total = 6.1633e-04
Iteration 2000: Loss_V = 6.0629e-05, Loss_V_x = 2.7192e-04, Loss_HJB = 1.5389e-04, Loss_total = 4.0949e-04
Iteration 3000: Loss_V = 3.2256e-04, Loss_V_x = 2.6471e-04, Loss_HJB = 2.4438e-03, Loss_total = 1.8092e-03


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 15.0 sec 

Iteration 0:  Loss_G = 5.0615e-05,  Loss_ODE = 4.3029e-04,  Loss_total = 9.3644e-05
Iteration 1000:  Loss_G = 6.0451e-06,  Loss_ODE = 5.6401e-05,  Loss_total = 1.1685e-05
Iteration 2000:  Loss_G = 4.2690e-06,  Loss_ODE = 4.0530e-05,  Loss_total = 8.3220e-06
Iteration 3000:  Loss_G = 3.9687e-06,  Loss_ODE = 4.0327e-05,  Loss_total = 8.0014e-06


Time t = 0.0
  Relative L2 Error    = 1.8996e-02
  Relative Linf Error  = 5.0722e-02

Time t = 0.5
  Relative L2 Error    = 1.7906e-02
  Relative Linf Error  = 3.8075e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  3 │ L1=6.685e-03 │ L2=1.683e-03 │ L∞=5.326e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11796 data from 128/128 BVP solutions in 15.2 sec
  → Speed: 8.4 BVP/sec, 774 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 7.4364e-03, Loss_V_x = 3.2949e-03, Loss_total = 1.0731e-02
Iteration 1000: Loss_V = 1.0332e-04, Loss_V_x = 8.0118e-04, Loss_total = 9.0450e-04
Iteration 2000: Loss_V = 4.6427e-03, Loss_V_x = 4.8340e-04, Loss_total = 5.1261e-03
Iteration 3000: Loss_V = 4.3295e-04, Loss_V_x = 3.2240e-04, Loss_total = 7.5535e-04


The Exploitibility is : 0.09722593426704407

 Computing The Best Response 4: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11840 data from 128/128 BVP solutions in 30.7 sec
  → Speed: 4.2 BVP/sec, 386 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.7222e-03, Loss_V_x = 4.0288e-04, Loss_HJB = 2.6561e-02, Loss_total = 1.7406e-02
Iteration 1000: Loss_V = 1.1010e-04, Loss_V_x = 2.8081e-04, Loss_HJB = 3.7486e-04, Loss_total = 5.7834e-04
Iteration 2000: Loss_V = 5.8764e-05, Loss_V_x = 2.2166e-04, Loss_HJB = 1.2743e-04, Loss_total = 3.4415e-04
Iteration 3000: Loss_V = 4.5266e-05, Loss_V_x = 2.0957e-04, Loss_HJB = 1.2849e-04, Loss_total = 3.1908e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 15.5 sec 

Iteration 0:  Loss_G = 4.0516e-05,  Loss_ODE = 4.5327e-04,  Loss_total = 8.5843e-05
Iteration 1000:  Loss_G = 5.3096e-06,  Loss_ODE = 5.3180e-05,  Loss_total = 1.0628e-05
Iteration 2000:  Loss_G = 3.9124e-06,  Loss_ODE = 4.2138e-05,  Loss_total = 8.1262e-06
Iteration 3000:  Loss_G = 3.6863e-06,  Loss_ODE = 4.3072e-05,  Loss_total = 7.9935e-06


Time t = 0.0
  Relative L2 Error    = 9.6850e-03
  Relative Linf Error  = 2.9585e-02

Time t = 0.5
  Relative L2 Error    = 1.0463e-02
  Relative Linf Error  = 3.3251e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  4 │ L1=5.043e-03 │ L2=1.269e-03 │ L∞=4.247e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11669 data from 128/128 BVP solutions in 15.1 sec
  → Speed: 8.5 BVP/sec, 772 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.4194e-03, Loss_V_x = 2.1816e-03, Loss_total = 5.6010e-03
Iteration 1000: Loss_V = 7.0853e-05, Loss_V_x = 6.9047e-04, Loss_total = 7.6132e-04
Iteration 2000: Loss_V = 1.7190e-04, Loss_V_x = 4.1381e-04, Loss_total = 5.8570e-04
Iteration 3000: Loss_V = 6.1992e-05, Loss_V_x = 2.8871e-04, Loss_total = 3.5070e-04


The Exploitibility is : 0.061574339866638184

 Computing The Best Response 5: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11671 data from 128/128 BVP solutions in 35.2 sec
  → Speed: 3.6 BVP/sec, 331 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 6.9762e-04, Loss_V_x = 3.4227e-04, Loss_HJB = 1.8484e-02, Loss_total = 1.0282e-02
Iteration 1000: Loss_V = 1.0097e-04, Loss_V_x = 2.5303e-04, Loss_HJB = 3.2477e-04, Loss_total = 5.1638e-04
Iteration 2000: Loss_V = 1.3049e-03, Loss_V_x = 1.9523e-04, Loss_HJB = 3.6824e-03, Loss_total = 3.3414e-03
Iteration 3000: Loss_V = 3.6480e-05, Loss_V_x = 1.6404e-04, Loss_HJB = 5.8766e-05, Loss_total = 2.2990e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 15.9 sec 

Iteration 0:  Loss_G = 3.5877e-05,  Loss_ODE = 4.1633e-04,  Loss_total = 7.7510e-05
Iteration 1000:  Loss_G = 5.1172e-06,  Loss_ODE = 6.4009e-05,  Loss_total = 1.1518e-05
Iteration 2000:  Loss_G = 4.3444e-06,  Loss_ODE = 4.7458e-05,  Loss_total = 9.0902e-06
Iteration 3000:  Loss_G = 3.9924e-06,  Loss_ODE = 4.7695e-05,  Loss_total = 8.7619e-06


Time t = 0.0
  Relative L2 Error    = 8.4157e-03
  Relative Linf Error  = 4.4810e-02

Time t = 0.5
  Relative L2 Error    = 1.0010e-02
  Relative Linf Error  = 3.3560e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  5 │ L1=5.217e-03 │ L2=1.304e-03 │ L∞=4.181e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11812 data from 128/128 BVP solutions in 13.8 sec
  → Speed: 9.3 BVP/sec, 855 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.8659e-03, Loss_V_x = 1.5914e-03, Loss_total = 4.4573e-03
Iteration 1000: Loss_V = 7.1543e-05, Loss_V_x = 5.3203e-04, Loss_total = 6.0357e-04
Iteration 2000: Loss_V = 1.4086e-03, Loss_V_x = 3.5260e-04, Loss_total = 1.7612e-03
Iteration 3000: Loss_V = 6.4660e-05, Loss_V_x = 2.6691e-04, Loss_total = 3.3157e-04


The Exploitibility is : 0.042384594678878784

 Computing The Best Response 6: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11722 data from 128/128 BVP solutions in 38.3 sec
  → Speed: 3.3 BVP/sec, 306 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.2306e-04, Loss_V_x = 2.6377e-04, Loss_HJB = 1.3139e-02, Loss_total = 7.2565e-03
Iteration 1000: Loss_V = 1.0025e-04, Loss_V_x = 2.0648e-04, Loss_HJB = 2.8795e-04, Loss_total = 4.5070e-04
Iteration 2000: Loss_V = 4.6602e-05, Loss_V_x = 1.7921e-04, Loss_HJB = 9.6687e-05, Loss_total = 2.7416e-04
Iteration 3000: Loss_V = 3.8313e-05, Loss_V_x = 1.6769e-04, Loss_HJB = 9.1029e-05, Loss_total = 2.5152e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 15.1 sec 

Iteration 0:  Loss_G = 3.7811e-05,  Loss_ODE = 4.2315e-04,  Loss_total = 8.0126e-05
Iteration 1000:  Loss_G = 5.6755e-06,  Loss_ODE = 6.5864e-05,  Loss_total = 1.2262e-05
Iteration 2000:  Loss_G = 4.6087e-06,  Loss_ODE = 4.9922e-05,  Loss_total = 9.6009e-06
Iteration 3000:  Loss_G = 4.2361e-06,  Loss_ODE = 5.4532e-05,  Loss_total = 9.6893e-06


Time t = 0.0
  Relative L2 Error    = 8.1843e-03
  Relative Linf Error  = 2.7978e-02

Time t = 0.5
  Relative L2 Error    = 8.5523e-03
  Relative Linf Error  = 2.5295e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  6 │ L1=4.012e-03 │ L2=1.007e-03 │ L∞=3.388e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11799 data from 128/128 BVP solutions in 15.4 sec
  → Speed: 8.3 BVP/sec, 766 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.2569e-03, Loss_V_x = 1.5140e-03, Loss_total = 5.7709e-03
Iteration 1000: Loss_V = 5.9688e-05, Loss_V_x = 4.8079e-04, Loss_total = 5.4048e-04
Iteration 2000: Loss_V = 3.4068e-05, Loss_V_x = 2.8288e-04, Loss_total = 3.1695e-04
Iteration 3000: Loss_V = 3.0137e-05, Loss_V_x = 2.2154e-04, Loss_total = 2.5168e-04


The Exploitibility is : 0.050100088119506836

 Computing The Best Response 7: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11687 data from 128/128 BVP solutions in 42.7 sec
  → Speed: 3.0 BVP/sec, 274 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.0019e-04, Loss_V_x = 2.2063e-04, Loss_HJB = 1.0843e-02, Loss_total = 6.0423e-03
Iteration 1000: Loss_V = 4.9053e-05, Loss_V_x = 1.7079e-04, Loss_HJB = 1.5586e-04, Loss_total = 2.9777e-04
Iteration 2000: Loss_V = 3.6666e-05, Loss_V_x = 1.5128e-04, Loss_HJB = 1.0590e-04, Loss_total = 2.4090e-04
Iteration 3000: Loss_V = 2.8834e-05, Loss_V_x = 1.4012e-04, Loss_HJB = 6.7870e-05, Loss_total = 2.0288e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 15.2 sec 

Iteration 0:  Loss_G = 3.2710e-05,  Loss_ODE = 3.9929e-04,  Loss_total = 7.2639e-05
Iteration 1000:  Loss_G = 5.3967e-06,  Loss_ODE = 6.0931e-05,  Loss_total = 1.1490e-05
Iteration 2000:  Loss_G = 4.1192e-06,  Loss_ODE = 4.9067e-05,  Loss_total = 9.0259e-06
Iteration 3000:  Loss_G = 4.0891e-06,  Loss_ODE = 5.1280e-05,  Loss_total = 9.2172e-06


Time t = 0.0
  Relative L2 Error    = 7.5007e-03
  Relative Linf Error  = 2.3255e-02

Time t = 0.5
  Relative L2 Error    = 8.9544e-03
  Relative Linf Error  = 2.7274e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  7 │ L1=3.545e-03 │ L2=8.869e-04 │ L∞=2.940e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11847 data from 128/128 BVP solutions in 14.6 sec
  → Speed: 8.7 BVP/sec, 809 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.8290e-03, Loss_V_x = 1.1621e-03, Loss_total = 2.9910e-03
Iteration 1000: Loss_V = 6.1699e-05, Loss_V_x = 4.4445e-04, Loss_total = 5.0615e-04
Iteration 2000: Loss_V = 6.8576e-05, Loss_V_x = 2.8586e-04, Loss_total = 3.5444e-04
Iteration 3000: Loss_V = 2.8362e-05, Loss_V_x = 2.2454e-04, Loss_total = 2.5290e-04


The Exploitibility is : 0.041086792945861816

 Computing The Best Response 8: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11756 data from 128/128 BVP solutions in 47.1 sec
  → Speed: 2.7 BVP/sec, 250 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 5.6556e-04, Loss_V_x = 2.4626e-04, Loss_HJB = 1.0512e-02, Loss_total = 6.0677e-03
Iteration 1000: Loss_V = 5.9346e-05, Loss_V_x = 1.8478e-04, Loss_HJB = 1.4647e-04, Loss_total = 3.1736e-04
Iteration 2000: Loss_V = 1.4160e-04, Loss_V_x = 1.4301e-04, Loss_HJB = 3.7213e-04, Loss_total = 4.7068e-04
Iteration 3000: Loss_V = 5.9427e-05, Loss_V_x = 1.2652e-04, Loss_HJB = 1.7074e-04, Loss_total = 2.7132e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 18.5 sec 

Iteration 0:  Loss_G = 3.3466e-05,  Loss_ODE = 4.9101e-04,  Loss_total = 8.2567e-05
Iteration 1000:  Loss_G = 6.0013e-06,  Loss_ODE = 7.4052e-05,  Loss_total = 1.3407e-05
Iteration 2000:  Loss_G = 4.7711e-06,  Loss_ODE = 5.8332e-05,  Loss_total = 1.0604e-05
Iteration 3000:  Loss_G = 4.4538e-06,  Loss_ODE = 5.6797e-05,  Loss_total = 1.0133e-05


Time t = 0.0
  Relative L2 Error    = 7.7204e-03
  Relative Linf Error  = 2.7151e-02

Time t = 0.5
  Relative L2 Error    = 8.2563e-03
  Relative Linf Error  = 2.7364e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  8 │ L1=3.289e-03 │ L2=8.210e-04 │ L∞=2.645e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11786 data from 128/128 BVP solutions in 15.0 sec
  → Speed: 8.5 BVP/sec, 786 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.7435e-03, Loss_V_x = 1.0390e-03, Loss_total = 2.7825e-03
Iteration 1000: Loss_V = 5.1332e-05, Loss_V_x = 3.8976e-04, Loss_total = 4.4109e-04
Iteration 2000: Loss_V = 3.2613e-05, Loss_V_x = 2.4658e-04, Loss_total = 2.7919e-04
Iteration 3000: Loss_V = 2.6571e-05, Loss_V_x = 1.9630e-04, Loss_total = 2.2287e-04


The Exploitibility is : 0.0670396089553833

 Computing The Best Response 9: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11671 data from 128/128 BVP solutions in 52.0 sec
  → Speed: 2.5 BVP/sec, 225 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.7035e-04, Loss_V_x = 1.9708e-04, Loss_HJB = 1.1838e-02, Loss_total = 6.4863e-03
Iteration 1000: Loss_V = 7.0736e-05, Loss_V_x = 1.8104e-04, Loss_HJB = 2.2009e-04, Loss_total = 3.6182e-04
Iteration 2000: Loss_V = 3.6005e-04, Loss_V_x = 1.4571e-04, Loss_HJB = 1.1092e-03, Loss_total = 1.0604e-03
Iteration 3000: Loss_V = 2.9332e-05, Loss_V_x = 1.2947e-04, Loss_HJB = 6.4376e-05, Loss_total = 1.9099e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.8 sec 

Iteration 0:  Loss_G = 2.8052e-05,  Loss_ODE = 4.2936e-04,  Loss_total = 7.0989e-05
Iteration 1000:  Loss_G = 5.3678e-06,  Loss_ODE = 6.8038e-05,  Loss_total = 1.2172e-05
Iteration 2000:  Loss_G = 4.6407e-06,  Loss_ODE = 5.9502e-05,  Loss_total = 1.0591e-05
Iteration 3000:  Loss_G = 4.4693e-06,  Loss_ODE = 5.9224e-05,  Loss_total = 1.0392e-05


Time t = 0.0
  Relative L2 Error    = 7.8291e-03
  Relative Linf Error  = 4.0680e-02

Time t = 0.5
  Relative L2 Error    = 8.5602e-03
  Relative Linf Error  = 3.9622e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  9 │ L1=3.523e-03 │ L2=8.836e-04 │ L∞=2.976e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11632 data from 128/128 BVP solutions in 14.5 sec
  → Speed: 8.8 BVP/sec, 802 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.3844e-03, Loss_V_x = 7.6433e-04, Loss_total = 2.1487e-03
Iteration 1000: Loss_V = 4.9955e-05, Loss_V_x = 3.2314e-04, Loss_total = 3.7309e-04
Iteration 2000: Loss_V = 8.8369e-05, Loss_V_x = 2.1760e-04, Loss_total = 3.0597e-04
Iteration 3000: Loss_V = 4.1093e-03, Loss_V_x = 2.3038e-04, Loss_total = 4.3397e-03


The Exploitibility is : 0.023511230945587158

 Computing The Best Response 10: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11646 data from 128/128 BVP solutions in 56.2 sec
  → Speed: 2.3 BVP/sec, 207 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.6848e-04, Loss_V_x = 2.2035e-04, Loss_HJB = 1.0028e-02, Loss_total = 5.6027e-03
Iteration 1000: Loss_V = 5.7003e-05, Loss_V_x = 1.6762e-04, Loss_HJB = 1.7122e-04, Loss_total = 3.1023e-04
Iteration 2000: Loss_V = 1.0251e-04, Loss_V_x = 1.4226e-04, Loss_HJB = 3.1632e-04, Loss_total = 4.0293e-04
Iteration 3000: Loss_V = 4.1195e-05, Loss_V_x = 1.2845e-04, Loss_HJB = 8.9670e-05, Loss_total = 2.1448e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.9 sec 

Iteration 0:  Loss_G = 3.2371e-05,  Loss_ODE = 4.1129e-04,  Loss_total = 7.3500e-05
Iteration 1000:  Loss_G = 6.2507e-06,  Loss_ODE = 7.7808e-05,  Loss_total = 1.4031e-05
Iteration 2000:  Loss_G = 5.1934e-06,  Loss_ODE = 7.1743e-05,  Loss_total = 1.2368e-05
Iteration 3000:  Loss_G = 5.1457e-06,  Loss_ODE = 7.4827e-05,  Loss_total = 1.2628e-05


Time t = 0.0
  Relative L2 Error    = 7.2061e-03
  Relative Linf Error  = 2.4184e-02

Time t = 0.5
  Relative L2 Error    = 7.9001e-03
  Relative Linf Error  = 2.5233e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 10 │ L1=3.187e-03 │ L2=7.978e-04 │ L∞=2.618e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11937 data from 128/128 BVP solutions in 14.9 sec
  → Speed: 8.6 BVP/sec, 803 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.4229e-02, Loss_V_x = 1.4062e-03, Loss_total = 1.5635e-02
Iteration 1000: Loss_V = 3.7585e-05, Loss_V_x = 3.0908e-04, Loss_total = 3.4666e-04
Iteration 2000: Loss_V = 1.4490e-04, Loss_V_x = 1.9688e-04, Loss_total = 3.4178e-04
Iteration 3000: Loss_V = 2.1684e-05, Loss_V_x = 1.6251e-04, Loss_total = 1.8420e-04


The Exploitibility is : 0.020657241344451904

 Computing The Best Response 11: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11693 data from 128/128 BVP solutions in 61.1 sec
  → Speed: 2.1 BVP/sec, 191 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.5431e-04, Loss_V_x = 1.9523e-04, Loss_HJB = 1.0806e-02, Loss_total = 5.8527e-03
Iteration 1000: Loss_V = 5.4718e-05, Loss_V_x = 1.5327e-04, Loss_HJB = 1.8634e-04, Loss_total = 3.0116e-04
Iteration 2000: Loss_V = 1.8552e-04, Loss_V_x = 1.3341e-04, Loss_HJB = 5.2741e-04, Loss_total = 5.8264e-04
Iteration 3000: Loss_V = 2.4310e-05, Loss_V_x = 1.1614e-04, Loss_HJB = 3.9435e-05, Loss_total = 1.6017e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.7 sec 

Iteration 0:  Loss_G = 3.4860e-05,  Loss_ODE = 5.3295e-04,  Loss_total = 8.8155e-05
Iteration 1000:  Loss_G = 6.3710e-06,  Loss_ODE = 9.0580e-05,  Loss_total = 1.5429e-05
Iteration 2000:  Loss_G = 5.7337e-06,  Loss_ODE = 8.0110e-05,  Loss_total = 1.3745e-05
Iteration 3000:  Loss_G = 5.3061e-06,  Loss_ODE = 7.2038e-05,  Loss_total = 1.2510e-05


Time t = 0.0
  Relative L2 Error    = 7.2050e-03
  Relative Linf Error  = 2.8699e-02

Time t = 0.5
  Relative L2 Error    = 8.1912e-03
  Relative Linf Error  = 2.5816e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 11 │ L1=2.831e-03 │ L2=7.071e-04 │ L∞=2.230e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11701 data from 128/128 BVP solutions in 15.8 sec
  → Speed: 8.1 BVP/sec, 742 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.9900e-03, Loss_V_x = 9.4688e-04, Loss_total = 2.9369e-03
Iteration 1000: Loss_V = 3.8265e-05, Loss_V_x = 3.3231e-04, Loss_total = 3.7057e-04
Iteration 2000: Loss_V = 2.5337e-05, Loss_V_x = 2.0894e-04, Loss_total = 2.3428e-04
Iteration 3000: Loss_V = 2.0917e-05, Loss_V_x = 1.6603e-04, Loss_total = 1.8694e-04


The Exploitibility is : 0.050602227449417114

 Computing The Best Response 12: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11691 data from 128/128 BVP solutions in 65.7 sec
  → Speed: 1.9 BVP/sec, 178 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.1977e-04, Loss_V_x = 1.9221e-04, Loss_HJB = 1.1112e-02, Loss_total = 6.0680e-03
Iteration 1000: Loss_V = 5.3177e-05, Loss_V_x = 1.4933e-04, Loss_HJB = 1.6688e-04, Loss_total = 2.8594e-04
Iteration 2000: Loss_V = 2.9673e-05, Loss_V_x = 1.2440e-04, Loss_HJB = 1.0416e-04, Loss_total = 2.0615e-04
Iteration 3000: Loss_V = 2.7900e-05, Loss_V_x = 1.1594e-04, Loss_HJB = 7.4921e-05, Loss_total = 1.8130e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 14.0 sec 

Iteration 0:  Loss_G = 3.0547e-05,  Loss_ODE = 4.3762e-04,  Loss_total = 7.4309e-05
Iteration 1000:  Loss_G = 6.0833e-06,  Loss_ODE = 9.0454e-05,  Loss_total = 1.5129e-05
Iteration 2000:  Loss_G = 5.3582e-06,  Loss_ODE = 8.0036e-05,  Loss_total = 1.3362e-05
Iteration 3000:  Loss_G = 5.4008e-06,  Loss_ODE = 8.2140e-05,  Loss_total = 1.3615e-05


Time t = 0.0
  Relative L2 Error    = 6.8458e-03
  Relative Linf Error  = 2.8180e-02

Time t = 0.5
  Relative L2 Error    = 7.4239e-03
  Relative Linf Error  = 2.8742e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 12 │ L1=2.009e-03 │ L2=4.987e-04 │ L∞=1.667e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11858 data from 128/128 BVP solutions in 15.3 sec
  → Speed: 8.4 BVP/sec, 776 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.0431e-03, Loss_V_x = 8.6847e-04, Loss_total = 2.9116e-03
Iteration 1000: Loss_V = 4.6249e-05, Loss_V_x = 2.9320e-04, Loss_total = 3.3945e-04
Iteration 2000: Loss_V = 3.0999e-05, Loss_V_x = 1.8065e-04, Loss_total = 2.1165e-04
Iteration 3000: Loss_V = 2.5161e-05, Loss_V_x = 1.4414e-04, Loss_total = 1.6930e-04


The Exploitibility is : 0.040632426738739014

 Computing The Best Response 13: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11745 data from 128/128 BVP solutions in 70.2 sec
  → Speed: 1.8 BVP/sec, 167 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.9385e-04, Loss_V_x = 1.9485e-04, Loss_HJB = 9.5302e-03, Loss_total = 5.3538e-03
Iteration 1000: Loss_V = 4.8788e-05, Loss_V_x = 1.5739e-04, Loss_HJB = 1.6237e-04, Loss_total = 2.8736e-04
Iteration 2000: Loss_V = 2.8656e-05, Loss_V_x = 1.2512e-04, Loss_HJB = 7.5632e-05, Loss_total = 1.9160e-04
Iteration 3000: Loss_V = 2.2119e-04, Loss_V_x = 1.2014e-04, Loss_HJB = 6.8860e-04, Loss_total = 6.8564e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 14.2 sec 

Iteration 0:  Loss_G = 3.5246e-05,  Loss_ODE = 4.9376e-04,  Loss_total = 8.4622e-05
Iteration 1000:  Loss_G = 6.9282e-06,  Loss_ODE = 1.0355e-04,  Loss_total = 1.7283e-05
Iteration 2000:  Loss_G = 6.0917e-06,  Loss_ODE = 9.5531e-05,  Loss_total = 1.5645e-05
Iteration 3000:  Loss_G = 5.9044e-06,  Loss_ODE = 8.8453e-05,  Loss_total = 1.4750e-05


Time t = 0.0
  Relative L2 Error    = 1.1190e-02
  Relative Linf Error  = 3.1915e-02

Time t = 0.5
  Relative L2 Error    = 1.1396e-02
  Relative Linf Error  = 2.9373e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 13 │ L1=2.285e-03 │ L2=5.678e-04 │ L∞=1.801e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11807 data from 128/128 BVP solutions in 14.5 sec
  → Speed: 8.8 BVP/sec, 813 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 8.6547e-04, Loss_V_x = 5.7266e-04, Loss_total = 1.4381e-03
Iteration 1000: Loss_V = 3.4227e-05, Loss_V_x = 2.1521e-04, Loss_total = 2.4944e-04
Iteration 2000: Loss_V = 2.2309e-05, Loss_V_x = 1.5430e-04, Loss_total = 1.7660e-04
Iteration 3000: Loss_V = 5.5583e-05, Loss_V_x = 1.2531e-04, Loss_total = 1.8090e-04


The Exploitibility is : 0.03892132639884949

 Computing The Best Response 14: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11666 data from 128/128 BVP solutions in 74.9 sec
  → Speed: 1.7 BVP/sec, 156 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.0730e-03, Loss_V_x = 1.6351e-04, Loss_HJB = 9.4174e-03, Loss_total = 5.9452e-03
Iteration 1000: Loss_V = 4.8034e-05, Loss_V_x = 1.2411e-04, Loss_HJB = 1.6355e-04, Loss_total = 2.5392e-04
Iteration 2000: Loss_V = 8.9701e-05, Loss_V_x = 1.1416e-04, Loss_HJB = 2.8142e-04, Loss_total = 3.4458e-04
Iteration 3000: Loss_V = 5.5819e-05, Loss_V_x = 9.9617e-05, Loss_HJB = 1.5173e-04, Loss_total = 2.3130e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.7 sec 

Iteration 0:  Loss_G = 2.9227e-05,  Loss_ODE = 4.8904e-04,  Loss_total = 7.8131e-05
Iteration 1000:  Loss_G = 6.8007e-06,  Loss_ODE = 1.0857e-04,  Loss_total = 1.7658e-05
Iteration 2000:  Loss_G = 5.8874e-06,  Loss_ODE = 9.2061e-05,  Loss_total = 1.5094e-05
Iteration 3000:  Loss_G = 6.1454e-06,  Loss_ODE = 9.8849e-05,  Loss_total = 1.6030e-05


Time t = 0.0
  Relative L2 Error    = 6.8628e-03
  Relative Linf Error  = 2.5332e-02

Time t = 0.5
  Relative L2 Error    = 7.9030e-03
  Relative Linf Error  = 2.9728e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 14 │ L1=2.299e-03 │ L2=5.785e-04 │ L∞=1.931e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11911 data from 128/128 BVP solutions in 16.1 sec
  → Speed: 8.0 BVP/sec, 740 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 8.6528e-04, Loss_V_x = 6.3948e-04, Loss_total = 1.5048e-03
Iteration 1000: Loss_V = 3.1830e-05, Loss_V_x = 2.4668e-04, Loss_total = 2.7851e-04
Iteration 2000: Loss_V = 2.0979e-05, Loss_V_x = 1.5462e-04, Loss_total = 1.7560e-04
Iteration 3000: Loss_V = 4.8864e-03, Loss_V_x = 1.5344e-04, Loss_total = 5.0398e-03


The Exploitibility is : 0.003999561071395874

 Computing The Best Response 15: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11577 data from 128/128 BVP solutions in 80.1 sec
  → Speed: 1.6 BVP/sec, 145 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.7317e-04, Loss_V_x = 1.5670e-04, Loss_HJB = 1.2618e-02, Loss_total = 6.7387e-03
Iteration 1000: Loss_V = 3.8231e-05, Loss_V_x = 1.2284e-04, Loss_HJB = 1.3878e-04, Loss_total = 2.3046e-04
Iteration 2000: Loss_V = 2.6378e-05, Loss_V_x = 1.0614e-04, Loss_HJB = 7.3291e-05, Loss_total = 1.6916e-04
Iteration 3000: Loss_V = 2.4146e-04, Loss_V_x = 9.6465e-05, Loss_HJB = 7.0298e-04, Loss_total = 6.8942e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.9 sec 

Iteration 0:  Loss_G = 3.2570e-05,  Loss_ODE = 5.2086e-04,  Loss_total = 8.4656e-05
Iteration 1000:  Loss_G = 7.1011e-06,  Loss_ODE = 1.1326e-04,  Loss_total = 1.8427e-05
Iteration 2000:  Loss_G = 6.3135e-06,  Loss_ODE = 1.0461e-04,  Loss_total = 1.6775e-05
Iteration 3000:  Loss_G = 6.0595e-06,  Loss_ODE = 1.1324e-04,  Loss_total = 1.7384e-05


Time t = 0.0
  Relative L2 Error    = 7.3433e-03
  Relative Linf Error  = 2.8637e-02

Time t = 0.5
  Relative L2 Error    = 8.0305e-03
  Relative Linf Error  = 2.2590e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 15 │ L1=2.087e-03 │ L2=5.199e-04 │ L∞=1.666e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11862 data from 128/128 BVP solutions in 15.9 sec
  → Speed: 8.1 BVP/sec, 748 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 6.2207e-03, Loss_V_x = 8.8723e-04, Loss_total = 7.1080e-03
Iteration 1000: Loss_V = 3.9453e-05, Loss_V_x = 2.5520e-04, Loss_total = 2.9465e-04
Iteration 2000: Loss_V = 1.9989e-05, Loss_V_x = 1.5807e-04, Loss_total = 1.7806e-04
Iteration 3000: Loss_V = 1.6626e-05, Loss_V_x = 1.2890e-04, Loss_total = 1.4552e-04


The Exploitibility is : 0.036086469888687134

 Computing The Best Response 16: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11737 data from 128/128 BVP solutions in 84.5 sec
  → Speed: 1.5 BVP/sec, 139 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.6976e-04, Loss_V_x = 1.7155e-04, Loss_HJB = 9.9547e-03, Loss_total = 5.6187e-03
Iteration 1000: Loss_V = 4.5535e-05, Loss_V_x = 1.2929e-04, Loss_HJB = 1.6139e-04, Loss_total = 2.5551e-04
Iteration 2000: Loss_V = 2.4073e-05, Loss_V_x = 1.1604e-04, Loss_HJB = 7.2212e-05, Loss_total = 1.7622e-04
Iteration 3000: Loss_V = 1.6974e-05, Loss_V_x = 9.9020e-05, Loss_HJB = 5.4517e-05, Loss_total = 1.4325e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.5 sec 

Iteration 0:  Loss_G = 3.2703e-05,  Loss_ODE = 5.1068e-04,  Loss_total = 8.3770e-05
Iteration 1000:  Loss_G = 7.2217e-06,  Loss_ODE = 1.2207e-04,  Loss_total = 1.9428e-05
Iteration 2000:  Loss_G = 6.6938e-06,  Loss_ODE = 1.0979e-04,  Loss_total = 1.7673e-05
Iteration 3000:  Loss_G = 6.2532e-06,  Loss_ODE = 1.0874e-04,  Loss_total = 1.7127e-05


Time t = 0.0
  Relative L2 Error    = 6.1792e-03
  Relative Linf Error  = 2.4426e-02

Time t = 0.5
  Relative L2 Error    = 6.7366e-03
  Relative Linf Error  = 2.6162e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 16 │ L1=1.876e-03 │ L2=4.704e-04 │ L∞=1.729e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11863 data from 128/128 BVP solutions in 15.9 sec
  → Speed: 8.0 BVP/sec, 744 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 9.2823e-04, Loss_V_x = 6.5727e-04, Loss_total = 1.5855e-03
Iteration 1000: Loss_V = 3.5450e-05, Loss_V_x = 2.2570e-04, Loss_total = 2.6115e-04
Iteration 2000: Loss_V = 2.2564e-05, Loss_V_x = 1.4756e-04, Loss_total = 1.7012e-04
Iteration 3000: Loss_V = 1.9921e-05, Loss_V_x = 1.1635e-04, Loss_total = 1.3627e-04


The Exploitibility is : 0.02720615267753601

 Computing The Best Response 17: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11772 data from 128/128 BVP solutions in 89.2 sec
  → Speed: 1.4 BVP/sec, 132 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.2435e-04, Loss_V_x = 1.4884e-04, Loss_HJB = 6.3783e-03, Loss_total = 3.6624e-03
Iteration 1000: Loss_V = 4.5133e-05, Loss_V_x = 1.0799e-04, Loss_HJB = 1.4071e-04, Loss_total = 2.2347e-04
Iteration 2000: Loss_V = 2.5367e-05, Loss_V_x = 9.5769e-05, Loss_HJB = 7.9082e-05, Loss_total = 1.6068e-04
Iteration 3000: Loss_V = 1.9194e-05, Loss_V_x = 9.7045e-05, Loss_HJB = 5.1113e-05, Loss_total = 1.4180e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 14.0 sec 

Iteration 0:  Loss_G = 3.0936e-05,  Loss_ODE = 5.2660e-04,  Loss_total = 8.3597e-05
Iteration 1000:  Loss_G = 7.5155e-06,  Loss_ODE = 1.2306e-04,  Loss_total = 1.9822e-05
Iteration 2000:  Loss_G = 6.5766e-06,  Loss_ODE = 1.0890e-04,  Loss_total = 1.7466e-05
Iteration 3000:  Loss_G = 6.3365e-06,  Loss_ODE = 9.8624e-05,  Loss_total = 1.6199e-05


Time t = 0.0
  Relative L2 Error    = 6.3059e-03
  Relative Linf Error  = 2.5163e-02

Time t = 0.5
  Relative L2 Error    = 6.7786e-03
  Relative Linf Error  = 2.1530e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 17 │ L1=2.075e-03 │ L2=5.185e-04 │ L∞=1.758e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11915 data from 128/128 BVP solutions in 16.4 sec
  → Speed: 7.8 BVP/sec, 725 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.0412e-03, Loss_V_x = 5.7024e-04, Loss_total = 1.6114e-03
Iteration 1000: Loss_V = 2.7614e-05, Loss_V_x = 2.0927e-04, Loss_total = 2.3688e-04
Iteration 2000: Loss_V = 1.6771e-05, Loss_V_x = 1.3214e-04, Loss_total = 1.4891e-04
Iteration 3000: Loss_V = 1.3356e-05, Loss_V_x = 1.0667e-04, Loss_total = 1.2003e-04


The Exploitibility is : 0.03572353720664978

 Computing The Best Response 18: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11858 data from 128/128 BVP solutions in 94.1 sec
  → Speed: 1.4 BVP/sec, 126 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.2882e-04, Loss_V_x = 1.5679e-04, Loss_HJB = 5.9874e-03, Loss_total = 3.3793e-03
Iteration 1000: Loss_V = 3.2832e-05, Loss_V_x = 1.1854e-04, Loss_HJB = 1.2702e-04, Loss_total = 2.1488e-04
Iteration 2000: Loss_V = 2.6670e-05, Loss_V_x = 1.0524e-04, Loss_HJB = 8.8387e-05, Loss_total = 1.7610e-04
Iteration 3000: Loss_V = 1.9005e-05, Loss_V_x = 1.0140e-04, Loss_HJB = 5.6507e-05, Loss_total = 1.4866e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.8 sec 

Iteration 0:  Loss_G = 3.3691e-05,  Loss_ODE = 5.1049e-04,  Loss_total = 8.4740e-05
Iteration 1000:  Loss_G = 7.3736e-06,  Loss_ODE = 1.2006e-04,  Loss_total = 1.9380e-05
Iteration 2000:  Loss_G = 7.0337e-06,  Loss_ODE = 1.1829e-04,  Loss_total = 1.8862e-05
Iteration 3000:  Loss_G = 6.5530e-06,  Loss_ODE = 1.0600e-04,  Loss_total = 1.7153e-05


Time t = 0.0
  Relative L2 Error    = 6.1917e-03
  Relative Linf Error  = 2.2412e-02

Time t = 0.5
  Relative L2 Error    = 6.3766e-03
  Relative Linf Error  = 1.8439e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 18 │ L1=1.616e-03 │ L2=4.024e-04 │ L∞=1.413e-04

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11748 data from 128/128 BVP solutions in 15.4 sec
  → Speed: 8.3 BVP/sec, 761 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.3191e-03, Loss_V_x = 5.4313e-04, Loss_total = 1.8622e-03
Iteration 1000: Loss_V = 2.3238e-05, Loss_V_x = 1.7846e-04, Loss_total = 2.0170e-04
Iteration 2000: Loss_V = 1.5830e-05, Loss_V_x = 1.1929e-04, Loss_total = 1.3512e-04
Iteration 3000: Loss_V = 1.4563e-05, Loss_V_x = 9.8424e-05, Loss_total = 1.1299e-04


The Exploitibility is : 0.03776058554649353

 Computing The Best Response 19: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=128)...
8 workers will be used.

Generated 11639 data from 128/128 BVP solutions in 98.6 sec
  → Speed: 1.3 BVP/sec, 118 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.2764e-04, Loss_V_x = 1.5344e-04, Loss_HJB = 7.5680e-03, Loss_total = 4.1651e-03
Iteration 1000: Loss_V = 3.6079e-05, Loss_V_x = 1.1898e-04, Loss_HJB = 1.1087e-04, Loss_total = 2.1050e-04
Iteration 2000: Loss_V = 1.5452e-04, Loss_V_x = 9.7811e-05, Loss_HJB = 4.0423e-04, Loss_total = 4.5444e-04
Iteration 3000: Loss_V = 1.6867e-05, Loss_V_x = 8.7482e-05, Loss_HJB = 3.0345e-05, Loss_total = 1.1952e-04


Generating data_MFG...
Generated 5376 data from 256 IVP solutions in 13.5 sec 

Iteration 0:  Loss_G = 3.2334e-05,  Loss_ODE = 5.0049e-04,  Loss_total = 8.2383e-05
Iteration 1000:  Loss_G = 8.2349e-06,  Loss_ODE = 1.3537e-04,  Loss_total = 2.1771e-05
Iteration 2000:  Loss_G = 7.5120e-06,  Loss_ODE = 1.2883e-04,  Loss_total = 2.0395e-05
Iteration 3000:  Loss_G = 7.1614e-06,  Loss_ODE = 1.1601e-04,  Loss_total = 1.8763e-05


Time t = 0.0
  Relative L2 Error    = 6.2394e-03
  Relative Linf Error  = 2.0542e-02

Time t = 0.5
  Relative L2 Error    = 6.4910e-03
  Relative Linf Error  = 2.0392e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

