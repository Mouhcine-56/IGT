parser = argparse.ArgumentParser()
parser.add_argument('--t0', type=int, default=0, help='temps initial')
parser.add_argument('--t_final', type=int, default=1, help='temps final')
parser.add_argument('--N', type=int, default=20, help='Number of time step')
parser.add_argument('--dim', type=int, default=100, help='dimension')
parser.add_argument('--num_samples_hjb', type=int, default=512, help='Number of Samples for training HJB')
parser.add_argument('--num_samples_mfg', type=int, default=512, help='Number of Samples for training MFG')
parser.add_argument('--num_samples_bvp', type=int, default=512, help='Number of Samples for  BVP')
parser.add_argument('--num_samples_gen', type=int, default=512, help='Number of Samples for training Generator')
parser.add_argument('--num_samples_conv', type=int, default=512, help='Number of Samples for compute convolution')
parser.add_argument('--num_points_test', type=int, default=100000)
parser.add_argument('--Max_Round', type=float, default=1, help='Number of Round')
parser.add_argument('--num_epoch_hjb', type=float, default=1000, help='Number of training iterations for approximate HJB')
parser.add_argument('--num_epoch_mfg', type=float, default=3000, help='Number of training iterations for approximate MFG')
parser.add_argument('--num_epoch_v', type=float, default=5000, help='Number of training iterations for approximate V')
parser.add_argument('--num_epoch_gen', type=float, default=5000, help='Number of training iterations for approximate GEN')
parser.add_argument('--freq', type=float, default=1000)
parser.add_argument('--ns_v', default=128, help='Network size of V_net')
parser.add_argument('--ns_g', default=128, help='Network sizeof G_net')
parser.add_argument('--lr', default=1e-3, help='learning rate of MFG')
parser.add_argument('--lr_v', default=1e-4, help='learning rate of V')
parser.add_argument('--lr_v2', default=1e-4, help='learning rate of V')
parser.add_argument('--lr_g', default=1e-4, help='learning rate of G')
parser.add_argument('--betas', default=(0.5, 0.9), help='Adam only')
parser.add_argument('--weight_decay',default=0*1e-3)
parser.add_argument('--act_func_v',default= lambda x: torch.tanh(x), help='Activation function for v')
parser.add_argument('--act_func_g',default= lambda x: torch.relu(x), help='Activation function for g')
parser.add_argument('--hh', default=0.5, help='ResNet step-size')
args = parser.parse_args()



Round:  0 \n

 Computing The Best Response 0: 

Approximate solution of MFG 

Starting Joint Training of V and G (MFG)...
Iteration 0: Loss_HJB = 4.6295e+03, Loss_ODE = 1.8306e-01
Iteration 500: Loss_HJB = 2.0649e+02, Loss_ODE = 2.5349e-02
Iteration 1000: Loss_HJB = 3.8004e+01, Loss_ODE = 7.6637e-03
Iteration 1500: Loss_HJB = 3.5585e+01, Loss_ODE = 2.4055e-03
Iteration 2000: Loss_HJB = 3.6518e+01, Loss_ODE = 9.1747e-04
Iteration 2500: Loss_HJB = 3.9099e+01, Loss_ODE = 4.3711e-04
Iteration 3000: Loss_HJB = 3.3613e+01, Loss_ODE = 2.6266e-04


Time t = 0.0
  Relative L2 Error    = 3.1964e-01
  Relative Linf Error  = 4.0307e-01

Time t = 0.5
  Relative L2 Error    = 1.1781e-01
  Relative Linf Error  = 2.2766e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 10225 data from 512/512 BVP solutions in 176.8 sec
  → Speed: 2.9 BVP/sec, 58 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.8739e+02, Loss_V_x = 2.1269e-01, Loss_HJB = 4.1092e+01, Loss_total = 1.8802e+02
Iteration 1000: Loss_V = 5.1345e+00, Loss_V_x = 4.6086e-01, Loss_HJB = 2.9112e+02, Loss_total = 8.5066e+00
Iteration 2000: Loss_V = 2.6802e+00, Loss_V_x = 5.6145e-01, Loss_HJB = 9.9858e+01, Loss_total = 4.2402e+00
Iteration 3000: Loss_V = 1.3916e+00, Loss_V_x = 5.8755e-01, Loss_HJB = 4.8438e+01, Loss_total = 2.4635e+00
Iteration 4000: Loss_V = 4.2342e-01, Loss_V_x = 5.6040e-01, Loss_HJB = 2.6549e+01, Loss_total = 1.2493e+00
Iteration 5000: Loss_V = 1.7025e-01, Loss_V_x = 4.8976e-01, Loss_HJB = 1.6800e+01, Loss_total = 8.2801e-01


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 50.5 sec 

Iteration 0:  Loss_G = 2.5320e-02,  Loss_ODE = 2.3014e-01,  Loss_total = 4.8334e-02
Iteration 1000:  Loss_G = 2.5680e-03,  Loss_ODE = 3.5417e-02,  Loss_total = 6.1097e-03
Iteration 2000:  Loss_G = 2.1670e-03,  Loss_ODE = 3.0947e-02,  Loss_total = 5.2618e-03
Iteration 3000:  Loss_G = 2.0023e-03,  Loss_ODE = 2.9640e-02,  Loss_total = 4.9663e-03
Iteration 4000:  Loss_G = 1.8443e-03,  Loss_ODE = 2.5353e-02,  Loss_total = 4.3796e-03
Iteration 5000:  Loss_G = 1.7394e-03,  Loss_ODE = 2.3823e-02,  Loss_total = 4.1217e-03


Time t = 0.0
  Relative L2 Error    = 1.6261e-01
  Relative Linf Error  = 4.8677e-01

Time t = 0.5
  Relative L2 Error    = 3.5227e-01
  Relative Linf Error  = 7.3907e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  0 │ L1=2.170e+01 │ L2=5.073e+00 │ L∞=1.406e+00

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 52442 data from 512/512 BVP solutions in 516.1 sec
  → Speed: 1.0 BVP/sec, 102 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.3711e+01, Loss_V_x = 8.2775e-01, Loss_total = 3.4539e+01
Iteration 1000: Loss_V = 7.3406e-01, Loss_V_x = 8.4875e-01, Loss_total = 1.5828e+00
Iteration 2000: Loss_V = 2.7597e-01, Loss_V_x = 6.6905e-01, Loss_total = 9.4502e-01
Iteration 3000: Loss_V = 1.4301e-01, Loss_V_x = 5.3087e-01, Loss_total = 6.7387e-01
Iteration 4000: Loss_V = 7.7041e-02, Loss_V_x = 4.2959e-01, Loss_total = 5.0664e-01
Iteration 5000: Loss_V = 4.0394e-02, Loss_V_x = 3.5154e-01, Loss_total = 3.9193e-01


The Exploitibility is : 22.7346830368042

 Computing The Best Response 1: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 28098 data from 512/512 BVP solutions in 293.5 sec
  → Speed: 1.7 BVP/sec, 96 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.2331e+01, Loss_V_x = 5.0314e-01, Loss_HJB = 8.0188e+02, Loss_total = 3.0852e+01
Iteration 1000: Loss_V = 5.3485e-01, Loss_V_x = 6.2817e-01, Loss_HJB = 6.2630e+01, Loss_total = 1.7893e+00
Iteration 2000: Loss_V = 1.0860e-01, Loss_V_x = 5.5568e-01, Loss_HJB = 5.7582e+00, Loss_total = 7.2186e-01
Iteration 3000: Loss_V = 6.9103e-02, Loss_V_x = 4.5435e-01, Loss_HJB = 4.4778e+00, Loss_total = 5.6823e-01
Iteration 4000: Loss_V = 4.5069e-02, Loss_V_x = 3.6944e-01, Loss_HJB = 1.1016e+00, Loss_total = 4.2553e-01
Iteration 5000: Loss_V = 2.9499e-02, Loss_V_x = 3.1524e-01, Loss_HJB = 3.7277e-01, Loss_total = 3.4847e-01


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 30.6 sec 

Iteration 0:  Loss_G = 2.9228e-02,  Loss_ODE = 1.0435e-01,  Loss_total = 3.9663e-02
Iteration 1000:  Loss_G = 3.4415e-04,  Loss_ODE = 5.0025e-03,  Loss_total = 8.4440e-04
Iteration 2000:  Loss_G = 2.5585e-04,  Loss_ODE = 4.7267e-03,  Loss_total = 7.2852e-04
Iteration 3000:  Loss_G = 2.3298e-04,  Loss_ODE = 4.2214e-03,  Loss_total = 6.5512e-04
Iteration 4000:  Loss_G = 2.2032e-04,  Loss_ODE = 3.9249e-03,  Loss_total = 6.1280e-04
Iteration 5000:  Loss_G = 2.1141e-04,  Loss_ODE = 3.6202e-03,  Loss_total = 5.7343e-04


Time t = 0.0
  Relative L2 Error    = 1.1673e-01
  Relative Linf Error  = 3.2097e-01

Time t = 0.5
  Relative L2 Error    = 2.1290e-01
  Relative Linf Error  = 4.2418e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  1 │ L1=1.082e+01 │ L2=2.559e+00 │ L∞=7.314e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 20416 data from 512/512 BVP solutions in 184.8 sec
  → Speed: 2.8 BVP/sec, 110 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.7716e+01, Loss_V_x = 3.4459e-01, Loss_total = 1.8061e+01
Iteration 1000: Loss_V = 1.0328e-01, Loss_V_x = 3.4436e-01, Loss_total = 4.4764e-01
Iteration 2000: Loss_V = 2.9049e-02, Loss_V_x = 2.8206e-01, Loss_total = 3.1111e-01
Iteration 3000: Loss_V = 1.3495e-02, Loss_V_x = 2.3984e-01, Loss_total = 2.5334e-01
Iteration 4000: Loss_V = 7.2026e-03, Loss_V_x = 2.0941e-01, Loss_total = 2.1661e-01
Iteration 5000: Loss_V = 3.5934e-03, Loss_V_x = 1.8312e-01, Loss_total = 1.8671e-01


The Exploitibility is : 25.65028429031372

 Computing The Best Response 2: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 20540 data from 512/512 BVP solutions in 221.7 sec
  → Speed: 2.3 BVP/sec, 93 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.1900e+01, Loss_V_x = 2.3831e-01, Loss_HJB = 3.2412e+02, Loss_total = 1.5380e+01
Iteration 1000: Loss_V = 6.1249e-02, Loss_V_x = 2.7360e-01, Loss_HJB = 1.1412e+00, Loss_total = 3.4626e-01
Iteration 2000: Loss_V = 2.3893e-02, Loss_V_x = 2.3591e-01, Loss_HJB = 1.6483e-01, Loss_total = 2.6145e-01
Iteration 3000: Loss_V = 1.1147e-02, Loss_V_x = 2.0460e-01, Loss_HJB = 5.4059e-02, Loss_total = 2.1629e-01
Iteration 4000: Loss_V = 6.6280e-03, Loss_V_x = 1.7955e-01, Loss_HJB = 3.0375e-02, Loss_total = 1.8648e-01
Iteration 5000: Loss_V = 4.5421e-03, Loss_V_x = 1.5792e-01, Loss_HJB = 1.8201e-02, Loss_total = 1.6265e-01


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 37.1 sec 

Iteration 0:  Loss_G = 3.4755e-03,  Loss_ODE = 1.3186e-02,  Loss_total = 4.7940e-03
Iteration 1000:  Loss_G = 1.1285e-04,  Loss_ODE = 1.7508e-03,  Loss_total = 2.8793e-04
Iteration 2000:  Loss_G = 1.0561e-04,  Loss_ODE = 1.5415e-03,  Loss_total = 2.5976e-04
Iteration 3000:  Loss_G = 1.0298e-04,  Loss_ODE = 1.5599e-03,  Loss_total = 2.5898e-04
Iteration 4000:  Loss_G = 9.8817e-05,  Loss_ODE = 1.4407e-03,  Loss_total = 2.4289e-04
Iteration 5000:  Loss_G = 9.7990e-05,  Loss_ODE = 1.4786e-03,  Loss_total = 2.4585e-04


Time t = 0.0
  Relative L2 Error    = 9.2513e-02
  Relative Linf Error  = 2.4839e-01

Time t = 0.5
  Relative L2 Error    = 1.4312e-01
  Relative Linf Error  = 3.0771e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  2 │ L1=8.156e+00 │ L2=1.933e+00 │ L∞=5.460e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 17737 data from 512/512 BVP solutions in 119.7 sec
  → Speed: 4.3 BVP/sec, 148 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 7.1741e+00, Loss_V_x = 1.7165e-01, Loss_total = 7.3457e+00
Iteration 1000: Loss_V = 1.8395e-02, Loss_V_x = 1.6466e-01, Loss_total = 1.8306e-01
Iteration 2000: Loss_V = 5.9103e-03, Loss_V_x = 1.4005e-01, Loss_total = 1.4596e-01
Iteration 3000: Loss_V = 2.9381e-03, Loss_V_x = 1.2058e-01, Loss_total = 1.2351e-01
Iteration 4000: Loss_V = 1.9323e-03, Loss_V_x = 1.0048e-01, Loss_total = 1.0242e-01
Iteration 5000: Loss_V = 2.6757e-03, Loss_V_x = 8.1981e-02, Loss_total = 8.4656e-02


The Exploitibility is : 20.40330696105957

 Computing The Best Response 3: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 17191 data from 512/512 BVP solutions in 183.4 sec
  → Speed: 2.8 BVP/sec, 94 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 7.1156e+00, Loss_V_x = 1.2662e-01, Loss_HJB = 1.5364e+02, Loss_total = 8.7787e+00
Iteration 1000: Loss_V = 2.3983e-02, Loss_V_x = 1.4382e-01, Loss_HJB = 2.9727e-01, Loss_total = 1.7078e-01
Iteration 2000: Loss_V = 8.0260e-03, Loss_V_x = 1.2841e-01, Loss_HJB = 5.1547e-02, Loss_total = 1.3695e-01
Iteration 3000: Loss_V = 4.8611e-03, Loss_V_x = 1.1063e-01, Loss_HJB = 2.5747e-02, Loss_total = 1.1575e-01
Iteration 4000: Loss_V = 3.3510e-03, Loss_V_x = 9.4371e-02, Loss_HJB = 1.3752e-02, Loss_total = 9.7859e-02
Iteration 5000: Loss_V = 2.4398e-03, Loss_V_x = 8.0878e-02, Loss_HJB = 1.3583e-02, Loss_total = 8.3454e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 26.8 sec 

Iteration 0:  Loss_G = 2.6460e-03,  Loss_ODE = 9.8092e-03,  Loss_total = 3.6269e-03
Iteration 1000:  Loss_G = 9.1893e-05,  Loss_ODE = 1.6460e-03,  Loss_total = 2.5650e-04
Iteration 2000:  Loss_G = 8.9645e-05,  Loss_ODE = 1.5570e-03,  Loss_total = 2.4535e-04
Iteration 3000:  Loss_G = 8.7873e-05,  Loss_ODE = 1.5331e-03,  Loss_total = 2.4118e-04
Iteration 4000:  Loss_G = 8.7109e-05,  Loss_ODE = 1.5216e-03,  Loss_total = 2.3927e-04
Iteration 5000:  Loss_G = 8.4635e-05,  Loss_ODE = 1.4477e-03,  Loss_total = 2.2941e-04


Time t = 0.0
  Relative L2 Error    = 7.5683e-02
  Relative Linf Error  = 2.0664e-01

Time t = 0.5
  Relative L2 Error    = 1.0375e-01
  Relative Linf Error  = 2.8248e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  3 │ L1=6.546e+00 │ L2=1.543e+00 │ L∞=4.188e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 16376 data from 512/512 BVP solutions in 107.1 sec
  → Speed: 4.8 BVP/sec, 153 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.1901e+00, Loss_V_x = 1.0313e-01, Loss_total = 4.2932e+00
Iteration 1000: Loss_V = 6.9178e-03, Loss_V_x = 9.4068e-02, Loss_total = 1.0099e-01
Iteration 2000: Loss_V = 2.7412e-03, Loss_V_x = 7.8088e-02, Loss_total = 8.0830e-02
Iteration 3000: Loss_V = 1.8825e-03, Loss_V_x = 6.3925e-02, Loss_total = 6.5808e-02
Iteration 4000: Loss_V = 1.5151e-03, Loss_V_x = 5.2395e-02, Loss_total = 5.3910e-02
Iteration 5000: Loss_V = 3.7009e-03, Loss_V_x = 4.3954e-02, Loss_total = 4.7655e-02


The Exploitibility is : 14.76069688796997

 Computing The Best Response 4: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 15127 data from 512/512 BVP solutions in 123.3 sec
  → Speed: 4.2 BVP/sec, 123 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.2689e+00, Loss_V_x = 6.7165e-02, Loss_HJB = 8.6414e+01, Loss_total = 5.2002e+00
Iteration 1000: Loss_V = 1.2409e-02, Loss_V_x = 7.3875e-02, Loss_HJB = 6.5559e-02, Loss_total = 8.6939e-02
Iteration 2000: Loss_V = 4.4603e-03, Loss_V_x = 6.6118e-02, Loss_HJB = 1.9639e-02, Loss_total = 7.0775e-02
Iteration 3000: Loss_V = 2.9524e-03, Loss_V_x = 5.6158e-02, Loss_HJB = 1.3531e-02, Loss_total = 5.9245e-02
Iteration 4000: Loss_V = 2.1966e-03, Loss_V_x = 4.8942e-02, Loss_HJB = 1.1995e-02, Loss_total = 5.1259e-02
Iteration 5000: Loss_V = 1.8650e-03, Loss_V_x = 4.2512e-02, Loss_HJB = 9.6916e-03, Loss_total = 4.4474e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 24.3 sec 

Iteration 0:  Loss_G = 1.8677e-03,  Loss_ODE = 7.9868e-03,  Loss_total = 2.6664e-03
Iteration 1000:  Loss_G = 1.0295e-04,  Loss_ODE = 1.9932e-03,  Loss_total = 3.0227e-04
Iteration 2000:  Loss_G = 1.0195e-04,  Loss_ODE = 1.9589e-03,  Loss_total = 2.9784e-04
Iteration 3000:  Loss_G = 1.0004e-04,  Loss_ODE = 1.8966e-03,  Loss_total = 2.8970e-04
Iteration 4000:  Loss_G = 9.8262e-05,  Loss_ODE = 1.8767e-03,  Loss_total = 2.8593e-04
Iteration 5000:  Loss_G = 9.6795e-05,  Loss_ODE = 1.8022e-03,  Loss_total = 2.7702e-04


Time t = 0.0
  Relative L2 Error    = 6.1303e-02
  Relative Linf Error  = 1.7591e-01

Time t = 0.5
  Relative L2 Error    = 7.0226e-02
  Relative Linf Error  = 2.0554e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  4 │ L1=5.403e+00 │ L2=1.268e+00 │ L∞=3.359e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 15770 data from 512/512 BVP solutions in 89.4 sec
  → Speed: 5.7 BVP/sec, 176 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.7548e+00, Loss_V_x = 6.3158e-02, Loss_total = 2.8179e+00
Iteration 1000: Loss_V = 6.1822e-03, Loss_V_x = 5.5637e-02, Loss_total = 6.1819e-02
Iteration 2000: Loss_V = 2.5888e-03, Loss_V_x = 4.4883e-02, Loss_total = 4.7472e-02
Iteration 3000: Loss_V = 1.8756e-03, Loss_V_x = 3.6584e-02, Loss_total = 3.8460e-02
Iteration 4000: Loss_V = 1.5317e-03, Loss_V_x = 3.0713e-02, Loss_total = 3.2245e-02
Iteration 5000: Loss_V = 1.4582e-03, Loss_V_x = 2.6540e-02, Loss_total = 2.7999e-02


The Exploitibility is : 10.865756511688232

 Computing The Best Response 5: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 14307 data from 512/512 BVP solutions in 97.0 sec
  → Speed: 5.3 BVP/sec, 147 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.1617e+00, Loss_V_x = 4.2535e-02, Loss_HJB = 5.4437e+01, Loss_total = 2.7486e+00
Iteration 1000: Loss_V = 6.4380e-03, Loss_V_x = 4.6370e-02, Loss_HJB = 2.4845e-02, Loss_total = 5.3056e-02
Iteration 2000: Loss_V = 3.0792e-03, Loss_V_x = 3.9562e-02, Loss_HJB = 1.2110e-02, Loss_total = 4.2762e-02
Iteration 3000: Loss_V = 2.0967e-03, Loss_V_x = 3.4085e-02, Loss_HJB = 8.7341e-03, Loss_total = 3.6269e-02
Iteration 4000: Loss_V = 2.0664e-03, Loss_V_x = 2.9928e-02, Loss_HJB = 7.8519e-03, Loss_total = 3.2073e-02
Iteration 5000: Loss_V = 1.4943e-03, Loss_V_x = 2.7647e-02, Loss_HJB = 7.1936e-03, Loss_total = 2.9213e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 23.5 sec 

Iteration 0:  Loss_G = 1.6059e-03,  Loss_ODE = 7.7554e-03,  Loss_total = 2.3814e-03
Iteration 1000:  Loss_G = 1.2193e-04,  Loss_ODE = 2.4803e-03,  Loss_total = 3.6996e-04
Iteration 2000:  Loss_G = 1.1829e-04,  Loss_ODE = 2.3078e-03,  Loss_total = 3.4907e-04
Iteration 3000:  Loss_G = 1.1638e-04,  Loss_ODE = 2.2243e-03,  Loss_total = 3.3881e-04
Iteration 4000:  Loss_G = 1.1431e-04,  Loss_ODE = 2.1987e-03,  Loss_total = 3.3418e-04
Iteration 5000:  Loss_G = 1.1186e-04,  Loss_ODE = 2.1630e-03,  Loss_total = 3.2816e-04


Time t = 0.0
  Relative L2 Error    = 5.6291e-02
  Relative Linf Error  = 1.4476e-01

Time t = 0.5
  Relative L2 Error    = 5.5468e-02
  Relative Linf Error  = 1.9425e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  5 │ L1=4.576e+00 │ L2=1.069e+00 │ L∞=2.795e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 14881 data from 512/512 BVP solutions in 86.5 sec
  → Speed: 5.9 BVP/sec, 172 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.9217e+00, Loss_V_x = 4.4816e-02, Loss_total = 1.9665e+00
Iteration 1000: Loss_V = 4.5191e-03, Loss_V_x = 3.8190e-02, Loss_total = 4.2709e-02
Iteration 2000: Loss_V = 3.6068e-03, Loss_V_x = 3.0608e-02, Loss_total = 3.4215e-02
Iteration 3000: Loss_V = 1.4853e-03, Loss_V_x = 2.5638e-02, Loss_total = 2.7123e-02
Iteration 4000: Loss_V = 1.3275e-03, Loss_V_x = 2.2253e-02, Loss_total = 2.3580e-02
Iteration 5000: Loss_V = 7.1842e-03, Loss_V_x = 1.9808e-02, Loss_total = 2.6993e-02


The Exploitibility is : 8.351744174957275

 Computing The Best Response 6: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 14120 data from 512/512 BVP solutions in 91.1 sec
  → Speed: 5.6 BVP/sec, 155 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.3146e+00, Loss_V_x = 3.0936e-02, Loss_HJB = 3.2171e+01, Loss_total = 1.6673e+00
Iteration 1000: Loss_V = 4.1734e-03, Loss_V_x = 3.2040e-02, Loss_HJB = 1.1858e-02, Loss_total = 3.6332e-02
Iteration 2000: Loss_V = 2.2299e-03, Loss_V_x = 2.7518e-02, Loss_HJB = 7.9918e-03, Loss_total = 2.9828e-02
Iteration 3000: Loss_V = 1.7659e-03, Loss_V_x = 2.4578e-02, Loss_HJB = 7.3747e-03, Loss_total = 2.6418e-02
Iteration 4000: Loss_V = 1.5923e-03, Loss_V_x = 2.2306e-02, Loss_HJB = 7.8461e-03, Loss_total = 2.3976e-02
Iteration 5000: Loss_V = 1.2972e-03, Loss_V_x = 2.0374e-02, Loss_HJB = 6.4863e-03, Loss_total = 2.1736e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 23.1 sec 

Iteration 0:  Loss_G = 1.2526e-03,  Loss_ODE = 6.7931e-03,  Loss_total = 1.9319e-03
Iteration 1000:  Loss_G = 1.2846e-04,  Loss_ODE = 2.6656e-03,  Loss_total = 3.9503e-04
Iteration 2000:  Loss_G = 1.2537e-04,  Loss_ODE = 2.5011e-03,  Loss_total = 3.7548e-04
Iteration 3000:  Loss_G = 1.2314e-04,  Loss_ODE = 2.4363e-03,  Loss_total = 3.6677e-04
Iteration 4000:  Loss_G = 1.2195e-04,  Loss_ODE = 2.3794e-03,  Loss_total = 3.5989e-04
Iteration 5000:  Loss_G = 1.2066e-04,  Loss_ODE = 2.3552e-03,  Loss_total = 3.5618e-04


Time t = 0.0
  Relative L2 Error    = 4.7082e-02
  Relative Linf Error  = 1.3559e-01

Time t = 0.5
  Relative L2 Error    = 4.6378e-02
  Relative Linf Error  = 1.3079e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  6 │ L1=3.891e+00 │ L2=9.072e-01 │ L∞=2.363e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 14612 data from 512/512 BVP solutions in 84.8 sec
  → Speed: 6.0 BVP/sec, 172 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.5290e+00, Loss_V_x = 3.2320e-02, Loss_total = 1.5613e+00
Iteration 1000: Loss_V = 3.7630e-03, Loss_V_x = 2.7130e-02, Loss_total = 3.0893e-02
Iteration 2000: Loss_V = 1.7508e-03, Loss_V_x = 2.2007e-02, Loss_total = 2.3758e-02
Iteration 3000: Loss_V = 1.4657e-03, Loss_V_x = 1.8798e-02, Loss_total = 2.0264e-02
Iteration 4000: Loss_V = 1.1101e-03, Loss_V_x = 1.6646e-02, Loss_total = 1.7756e-02
Iteration 5000: Loss_V = 2.9047e-03, Loss_V_x = 1.5074e-02, Loss_total = 1.7979e-02


The Exploitibility is : 6.556159973144531

 Computing The Best Response 7: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13934 data from 512/512 BVP solutions in 87.2 sec
  → Speed: 5.9 BVP/sec, 160 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.0624e+00, Loss_V_x = 2.5075e-02, Loss_HJB = 2.5876e+01, Loss_total = 1.3463e+00
Iteration 1000: Loss_V = 3.6317e-03, Loss_V_x = 2.6005e-02, Loss_HJB = 9.9569e-03, Loss_total = 2.9737e-02
Iteration 2000: Loss_V = 2.7116e-03, Loss_V_x = 2.2382e-02, Loss_HJB = 6.7204e-03, Loss_total = 2.5161e-02
Iteration 3000: Loss_V = 1.9160e-03, Loss_V_x = 2.0098e-02, Loss_HJB = 6.3999e-03, Loss_total = 2.2078e-02
Iteration 4000: Loss_V = 1.3097e-03, Loss_V_x = 1.8248e-02, Loss_HJB = 5.5208e-03, Loss_total = 1.9613e-02
Iteration 5000: Loss_V = 1.2809e-03, Loss_V_x = 1.7047e-02, Loss_HJB = 6.1812e-03, Loss_total = 1.8390e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 28.1 sec 

Iteration 0:  Loss_G = 8.3865e-04,  Loss_ODE = 5.7748e-03,  Loss_total = 1.4161e-03
Iteration 1000:  Loss_G = 1.3457e-04,  Loss_ODE = 2.7228e-03,  Loss_total = 4.0685e-04
Iteration 2000:  Loss_G = 1.3125e-04,  Loss_ODE = 2.6468e-03,  Loss_total = 3.9593e-04
Iteration 3000:  Loss_G = 1.2961e-04,  Loss_ODE = 2.6249e-03,  Loss_total = 3.9210e-04
Iteration 4000:  Loss_G = 1.2850e-04,  Loss_ODE = 2.5890e-03,  Loss_total = 3.8740e-04
Iteration 5000:  Loss_G = 1.2774e-04,  Loss_ODE = 2.5948e-03,  Loss_total = 3.8722e-04


Time t = 0.0
  Relative L2 Error    = 4.2108e-02
  Relative Linf Error  = 1.1235e-01

Time t = 0.5
  Relative L2 Error    = 3.9394e-02
  Relative Linf Error  = 1.5004e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  7 │ L1=3.256e+00 │ L2=7.589e-01 │ L∞=1.976e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 14357 data from 512/512 BVP solutions in 94.8 sec
  → Speed: 5.4 BVP/sec, 151 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.0380e+00, Loss_V_x = 2.5639e-02, Loss_total = 1.0637e+00
Iteration 1000: Loss_V = 3.6102e-03, Loss_V_x = 2.1022e-02, Loss_total = 2.4633e-02
Iteration 2000: Loss_V = 1.6068e-03, Loss_V_x = 1.7352e-02, Loss_total = 1.8959e-02
Iteration 3000: Loss_V = 7.8187e-03, Loss_V_x = 1.5191e-02, Loss_total = 2.3010e-02
Iteration 4000: Loss_V = 1.4232e-03, Loss_V_x = 1.3739e-02, Loss_total = 1.5163e-02
Iteration 5000: Loss_V = 1.5384e-03, Loss_V_x = 1.2666e-02, Loss_total = 1.4204e-02


The Exploitibility is : 5.5646281242370605

 Computing The Best Response 8: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13868 data from 512/512 BVP solutions in 92.0 sec
  → Speed: 5.6 BVP/sec, 151 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 7.6433e-01, Loss_V_x = 2.0331e-02, Loss_HJB = 2.0667e+01, Loss_total = 9.9133e-01
Iteration 1000: Loss_V = 4.2494e-03, Loss_V_x = 2.1714e-02, Loss_HJB = 1.0559e-02, Loss_total = 2.6069e-02
Iteration 2000: Loss_V = 4.6349e-03, Loss_V_x = 1.9154e-02, Loss_HJB = 1.3164e-02, Loss_total = 2.3920e-02
Iteration 3000: Loss_V = 1.5486e-03, Loss_V_x = 1.7152e-02, Loss_HJB = 6.1550e-03, Loss_total = 1.8762e-02
Iteration 4000: Loss_V = 1.8116e-03, Loss_V_x = 1.5953e-02, Loss_HJB = 5.4996e-03, Loss_total = 1.7820e-02
Iteration 5000: Loss_V = 1.7728e-03, Loss_V_x = 1.5107e-02, Loss_HJB = 7.2117e-03, Loss_total = 1.6952e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 23.0 sec 

Iteration 0:  Loss_G = 7.4652e-04,  Loss_ODE = 5.4603e-03,  Loss_total = 1.2926e-03
Iteration 1000:  Loss_G = 1.3786e-04,  Loss_ODE = 2.8696e-03,  Loss_total = 4.2482e-04
Iteration 2000:  Loss_G = 1.3541e-04,  Loss_ODE = 2.7772e-03,  Loss_total = 4.1313e-04
Iteration 3000:  Loss_G = 1.3431e-04,  Loss_ODE = 2.6917e-03,  Loss_total = 4.0347e-04
Iteration 4000:  Loss_G = 1.3345e-04,  Loss_ODE = 2.7245e-03,  Loss_total = 4.0590e-04
Iteration 5000:  Loss_G = 1.3211e-04,  Loss_ODE = 2.6244e-03,  Loss_total = 3.9455e-04


Time t = 0.0
  Relative L2 Error    = 4.0443e-02
  Relative Linf Error  = 1.1457e-01

Time t = 0.5
  Relative L2 Error    = 3.5662e-02
  Relative Linf Error  = 1.0588e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  8 │ L1=2.919e+00 │ L2=6.788e-01 │ L∞=1.768e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 14114 data from 512/512 BVP solutions in 95.5 sec
  → Speed: 5.4 BVP/sec, 148 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 1.0421e+00, Loss_V_x = 2.2215e-02, Loss_total = 1.0644e+00
Iteration 1000: Loss_V = 4.7257e-03, Loss_V_x = 1.8288e-02, Loss_total = 2.3014e-02
Iteration 2000: Loss_V = 1.7347e-03, Loss_V_x = 1.5310e-02, Loss_total = 1.7044e-02
Iteration 3000: Loss_V = 4.8858e-03, Loss_V_x = 1.3522e-02, Loss_total = 1.8408e-02
Iteration 4000: Loss_V = 1.2944e-03, Loss_V_x = 1.2328e-02, Loss_total = 1.3622e-02
Iteration 5000: Loss_V = 6.3549e-03, Loss_V_x = 1.1454e-02, Loss_total = 1.7809e-02


The Exploitibility is : 4.770112037658691

 Computing The Best Response 9: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13470 data from 512/512 BVP solutions in 92.9 sec
  → Speed: 5.5 BVP/sec, 145 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 6.4257e-01, Loss_V_x = 1.6959e-02, Loss_HJB = 1.7749e+01, Loss_total = 8.3702e-01
Iteration 1000: Loss_V = 3.8517e-03, Loss_V_x = 1.7881e-02, Loss_HJB = 7.6998e-03, Loss_total = 2.1810e-02
Iteration 2000: Loss_V = 5.8818e-03, Loss_V_x = 1.5999e-02, Loss_HJB = 1.8351e-02, Loss_total = 2.2065e-02
Iteration 3000: Loss_V = 1.7118e-03, Loss_V_x = 1.3969e-02, Loss_HJB = 6.3910e-03, Loss_total = 1.5745e-02
Iteration 4000: Loss_V = 1.1878e-03, Loss_V_x = 1.3608e-02, Loss_HJB = 5.6325e-03, Loss_total = 1.4853e-02
Iteration 5000: Loss_V = 1.0421e-03, Loss_V_x = 1.2904e-02, Loss_HJB = 5.9046e-03, Loss_total = 1.4005e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 22.5 sec 

Iteration 0:  Loss_G = 7.7016e-04,  Loss_ODE = 5.9973e-03,  Loss_total = 1.3699e-03
Iteration 1000:  Loss_G = 1.4523e-04,  Loss_ODE = 3.0241e-03,  Loss_total = 4.4764e-04
Iteration 2000:  Loss_G = 1.4160e-04,  Loss_ODE = 2.8600e-03,  Loss_total = 4.2760e-04
Iteration 3000:  Loss_G = 1.3868e-04,  Loss_ODE = 2.8244e-03,  Loss_total = 4.2113e-04
Iteration 4000:  Loss_G = 1.3839e-04,  Loss_ODE = 2.8704e-03,  Loss_total = 4.2543e-04
Iteration 5000:  Loss_G = 1.3719e-04,  Loss_ODE = 2.7412e-03,  Loss_total = 4.1131e-04


Time t = 0.0
  Relative L2 Error    = 3.7205e-02
  Relative Linf Error  = 1.1223e-01

Time t = 0.5
  Relative L2 Error    = 3.5170e-02
  Relative Linf Error  = 1.4113e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k  9 │ L1=2.731e+00 │ L2=6.334e-01 │ L∞=1.654e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13674 data from 512/512 BVP solutions in 92.3 sec
  → Speed: 5.5 BVP/sec, 148 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 8.2617e-01, Loss_V_x = 1.8692e-02, Loss_total = 8.4486e-01
Iteration 1000: Loss_V = 5.1633e-03, Loss_V_x = 1.5814e-02, Loss_total = 2.0977e-02
Iteration 2000: Loss_V = 1.6952e-03, Loss_V_x = 1.3339e-02, Loss_total = 1.5035e-02
Iteration 3000: Loss_V = 2.3325e-03, Loss_V_x = 1.1876e-02, Loss_total = 1.4208e-02
Iteration 4000: Loss_V = 5.4035e-03, Loss_V_x = 1.0904e-02, Loss_total = 1.6307e-02
Iteration 5000: Loss_V = 1.8036e-03, Loss_V_x = 1.0170e-02, Loss_total = 1.1973e-02


The Exploitibility is : 3.9917588233947754

 Computing The Best Response 10: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13262 data from 512/512 BVP solutions in 90.7 sec
  → Speed: 5.6 BVP/sec, 146 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 5.3854e-01, Loss_V_x = 1.5660e-02, Loss_HJB = 1.4299e+01, Loss_total = 6.9719e-01
Iteration 1000: Loss_V = 4.2476e-03, Loss_V_x = 1.6864e-02, Loss_HJB = 7.8381e-03, Loss_total = 2.1190e-02
Iteration 2000: Loss_V = 2.3553e-03, Loss_V_x = 1.4952e-02, Loss_HJB = 4.8052e-03, Loss_total = 1.7356e-02
Iteration 3000: Loss_V = 3.3580e-03, Loss_V_x = 1.3797e-02, Loss_HJB = 7.9654e-03, Loss_total = 1.7234e-02
Iteration 4000: Loss_V = 1.1533e-03, Loss_V_x = 1.3291e-02, Loss_HJB = 5.7783e-03, Loss_total = 1.4502e-02
Iteration 5000: Loss_V = 1.0801e-03, Loss_V_x = 1.2367e-02, Loss_HJB = 4.0263e-03, Loss_total = 1.3487e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 29.4 sec 

Iteration 0:  Loss_G = 6.5113e-04,  Loss_ODE = 5.6232e-03,  Loss_total = 1.2134e-03
Iteration 1000:  Loss_G = 1.4770e-04,  Loss_ODE = 3.0760e-03,  Loss_total = 4.5529e-04
Iteration 2000:  Loss_G = 1.4520e-04,  Loss_ODE = 3.0004e-03,  Loss_total = 4.4524e-04
Iteration 3000:  Loss_G = 1.4389e-04,  Loss_ODE = 2.9110e-03,  Loss_total = 4.3499e-04
Iteration 4000:  Loss_G = 1.4191e-04,  Loss_ODE = 2.9223e-03,  Loss_total = 4.3414e-04
Iteration 5000:  Loss_G = 1.4015e-04,  Loss_ODE = 2.8460e-03,  Loss_total = 4.2475e-04


Time t = 0.0
  Relative L2 Error    = 3.5285e-02
  Relative Linf Error  = 1.8690e-01

Time t = 0.5
  Relative L2 Error    = 3.2259e-02
  Relative Linf Error  = 1.3509e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 10 │ L1=2.404e+00 │ L2=5.576e-01 │ L∞=1.461e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13901 data from 512/512 BVP solutions in 94.1 sec
  → Speed: 5.4 BVP/sec, 148 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 8.4021e-01, Loss_V_x = 1.7572e-02, Loss_total = 8.5778e-01
Iteration 1000: Loss_V = 4.1111e-03, Loss_V_x = 1.4490e-02, Loss_total = 1.8601e-02
Iteration 2000: Loss_V = 2.1366e-03, Loss_V_x = 1.2459e-02, Loss_total = 1.4596e-02
Iteration 3000: Loss_V = 1.0719e-03, Loss_V_x = 1.1199e-02, Loss_total = 1.2271e-02
Iteration 4000: Loss_V = 1.1280e-03, Loss_V_x = 1.0348e-02, Loss_total = 1.1476e-02
Iteration 5000: Loss_V = 7.8600e-04, Loss_V_x = 9.7190e-03, Loss_total = 1.0505e-02


The Exploitibility is : 3.907860279083252

 Computing The Best Response 11: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13096 data from 512/512 BVP solutions in 90.8 sec
  → Speed: 5.6 BVP/sec, 144 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 5.1416e-01, Loss_V_x = 1.3353e-02, Loss_HJB = 1.3682e+01, Loss_total = 6.6433e-01
Iteration 1000: Loss_V = 4.0072e-03, Loss_V_x = 1.4654e-02, Loss_HJB = 7.7987e-03, Loss_total = 1.8739e-02
Iteration 2000: Loss_V = 3.2312e-03, Loss_V_x = 1.3460e-02, Loss_HJB = 6.9166e-03, Loss_total = 1.6761e-02
Iteration 3000: Loss_V = 1.5863e-03, Loss_V_x = 1.2302e-02, Loss_HJB = 4.3358e-03, Loss_total = 1.3931e-02
Iteration 4000: Loss_V = 6.7375e-03, Loss_V_x = 1.1835e-02, Loss_HJB = 1.5788e-02, Loss_total = 1.8730e-02
Iteration 5000: Loss_V = 3.1196e-03, Loss_V_x = 1.0751e-02, Loss_HJB = 8.0071e-03, Loss_total = 1.3951e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 27.2 sec 

Iteration 0:  Loss_G = 5.4236e-04,  Loss_ODE = 5.2253e-03,  Loss_total = 1.0649e-03
Iteration 1000:  Loss_G = 1.4953e-04,  Loss_ODE = 3.1329e-03,  Loss_total = 4.6281e-04
Iteration 2000:  Loss_G = 1.4665e-04,  Loss_ODE = 3.0193e-03,  Loss_total = 4.4857e-04
Iteration 3000:  Loss_G = 1.4339e-04,  Loss_ODE = 2.9224e-03,  Loss_total = 4.3563e-04
Iteration 4000:  Loss_G = 1.4348e-04,  Loss_ODE = 2.9284e-03,  Loss_total = 4.3631e-04
Iteration 5000:  Loss_G = 1.4199e-04,  Loss_ODE = 2.8044e-03,  Loss_total = 4.2243e-04


Time t = 0.0
  Relative L2 Error    = 3.2657e-02
  Relative Linf Error  = 1.1583e-01

Time t = 0.5
  Relative L2 Error    = 3.0371e-02
  Relative Linf Error  = 1.3227e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 11 │ L1=2.134e+00 │ L2=4.950e-01 │ L∞=1.302e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13278 data from 512/512 BVP solutions in 77.3 sec
  → Speed: 6.6 BVP/sec, 172 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 6.5780e-01, Loss_V_x = 1.5182e-02, Loss_total = 6.7298e-01
Iteration 1000: Loss_V = 4.2061e-03, Loss_V_x = 1.3164e-02, Loss_total = 1.7370e-02
Iteration 2000: Loss_V = 1.5696e-03, Loss_V_x = 1.1265e-02, Loss_total = 1.2835e-02
Iteration 3000: Loss_V = 1.4761e-03, Loss_V_x = 1.0109e-02, Loss_total = 1.1585e-02
Iteration 4000: Loss_V = 9.9545e-04, Loss_V_x = 9.3304e-03, Loss_total = 1.0326e-02
Iteration 5000: Loss_V = 1.4380e-03, Loss_V_x = 8.7709e-03, Loss_total = 1.0209e-02


The Exploitibility is : 3.347992420196533

 Computing The Best Response 12: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13293 data from 512/512 BVP solutions in 80.2 sec
  → Speed: 6.4 BVP/sec, 166 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.5844e-01, Loss_V_x = 1.3239e-02, Loss_HJB = 1.2136e+01, Loss_total = 5.9304e-01
Iteration 1000: Loss_V = 5.4277e-03, Loss_V_x = 1.4101e-02, Loss_HJB = 8.5364e-03, Loss_total = 1.9614e-02
Iteration 2000: Loss_V = 2.2282e-03, Loss_V_x = 1.3081e-02, Loss_HJB = 7.6641e-03, Loss_total = 1.5386e-02
Iteration 3000: Loss_V = 1.2412e-03, Loss_V_x = 1.1991e-02, Loss_HJB = 4.6466e-03, Loss_total = 1.3279e-02
Iteration 4000: Loss_V = 1.0636e-03, Loss_V_x = 1.1362e-02, Loss_HJB = 4.8670e-03, Loss_total = 1.2474e-02
Iteration 5000: Loss_V = 1.5820e-03, Loss_V_x = 1.0918e-02, Loss_HJB = 4.5207e-03, Loss_total = 1.2546e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 21.7 sec 

Iteration 0:  Loss_G = 6.4973e-04,  Loss_ODE = 5.7487e-03,  Loss_total = 1.2246e-03
Iteration 1000:  Loss_G = 1.5215e-04,  Loss_ODE = 3.1695e-03,  Loss_total = 4.6910e-04
Iteration 2000:  Loss_G = 1.4782e-04,  Loss_ODE = 3.0584e-03,  Loss_total = 4.5366e-04
Iteration 3000:  Loss_G = 1.4620e-04,  Loss_ODE = 3.0210e-03,  Loss_total = 4.4830e-04
Iteration 4000:  Loss_G = 1.4409e-04,  Loss_ODE = 2.9751e-03,  Loss_total = 4.4160e-04
Iteration 5000:  Loss_G = 1.4308e-04,  Loss_ODE = 2.9950e-03,  Loss_total = 4.4258e-04


Time t = 0.0
  Relative L2 Error    = 3.2695e-02
  Relative Linf Error  = 1.0471e-01

Time t = 0.5
  Relative L2 Error    = 3.0373e-02
  Relative Linf Error  = 1.3279e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 12 │ L1=2.214e+00 │ L2=5.119e-01 │ L∞=1.354e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13095 data from 512/512 BVP solutions in 88.1 sec
  → Speed: 5.8 BVP/sec, 149 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 5.9862e-01, Loss_V_x = 1.4411e-02, Loss_total = 6.1303e-01
Iteration 1000: Loss_V = 3.4576e-03, Loss_V_x = 1.2039e-02, Loss_total = 1.5496e-02
Iteration 2000: Loss_V = 1.4873e-03, Loss_V_x = 1.0262e-02, Loss_total = 1.1749e-02
Iteration 3000: Loss_V = 1.1582e-03, Loss_V_x = 9.2477e-03, Loss_total = 1.0406e-02
Iteration 4000: Loss_V = 7.8343e-04, Loss_V_x = 8.5917e-03, Loss_total = 9.3751e-03
Iteration 5000: Loss_V = 1.0256e-03, Loss_V_x = 8.1132e-03, Loss_total = 9.1389e-03


The Exploitibility is : 3.2481327056884766

 Computing The Best Response 13: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13046 data from 512/512 BVP solutions in 89.5 sec
  → Speed: 5.7 BVP/sec, 146 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.4575e-01, Loss_V_x = 1.1918e-02, Loss_HJB = 1.2312e+01, Loss_total = 5.8079e-01
Iteration 1000: Loss_V = 4.7434e-03, Loss_V_x = 1.2983e-02, Loss_HJB = 7.5398e-03, Loss_total = 1.7802e-02
Iteration 2000: Loss_V = 1.8439e-03, Loss_V_x = 1.2021e-02, Loss_HJB = 5.2754e-03, Loss_total = 1.3917e-02
Iteration 3000: Loss_V = 2.1481e-03, Loss_V_x = 1.0997e-02, Loss_HJB = 7.8493e-03, Loss_total = 1.3224e-02
Iteration 4000: Loss_V = 1.6840e-03, Loss_V_x = 1.0300e-02, Loss_HJB = 7.2275e-03, Loss_total = 1.2056e-02
Iteration 5000: Loss_V = 1.0693e-03, Loss_V_x = 1.0068e-02, Loss_HJB = 4.7239e-03, Loss_total = 1.1184e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 26.0 sec 

Iteration 0:  Loss_G = 5.9149e-04,  Loss_ODE = 5.6235e-03,  Loss_total = 1.1538e-03
Iteration 1000:  Loss_G = 1.5475e-04,  Loss_ODE = 3.2215e-03,  Loss_total = 4.7691e-04
Iteration 2000:  Loss_G = 1.4937e-04,  Loss_ODE = 3.0749e-03,  Loss_total = 4.5686e-04
Iteration 3000:  Loss_G = 1.4776e-04,  Loss_ODE = 3.0352e-03,  Loss_total = 4.5127e-04
Iteration 4000:  Loss_G = 1.4701e-04,  Loss_ODE = 2.9728e-03,  Loss_total = 4.4429e-04
Iteration 5000:  Loss_G = 1.4586e-04,  Loss_ODE = 2.9618e-03,  Loss_total = 4.4203e-04


Time t = 0.0
  Relative L2 Error    = 3.1678e-02
  Relative Linf Error  = 8.6965e-02

Time t = 0.5
  Relative L2 Error    = 2.8223e-02
  Relative Linf Error  = 1.0588e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 13 │ L1=1.958e+00 │ L2=4.529e-01 │ L∞=1.201e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13188 data from 512/512 BVP solutions in 90.2 sec
  → Speed: 5.7 BVP/sec, 146 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 6.1730e-01, Loss_V_x = 1.3940e-02, Loss_total = 6.3124e-01
Iteration 1000: Loss_V = 6.4176e-03, Loss_V_x = 1.1894e-02, Loss_total = 1.8312e-02
Iteration 2000: Loss_V = 4.0674e-03, Loss_V_x = 1.0248e-02, Loss_total = 1.4316e-02
Iteration 3000: Loss_V = 1.0952e-03, Loss_V_x = 9.2105e-03, Loss_total = 1.0306e-02
Iteration 4000: Loss_V = 8.8012e-04, Loss_V_x = 8.5357e-03, Loss_total = 9.4158e-03
Iteration 5000: Loss_V = 7.6362e-04, Loss_V_x = 8.0432e-03, Loss_total = 8.8068e-03


The Exploitibility is : 3.0290355682373047

 Computing The Best Response 14: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12840 data from 512/512 BVP solutions in 87.9 sec
  → Speed: 5.8 BVP/sec, 146 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.8724e-01, Loss_V_x = 1.1023e-02, Loss_HJB = 1.0832e+01, Loss_total = 5.0658e-01
Iteration 1000: Loss_V = 1.3326e-02, Loss_V_x = 1.1979e-02, Loss_HJB = 3.2976e-02, Loss_total = 2.5635e-02
Iteration 2000: Loss_V = 1.7488e-03, Loss_V_x = 1.1176e-02, Loss_HJB = 4.8859e-03, Loss_total = 1.2974e-02
Iteration 3000: Loss_V = 1.2041e-03, Loss_V_x = 1.0240e-02, Loss_HJB = 4.0310e-03, Loss_total = 1.1485e-02
Iteration 4000: Loss_V = 1.0025e-03, Loss_V_x = 9.7475e-03, Loss_HJB = 3.8716e-03, Loss_total = 1.0789e-02
Iteration 5000: Loss_V = 1.3964e-03, Loss_V_x = 9.5077e-03, Loss_HJB = 4.4492e-03, Loss_total = 1.0949e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 26.1 sec 

Iteration 0:  Loss_G = 5.6259e-04,  Loss_ODE = 5.4392e-03,  Loss_total = 1.1065e-03
Iteration 1000:  Loss_G = 1.5724e-04,  Loss_ODE = 3.1981e-03,  Loss_total = 4.7706e-04
Iteration 2000:  Loss_G = 1.5217e-04,  Loss_ODE = 3.0800e-03,  Loss_total = 4.6017e-04
Iteration 3000:  Loss_G = 1.4983e-04,  Loss_ODE = 3.0149e-03,  Loss_total = 4.5133e-04
Iteration 4000:  Loss_G = 1.4839e-04,  Loss_ODE = 2.9955e-03,  Loss_total = 4.4795e-04
Iteration 5000:  Loss_G = 1.4728e-04,  Loss_ODE = 2.9662e-03,  Loss_total = 4.4390e-04


Time t = 0.0
  Relative L2 Error    = 3.0216e-02
  Relative Linf Error  = 7.0909e-02

Time t = 0.5
  Relative L2 Error    = 2.7341e-02
  Relative Linf Error  = 1.0089e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 14 │ L1=1.955e+00 │ L2=4.513e-01 │ L∞=1.201e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12932 data from 512/512 BVP solutions in 87.3 sec
  → Speed: 5.9 BVP/sec, 148 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 5.7879e-01, Loss_V_x = 1.2399e-02, Loss_total = 5.9119e-01
Iteration 1000: Loss_V = 4.1596e-03, Loss_V_x = 1.0365e-02, Loss_total = 1.4525e-02
Iteration 2000: Loss_V = 1.8861e-03, Loss_V_x = 8.8948e-03, Loss_total = 1.0781e-02
Iteration 3000: Loss_V = 8.8933e-04, Loss_V_x = 8.0479e-03, Loss_total = 8.9372e-03
Iteration 4000: Loss_V = 2.0755e-03, Loss_V_x = 7.5094e-03, Loss_total = 9.5848e-03
Iteration 5000: Loss_V = 2.0092e-03, Loss_V_x = 7.1255e-03, Loss_total = 9.1347e-03


The Exploitibility is : 2.786871910095215

 Computing The Best Response 15: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12520 data from 512/512 BVP solutions in 87.2 sec
  → Speed: 5.9 BVP/sec, 144 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.5895e-01, Loss_V_x = 1.0282e-02, Loss_HJB = 1.0829e+01, Loss_total = 4.7752e-01
Iteration 1000: Loss_V = 4.1225e-03, Loss_V_x = 1.1153e-02, Loss_HJB = 6.8993e-03, Loss_total = 1.5345e-02
Iteration 2000: Loss_V = 1.7429e-03, Loss_V_x = 1.0423e-02, Loss_HJB = 4.8045e-03, Loss_total = 1.2214e-02
Iteration 3000: Loss_V = 1.2440e-02, Loss_V_x = 9.7731e-03, Loss_HJB = 2.3282e-02, Loss_total = 2.2445e-02
Iteration 4000: Loss_V = 8.9719e-04, Loss_V_x = 8.8693e-03, Loss_HJB = 2.9221e-03, Loss_total = 9.7957e-03
Iteration 5000: Loss_V = 3.9624e-03, Loss_V_x = 8.9502e-03, Loss_HJB = 1.2524e-02, Loss_total = 1.3038e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 25.8 sec 

Iteration 0:  Loss_G = 4.9117e-04,  Loss_ODE = 5.3139e-03,  Loss_total = 1.0226e-03
Iteration 1000:  Loss_G = 1.5392e-04,  Loss_ODE = 3.1708e-03,  Loss_total = 4.7100e-04
Iteration 2000:  Loss_G = 1.4888e-04,  Loss_ODE = 3.0418e-03,  Loss_total = 4.5306e-04
Iteration 3000:  Loss_G = 1.4583e-04,  Loss_ODE = 2.9636e-03,  Loss_total = 4.4219e-04
Iteration 4000:  Loss_G = 1.4591e-04,  Loss_ODE = 2.9747e-03,  Loss_total = 4.4338e-04
Iteration 5000:  Loss_G = 1.4411e-04,  Loss_ODE = 2.8132e-03,  Loss_total = 4.2543e-04


Time t = 0.0
  Relative L2 Error    = 2.9399e-02
  Relative Linf Error  = 1.0748e-01

Time t = 0.5
  Relative L2 Error    = 2.6251e-02
  Relative Linf Error  = 8.1120e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 15 │ L1=1.897e+00 │ L2=4.375e-01 │ L∞=1.171e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 13107 data from 512/512 BVP solutions in 91.4 sec
  → Speed: 5.6 BVP/sec, 143 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 5.1248e-01, Loss_V_x = 1.2006e-02, Loss_total = 5.2449e-01
Iteration 1000: Loss_V = 6.1940e-03, Loss_V_x = 1.0250e-02, Loss_total = 1.6444e-02
Iteration 2000: Loss_V = 1.4541e-03, Loss_V_x = 8.8688e-03, Loss_total = 1.0323e-02
Iteration 3000: Loss_V = 6.2448e-03, Loss_V_x = 8.0524e-03, Loss_total = 1.4297e-02
Iteration 4000: Loss_V = 1.0812e-02, Loss_V_x = 7.4919e-03, Loss_total = 1.8304e-02
Iteration 5000: Loss_V = 6.2658e-03, Loss_V_x = 7.1195e-03, Loss_total = 1.3385e-02


The Exploitibility is : 2.7431960105895996

 Computing The Best Response 16: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12615 data from 512/512 BVP solutions in 89.3 sec
  → Speed: 5.7 BVP/sec, 141 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.7022e-01, Loss_V_x = 1.0073e-02, Loss_HJB = 9.9638e+00, Loss_total = 4.7993e-01
Iteration 1000: Loss_V = 1.1944e-02, Loss_V_x = 1.1090e-02, Loss_HJB = 1.5589e-02, Loss_total = 2.3190e-02
Iteration 2000: Loss_V = 1.9803e-03, Loss_V_x = 1.0445e-02, Loss_HJB = 4.7049e-03, Loss_total = 1.2473e-02
Iteration 3000: Loss_V = 1.4195e-03, Loss_V_x = 9.8446e-03, Loss_HJB = 4.9948e-03, Loss_total = 1.1314e-02
Iteration 4000: Loss_V = 1.5825e-03, Loss_V_x = 9.4115e-03, Loss_HJB = 4.8932e-03, Loss_total = 1.1043e-02
Iteration 5000: Loss_V = 2.0825e-03, Loss_V_x = 8.9730e-03, Loss_HJB = 5.3500e-03, Loss_total = 1.1109e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 22.4 sec 

Iteration 0:  Loss_G = 5.8816e-04,  Loss_ODE = 5.5989e-03,  Loss_total = 1.1481e-03
Iteration 1000:  Loss_G = 1.5738e-04,  Loss_ODE = 3.2029e-03,  Loss_total = 4.7767e-04
Iteration 2000:  Loss_G = 1.5236e-04,  Loss_ODE = 3.0585e-03,  Loss_total = 4.5821e-04
Iteration 3000:  Loss_G = 1.4910e-04,  Loss_ODE = 3.0153e-03,  Loss_total = 4.5063e-04
Iteration 4000:  Loss_G = 1.4747e-04,  Loss_ODE = 3.0065e-03,  Loss_total = 4.4812e-04
Iteration 5000:  Loss_G = 1.4555e-04,  Loss_ODE = 2.9851e-03,  Loss_total = 4.4405e-04


Time t = 0.0
  Relative L2 Error    = 2.9652e-02
  Relative Linf Error  = 9.9228e-02

Time t = 0.5
  Relative L2 Error    = 2.7336e-02
  Relative Linf Error  = 1.2755e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 16 │ L1=1.837e+00 │ L2=4.238e-01 │ L∞=1.142e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12690 data from 512/512 BVP solutions in 85.8 sec
  → Speed: 6.0 BVP/sec, 148 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.3440e-01, Loss_V_x = 1.1456e-02, Loss_total = 4.4586e-01
Iteration 1000: Loss_V = 4.3688e-03, Loss_V_x = 9.5730e-03, Loss_total = 1.3942e-02
Iteration 2000: Loss_V = 1.5016e-03, Loss_V_x = 8.2844e-03, Loss_total = 9.7860e-03
Iteration 3000: Loss_V = 1.1181e-03, Loss_V_x = 7.5398e-03, Loss_total = 8.6579e-03
Iteration 4000: Loss_V = 9.9359e-04, Loss_V_x = 7.0530e-03, Loss_total = 8.0466e-03
Iteration 5000: Loss_V = 2.7217e-03, Loss_V_x = 6.7117e-03, Loss_total = 9.4334e-03


The Exploitibility is : 2.562086582183838

 Computing The Best Response 17: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12861 data from 512/512 BVP solutions in 81.1 sec
  → Speed: 6.3 BVP/sec, 159 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.8306e-01, Loss_V_x = 9.3097e-03, Loss_HJB = 9.4171e+00, Loss_total = 4.8654e-01
Iteration 1000: Loss_V = 4.9045e-03, Loss_V_x = 1.0272e-02, Loss_HJB = 6.7684e-03, Loss_total = 1.5245e-02
Iteration 2000: Loss_V = 1.8511e-03, Loss_V_x = 9.7069e-03, Loss_HJB = 4.9698e-03, Loss_total = 1.1608e-02
Iteration 3000: Loss_V = 1.1770e-03, Loss_V_x = 9.1392e-03, Loss_HJB = 4.2095e-03, Loss_total = 1.0358e-02
Iteration 4000: Loss_V = 4.8779e-03, Loss_V_x = 8.8157e-03, Loss_HJB = 9.7183e-03, Loss_total = 1.3791e-02
Iteration 5000: Loss_V = 4.3803e-03, Loss_V_x = 8.0723e-03, Loss_HJB = 8.4238e-03, Loss_total = 1.2537e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 30.0 sec 

Iteration 0:  Loss_G = 4.8343e-04,  Loss_ODE = 5.2180e-03,  Loss_total = 1.0052e-03
Iteration 1000:  Loss_G = 1.5425e-04,  Loss_ODE = 3.1483e-03,  Loss_total = 4.6907e-04
Iteration 2000:  Loss_G = 1.4955e-04,  Loss_ODE = 2.9648e-03,  Loss_total = 4.4604e-04
Iteration 3000:  Loss_G = 1.4718e-04,  Loss_ODE = 2.9916e-03,  Loss_total = 4.4634e-04
Iteration 4000:  Loss_G = 1.4386e-04,  Loss_ODE = 2.7787e-03,  Loss_total = 4.2172e-04
Iteration 5000:  Loss_G = 1.4397e-04,  Loss_ODE = 2.9310e-03,  Loss_total = 4.3707e-04


Time t = 0.0
  Relative L2 Error    = 2.7499e-02
  Relative Linf Error  = 8.3791e-02

Time t = 0.5
  Relative L2 Error    = 2.5816e-02
  Relative Linf Error  = 8.5413e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 17 │ L1=1.683e+00 │ L2=3.881e-01 │ L∞=1.049e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12829 data from 512/512 BVP solutions in 83.0 sec
  → Speed: 6.2 BVP/sec, 155 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.7397e-01, Loss_V_x = 1.0449e-02, Loss_total = 3.8442e-01
Iteration 1000: Loss_V = 5.9877e-03, Loss_V_x = 9.2101e-03, Loss_total = 1.5198e-02
Iteration 2000: Loss_V = 1.6731e-03, Loss_V_x = 8.0771e-03, Loss_total = 9.7501e-03
Iteration 3000: Loss_V = 1.1008e-03, Loss_V_x = 7.3512e-03, Loss_total = 8.4521e-03
Iteration 4000: Loss_V = 9.1744e-04, Loss_V_x = 6.8615e-03, Loss_total = 7.7789e-03
Iteration 5000: Loss_V = 9.1342e-04, Loss_V_x = 6.5142e-03, Loss_total = 7.4276e-03


The Exploitibility is : 2.4709649085998535

 Computing The Best Response 18: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12587 data from 512/512 BVP solutions in 90.4 sec
  → Speed: 5.7 BVP/sec, 139 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 2.8476e-01, Loss_V_x = 8.6126e-03, Loss_HJB = 8.8689e+00, Loss_total = 3.8207e-01
Iteration 1000: Loss_V = 5.1892e-03, Loss_V_x = 9.6355e-03, Loss_HJB = 1.2923e-02, Loss_total = 1.4954e-02
Iteration 2000: Loss_V = 2.4574e-03, Loss_V_x = 8.9291e-03, Loss_HJB = 4.7577e-03, Loss_total = 1.1434e-02
Iteration 3000: Loss_V = 3.6521e-03, Loss_V_x = 8.5507e-03, Loss_HJB = 1.1271e-02, Loss_total = 1.2315e-02
Iteration 4000: Loss_V = 8.0937e-04, Loss_V_x = 7.7901e-03, Loss_HJB = 2.7649e-03, Loss_total = 8.6272e-03
Iteration 5000: Loss_V = 8.6568e-03, Loss_V_x = 7.9503e-03, Loss_HJB = 2.8494e-02, Loss_total = 1.6892e-02


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 28.2 sec 

Iteration 0:  Loss_G = 4.7318e-04,  Loss_ODE = 5.1123e-03,  Loss_total = 9.8441e-04
Iteration 1000:  Loss_G = 1.5408e-04,  Loss_ODE = 3.1396e-03,  Loss_total = 4.6804e-04
Iteration 2000:  Loss_G = 1.4869e-04,  Loss_ODE = 3.0041e-03,  Loss_total = 4.4910e-04
Iteration 3000:  Loss_G = 1.4542e-04,  Loss_ODE = 2.8910e-03,  Loss_total = 4.3451e-04
Iteration 4000:  Loss_G = 1.4464e-04,  Loss_ODE = 2.8987e-03,  Loss_total = 4.3451e-04
Iteration 5000:  Loss_G = 1.4265e-04,  Loss_ODE = 2.8707e-03,  Loss_total = 4.2972e-04


Time t = 0.0
  Relative L2 Error    = 2.6882e-02
  Relative Linf Error  = 8.2606e-02

Time t = 0.5
  Relative L2 Error    = 2.3866e-02
  Relative Linf Error  = 7.0012e-02

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 18 │ L1=1.641e+00 │ L2=3.782e-01 │ L∞=1.028e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12625 data from 512/512 BVP solutions in 90.8 sec
  → Speed: 5.6 BVP/sec, 139 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.1155e-01, Loss_V_x = 1.0258e-02, Loss_total = 4.2181e-01
Iteration 1000: Loss_V = 4.0655e-03, Loss_V_x = 8.8374e-03, Loss_total = 1.2903e-02
Iteration 2000: Loss_V = 1.5351e-03, Loss_V_x = 7.6595e-03, Loss_total = 9.1947e-03
Iteration 3000: Loss_V = 1.2580e-03, Loss_V_x = 6.9656e-03, Loss_total = 8.2237e-03
Iteration 4000: Loss_V = 2.3030e-03, Loss_V_x = 6.5118e-03, Loss_total = 8.8148e-03
Iteration 5000: Loss_V = 1.9799e-03, Loss_V_x = 6.2061e-03, Loss_total = 8.1860e-03


The Exploitibility is : 2.3499603271484375

 Computing The Best Response 19: 

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12292 data from 512/512 BVP solutions in 85.8 sec
  → Speed: 6.0 BVP/sec, 143 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 3.0465e-01, Loss_V_x = 8.5779e-03, Loss_HJB = 7.0923e+00, Loss_total = 3.8415e-01
Iteration 1000: Loss_V = 4.6733e-03, Loss_V_x = 9.4091e-03, Loss_HJB = 6.5251e-03, Loss_total = 1.4148e-02
Iteration 2000: Loss_V = 8.8244e-03, Loss_V_x = 8.8477e-03, Loss_HJB = 1.9734e-02, Loss_total = 1.7869e-02
Iteration 3000: Loss_V = 1.6850e-03, Loss_V_x = 8.0017e-03, Loss_HJB = 3.2048e-03, Loss_total = 9.7188e-03
Iteration 4000: Loss_V = 1.3341e-03, Loss_V_x = 7.8137e-03, Loss_HJB = 4.8554e-03, Loss_total = 9.1963e-03
Iteration 5000: Loss_V = 8.9365e-04, Loss_V_x = 7.8045e-03, Loss_HJB = 4.0294e-03, Loss_total = 8.7385e-03


Generating data_MFG...
Generated 10752 data from 512 IVP solutions in 22.7 sec 

Iteration 0:  Loss_G = 4.7895e-04,  Loss_ODE = 5.0852e-03,  Loss_total = 9.8746e-04
Iteration 1000:  Loss_G = 1.5386e-04,  Loss_ODE = 3.0825e-03,  Loss_total = 4.6210e-04
Iteration 2000:  Loss_G = 1.4709e-04,  Loss_ODE = 2.9025e-03,  Loss_total = 4.3733e-04
Iteration 3000:  Loss_G = 1.4395e-04,  Loss_ODE = 2.8817e-03,  Loss_total = 4.3212e-04
Iteration 4000:  Loss_G = 1.4130e-04,  Loss_ODE = 2.8204e-03,  Loss_total = 4.2333e-04
Iteration 5000:  Loss_G = 1.3942e-04,  Loss_ODE = 2.7849e-03,  Loss_total = 4.1791e-04


Time t = 0.0
  Relative L2 Error    = 2.7299e-02
  Relative Linf Error  = 8.7838e-02

Time t = 0.5
  Relative L2 Error    = 2.4619e-02
  Relative Linf Error  = 1.1071e-01

Time t = 1.0
  Relative L2 Error    = 0.0000e+00
  Relative Linf Error  = 0.0000e+00

k 19 │ L1=1.603e+00 │ L2=3.691e-01 │ L∞=1.010e-01

Find alpha1

Precomputing precise mean with 20000 particles...
Generating data_OC (ThreadPool, N=512)...
16 workers will be used.

Generated 12465 data from 512/512 BVP solutions in 88.2 sec
  → Speed: 5.8 BVP/sec, 141 points/sec

Approximate solution of BVP 

Iteration 0: Loss_V = 4.2397e-01, Loss_V_x = 1.0085e-02, Loss_total = 4.3405e-01
Iteration 1000: Loss_V = 3.7912e-03, Loss_V_x = 8.6790e-03, Loss_total = 1.2470e-02
Iteration 2000: Loss_V = 1.5842e-03, Loss_V_x = 7.5660e-03, Loss_total = 9.1503e-03
Iteration 3000: Loss_V = 1.7976e-03, Loss_V_x = 6.8988e-03, Loss_total = 8.6963e-03
Iteration 4000: Loss_V = 2.3656e-03, Loss_V_x = 6.4527e-03, Loss_total = 8.8184e-03
Iteration 5000: Loss_V = 7.1803e-04, Loss_V_x = 6.1310e-03, Loss_total = 6.8491e-03


The Exploitibility is : 2.4482502937316895
