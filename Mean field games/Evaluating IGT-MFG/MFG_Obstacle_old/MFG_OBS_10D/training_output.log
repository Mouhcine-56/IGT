
========= Round 0 =========

Approximate solution of MFG (Joint V/G Training)

Starting Joint Training of V and G (MFG)...
Epoch     0: Loss_HJB = 7.8149e+01, Loss_ODE = 2.6126e+00
Epoch  1000: Loss_HJB = 1.0850e+01, Loss_ODE = 7.5391e-02
Epoch  2000: Loss_HJB = 4.0752e+00, Loss_ODE = 5.4208e-02
Epoch  3000: Loss_HJB = 1.7706e+00, Loss_ODE = 9.4204e-02
Epoch  4000: Loss_HJB = 6.8434e-01, Loss_ODE = 2.9130e-01
Epoch  5000: Loss_HJB = 4.3737e-01, Loss_ODE = 3.6991e-01
Epoch  6000: Loss_HJB = 2.0230e-01, Loss_ODE = 3.3201e-01
Epoch  7000: Loss_HJB = 1.5968e-01, Loss_ODE = 2.9761e-01
Epoch  8000: Loss_HJB = 1.3286e-01, Loss_ODE = 2.6175e-01
Epoch  9000: Loss_HJB = 1.0996e-01, Loss_ODE = 2.2020e-01
Epoch 10000: Loss_HJB = 7.5860e-02, Loss_ODE = 2.1323e-01



>>> Computing Best Response 0...

Precomputing generator trajectories...
Precomputed 1 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (6/8), Ns_sol=2, retraining HJB...
Iteration     0: Loss = 5.0498e-02
Iteration  1000: Loss = 4.8716e-03

Solving BVP batch (2/64 done, idx=8)...
High failure rate (4/8), Ns_sol=6, retraining HJB...
Iteration     0: Loss = 6.5010e-02
Iteration  1000: Loss = 3.0587e-03

Solving BVP batch (6/64 done, idx=16)...
High failure rate (6/8), Ns_sol=8, retraining HJB...
Iteration     0: Loss = 1.2267e-01
Iteration  1000: Loss = 2.5849e-03

Solving BVP batch (8/64 done, idx=24)...
High failure rate (6/8), Ns_sol=10, retraining HJB...
Iteration     0: Loss = 4.8044e-02
Iteration  1000: Loss = 1.9240e-03

Solving BVP batch (10/64 done, idx=32)...
High failure rate (5/8), Ns_sol=13, retraining HJB...
Iteration     0: Loss = 2.3839e-01
Iteration  1000: Loss = 3.1988e-03

Solving BVP batch (13/64 done, idx=40)...
High failure rate (6/8), Ns_sol=15, retraining HJB...
Iteration     0: Loss = 4.7897e-02
Iteration  1000: Loss = 2.0072e-03

Solving BVP batch (15/64 done, idx=48)...
High failure rate (6/8), Ns_sol=17, retraining HJB...
Iteration     0: Loss = 3.3461e-02
Iteration  1000: Loss = 1.9721e-03

Solving BVP batch (17/64 done, idx=56)...
High failure rate (5/8), Ns_sol=20, retraining HJB...
Iteration     0: Loss = 3.3122e-02
Iteration  1000: Loss = 1.0082e-03

Solving BVP batch (20/64 done, idx=64)...
High failure rate (6/8), Ns_sol=22, retraining HJB...
Iteration     0: Loss = 3.7120e-02
Iteration  1000: Loss = 1.1256e-03

Solving BVP batch (22/64 done, idx=72)...
High failure rate (6/8), Ns_sol=24, retraining HJB...
Iteration     0: Loss = 4.8939e-02
Iteration  1000: Loss = 1.7954e-03

Solving BVP batch (24/64 done, idx=80)...Solving BVP batch (30/64 done, idx=88)...Solving BVP batch (36/64 done, idx=96)...Solving BVP batch (41/64 done, idx=104)...
High failure rate (5/8), Ns_sol=44, retraining HJB...
Iteration     0: Loss = 5.7043e-02
Iteration  1000: Loss = 1.1065e-03

Solving BVP batch (44/64 done, idx=112)...Solving BVP batch (46/64 done, idx=120)...Solving BVP batch (50/64 done, idx=128)...Solving BVP batch (52/64 done, idx=136)...Solving BVP batch (55/64 done, idx=144)...Solving BVP batch (60/64 done, idx=152)...Solving BVP batch (62/64 done, idx=156)...Solving BVP batch (62/64 done, idx=158)...Solving BVP batch (63/64 done, idx=160)...Solving BVP batch (63/64 done, idx=161)...Solving BVP batch (63/64 done, idx=162)...Solving BVP batch (63/64 done, idx=163)...
Generated 127140 data from 64 BVP solutions in 2494.3 sec
Total failures: 100, HJB retrains: 11


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 4.5250e-02, Loss_V_x = 3.9128e-02, Loss_HJB = 5.1358e-02, Loss_total = 1.3574e-01
Iteration  1000: Loss_V = 3.9951e-04, Loss_V_x = 3.9000e-03, Loss_HJB = 3.5837e-03, Loss_total = 7.8832e-03
Iteration  2000: Loss_V = 2.4432e-04, Loss_V_x = 2.8943e-03, Loss_HJB = 1.6585e-03, Loss_total = 4.7972e-03
Iteration  3000: Loss_V = 1.7912e-04, Loss_V_x = 2.3299e-03, Loss_HJB = 8.8442e-04, Loss_total = 3.3935e-03
Iteration  4000: Loss_V = 1.3722e-04, Loss_V_x = 1.9973e-03, Loss_HJB = 5.6586e-04, Loss_total = 2.7004e-03
Iteration  5000: Loss_V = 1.1220e-04, Loss_V_x = 1.7699e-03, Loss_HJB = 3.9239e-04, Loss_total = 2.2745e-03

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 46.1 sec.

Iteration     0 | Loss_G = 2.0837e-02 | Loss_ODE = 7.8536e-02 | Loss_total = 2.0915e-02
Iteration  1000 | Loss_G = 9.4081e-05 | Loss_ODE = 2.5118e-02 | Loss_total = 1.1920e-04
Iteration  2000 | Loss_G = 5.8793e-05 | Loss_ODE = 1.9640e-02 | Loss_total = 7.8433e-05
Iteration  3000 | Loss_G = 4.2470e-05 | Loss_ODE = 1.6679e-02 | Loss_total = 5.9149e-05
Iteration  4000 | Loss_G = 3.3837e-05 | Loss_ODE = 1.4037e-02 | Loss_total = 4.7874e-05
Iteration  5000 | Loss_G = 2.9819e-05 | Loss_ODE = 1.2718e-02 | Loss_total = 4.2537e-05

k  0 â”‚ L1=5.877e+00 â”‚ L2=1.486e+00 â”‚ Lâˆž=4.892e-01
Precomputing generator trajectories...
Precomputed 2 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (4/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 2.1488e-01
Iteration  1000: Loss = 2.3777e-03

Solving BVP batch (4/64 done, idx=8)...Solving BVP batch (11/64 done, idx=16)...Solving BVP batch (16/64 done, idx=24)...
High failure rate (4/8), Ns_sol=20, retraining HJB...
Iteration     0: Loss = 5.8814e-02
Iteration  1000: Loss = 1.0664e-03

Solving BVP batch (20/64 done, idx=32)...
High failure rate (7/8), Ns_sol=21, retraining HJB...
Iteration     0: Loss = 5.1125e-02
Iteration  1000: Loss = 1.0531e-03

Solving BVP batch (21/64 done, idx=40)...
High failure rate (4/8), Ns_sol=25, retraining HJB...
Iteration     0: Loss = 5.1757e-02
Iteration  1000: Loss = 7.8902e-04

Solving BVP batch (25/64 done, idx=48)...
High failure rate (4/8), Ns_sol=29, retraining HJB...
Iteration     0: Loss = 4.0740e-02
Iteration  1000: Loss = 7.1711e-04

Solving BVP batch (29/64 done, idx=56)...
High failure rate (6/8), Ns_sol=31, retraining HJB...
Iteration     0: Loss = 9.4784e-02
Iteration  1000: Loss = 8.5230e-04

Solving BVP batch (31/64 done, idx=64)...
High failure rate (5/8), Ns_sol=34, retraining HJB...
Iteration     0: Loss = 6.3579e-02
Iteration  1000: Loss = 6.2209e-04

Solving BVP batch (34/64 done, idx=72)...
High failure rate (8/8), Ns_sol=34, retraining HJB...
Iteration     0: Loss = 5.7880e-02
Iteration  1000: Loss = 6.5834e-04

Solving BVP batch (34/64 done, idx=80)...
High failure rate (7/8), Ns_sol=35, retraining HJB...
Iteration     0: Loss = 3.0879e-02
Iteration  1000: Loss = 7.7489e-04

Solving BVP batch (35/64 done, idx=88)...
High failure rate (6/8), Ns_sol=37, retraining HJB...
Iteration     0: Loss = 3.9778e-02
Iteration  1000: Loss = 5.9658e-04

Solving BVP batch (37/64 done, idx=96)...
High failure rate (6/8), Ns_sol=39, retraining HJB...
Iteration     0: Loss = 4.8750e-02
Iteration  1000: Loss = 5.2738e-04

Solving BVP batch (39/64 done, idx=104)...
High failure rate (8/8), Ns_sol=39, retraining HJB...
Iteration     0: Loss = 4.9055e-02
Iteration  1000: Loss = 7.0052e-04

Solving BVP batch (39/64 done, idx=112)...
High failure rate (6/8), Ns_sol=41, retraining HJB...
Iteration     0: Loss = 3.8497e-02
Iteration  1000: Loss = 6.8830e-04

Solving BVP batch (41/64 done, idx=120)...
High failure rate (6/8), Ns_sol=43, retraining HJB...
Iteration     0: Loss = 1.8822e-02
Iteration  1000: Loss = 6.0242e-04

Solving BVP batch (43/64 done, idx=128)...Solving BVP batch (46/64 done, idx=136)...Solving BVP batch (52/64 done, idx=144)...Solving BVP batch (55/64 done, idx=152)...Solving BVP batch (56/64 done, idx=160)...Solving BVP batch (57/64 done, idx=168)...Solving BVP batch (58/64 done, idx=175)...Solving BVP batch (60/64 done, idx=181)...Solving BVP batch (62/64 done, idx=185)...
Generated 106695 data from 64 BVP solutions in 2200.6 sec
Total failures: 123, HJB retrains: 14


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.2179e-02, Loss_V_x = 1.9650e-02, Loss_HJB = 6.0753e-02, Loss_total = 9.2582e-02
Iteration  1000: Loss_V = 3.2318e-04, Loss_V_x = 2.8881e-03, Loss_HJB = 1.6172e-03, Loss_total = 4.8285e-03
Iteration  2000: Loss_V = 1.7305e-04, Loss_V_x = 2.2339e-03, Loss_HJB = 7.8256e-04, Loss_total = 3.1895e-03
Iteration  3000: Loss_V = 1.2173e-04, Loss_V_x = 1.8774e-03, Loss_HJB = 4.9082e-04, Loss_total = 2.4900e-03
Iteration  4000: Loss_V = 9.3780e-05, Loss_V_x = 1.6288e-03, Loss_HJB = 3.4563e-04, Loss_total = 2.0682e-03
Iteration  5000: Loss_V = 7.7578e-05, Loss_V_x = 1.4437e-03, Loss_HJB = 2.6861e-04, Loss_total = 1.7899e-03

[1;32mExploitability: 0.590511[0m
Step Time: 4944.8 sec


>>> Computing Best Response 1...

Precomputing generator trajectories...
Precomputed 2 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (8/64 done, idx=8)...Solving BVP batch (16/64 done, idx=16)...Solving BVP batch (23/64 done, idx=24)...Solving BVP batch (29/64 done, idx=32)...Solving BVP batch (37/64 done, idx=40)...Solving BVP batch (44/64 done, idx=48)...Solving BVP batch (52/64 done, idx=56)...Solving BVP batch (59/64 done, idx=64)...
Generated 27281 data from 64 BVP solutions in 368.5 sec
Total failures: 5, HJB retrains: 0


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 7.1395e-03, Loss_V_x = 2.6968e-03, Loss_HJB = 5.6870e-02, Loss_total = 6.6706e-02
Iteration  1000: Loss_V = 1.2085e-04, Loss_V_x = 1.6540e-03, Loss_HJB = 1.4344e-03, Loss_total = 3.2093e-03
Iteration  2000: Loss_V = 9.2442e-05, Loss_V_x = 1.3342e-03, Loss_HJB = 6.7934e-04, Loss_total = 2.1060e-03
Iteration  3000: Loss_V = 7.8267e-05, Loss_V_x = 1.1835e-03, Loss_HJB = 4.2355e-04, Loss_total = 1.6853e-03
Iteration  4000: Loss_V = 6.6712e-05, Loss_V_x = 1.0732e-03, Loss_HJB = 3.0215e-04, Loss_total = 1.4420e-03
Iteration  5000: Loss_V = 5.8038e-05, Loss_V_x = 9.8460e-04, Loss_HJB = 2.0591e-04, Loss_total = 1.2485e-03

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 41.8 sec.

Iteration     0 | Loss_G = 3.3246e-02 | Loss_ODE = 1.2516e-01 | Loss_total = 3.3371e-02
Iteration  1000 | Loss_G = 6.3066e-05 | Loss_ODE = 3.2353e-02 | Loss_total = 9.5419e-05
Iteration  2000 | Loss_G = 3.4384e-05 | Loss_ODE = 2.0853e-02 | Loss_total = 5.5236e-05
Iteration  3000 | Loss_G = 2.5967e-05 | Loss_ODE = 1.7747e-02 | Loss_total = 4.3714e-05
Iteration  4000 | Loss_G = 1.9749e-05 | Loss_ODE = 1.3425e-02 | Loss_total = 3.3173e-05
Iteration  5000 | Loss_G = 2.1429e-05 | Loss_ODE = 1.3210e-02 | Loss_total = 3.4639e-05

k  1 â”‚ L1=2.650e+00 â”‚ L2=6.713e-01 â”‚ Lâˆž=2.591e-01
Precomputing generator trajectories...
Precomputed 3 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (6/8), Ns_sol=2, retraining HJB...
Iteration     0: Loss = 1.3505e-01
Iteration  1000: Loss = 1.0914e-03

Solving BVP batch (2/64 done, idx=8)...
High failure rate (6/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 8.8010e-02
Iteration  1000: Loss = 8.4216e-04

Solving BVP batch (4/64 done, idx=16)...
High failure rate (8/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 3.2604e-02
Iteration  1000: Loss = 3.6559e-04

Solving BVP batch (4/64 done, idx=24)...
High failure rate (7/8), Ns_sol=5, retraining HJB...
Iteration     0: Loss = 2.2717e-02
Iteration  1000: Loss = 3.9129e-04

Solving BVP batch (5/64 done, idx=32)...
High failure rate (7/8), Ns_sol=6, retraining HJB...
Iteration     0: Loss = 5.4282e-02
Iteration  1000: Loss = 3.6437e-04

Solving BVP batch (6/64 done, idx=40)...
High failure rate (7/8), Ns_sol=7, retraining HJB...
Iteration     0: Loss = 6.5390e-02
Iteration  1000: Loss = 4.7616e-04

Solving BVP batch (7/64 done, idx=48)...
High failure rate (6/8), Ns_sol=9, retraining HJB...
Iteration     0: Loss = 2.7920e-02
Iteration  1000: Loss = 2.9778e-04

Solving BVP batch (9/64 done, idx=56)...
High failure rate (5/8), Ns_sol=12, retraining HJB...
Iteration     0: Loss = 1.2327e-01
Iteration  1000: Loss = 4.6603e-04

Solving BVP batch (12/64 done, idx=64)...
High failure rate (6/8), Ns_sol=14, retraining HJB...
Iteration     0: Loss = 4.1497e-02
Iteration  1000: Loss = 4.1267e-04

Solving BVP batch (14/64 done, idx=72)...
High failure rate (8/8), Ns_sol=14, retraining HJB...
Iteration     0: Loss = 1.2797e-01
Iteration  1000: Loss = 6.0053e-04

Solving BVP batch (14/64 done, idx=80)...
High failure rate (7/8), Ns_sol=15, retraining HJB...
Iteration     0: Loss = 2.2817e-02
Iteration  1000: Loss = 2.9788e-04

Solving BVP batch (15/64 done, idx=88)...
High failure rate (6/8), Ns_sol=17, retraining HJB...
Iteration     0: Loss = 4.4654e-02
Iteration  1000: Loss = 4.8470e-04

Solving BVP batch (17/64 done, idx=96)...
High failure rate (7/8), Ns_sol=18, retraining HJB...
Iteration     0: Loss = 3.1245e-02
Iteration  1000: Loss = 3.6484e-04

Solving BVP batch (18/64 done, idx=104)...
High failure rate (4/8), Ns_sol=22, retraining HJB...
Iteration     0: Loss = 2.1667e-02
Iteration  1000: Loss = 3.5156e-04

Solving BVP batch (22/64 done, idx=112)...
High failure rate (6/8), Ns_sol=24, retraining HJB...
Iteration     0: Loss = 3.9017e-02
Iteration  1000: Loss = 4.4635e-04

Solving BVP batch (24/64 done, idx=120)...Solving BVP batch (25/64 done, idx=128)...Solving BVP batch (25/64 done, idx=136)...Solving BVP batch (27/64 done, idx=144)...Solving BVP batch (28/64 done, idx=152)...Solving BVP batch (31/64 done, idx=160)...Solving BVP batch (34/64 done, idx=168)...Solving BVP batch (35/64 done, idx=176)...Solving BVP batch (36/64 done, idx=184)...
Regenerating initial conditions (have 37/64)...
Solving BVP batch (37/64 done, idx=0)...Solving BVP batch (37/64 done, idx=8)...Solving BVP batch (39/64 done, idx=16)...Solving BVP batch (40/64 done, idx=24)...Solving BVP batch (41/64 done, idx=32)...Solving BVP batch (42/64 done, idx=40)...Solving BVP batch (43/64 done, idx=48)...Solving BVP batch (44/64 done, idx=56)...Solving BVP batch (46/64 done, idx=64)...Solving BVP batch (47/64 done, idx=72)...Solving BVP batch (50/64 done, idx=80)...Solving BVP batch (52/64 done, idx=88)...Solving BVP batch (53/64 done, idx=96)...Solving BVP batch (56/64 done, idx=104)...Solving BVP batch (58/64 done, idx=112)...Solving BVP batch (58/64 done, idx=118)...Solving BVP batch (58/64 done, idx=124)...Solving BVP batch (58/64 done, idx=130)...Solving BVP batch (59/64 done, idx=136)...Solving BVP batch (59/64 done, idx=141)...Solving BVP batch (61/64 done, idx=146)...Solving BVP batch (61/64 done, idx=149)...Solving BVP batch (61/64 done, idx=152)...Solving BVP batch (63/64 done, idx=155)...Solving BVP batch (63/64 done, idx=156)...
Generated 126678 data from 64 BVP solutions in 5485.0 sec
Total failures: 285, HJB retrains: 15


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 4.9092e-03, Loss_V_x = 1.5977e-02, Loss_HJB = 3.1188e-02, Loss_total = 5.2075e-02
Iteration  1000: Loss_V = 4.5287e-05, Loss_V_x = 1.1872e-03, Loss_HJB = 7.2875e-04, Loss_total = 1.9613e-03
Iteration  2000: Loss_V = 3.8424e-05, Loss_V_x = 1.0043e-03, Loss_HJB = 3.4493e-04, Loss_total = 1.3877e-03
Iteration  3000: Loss_V = 3.4602e-05, Loss_V_x = 8.7823e-04, Loss_HJB = 2.0214e-04, Loss_total = 1.1150e-03
Iteration  4000: Loss_V = 3.0823e-05, Loss_V_x = 7.7538e-04, Loss_HJB = 1.2521e-04, Loss_total = 9.3142e-04
Iteration  5000: Loss_V = 2.7703e-05, Loss_V_x = 6.9236e-04, Loss_HJB = 9.1666e-05, Loss_total = 8.1173e-04

[1;32mExploitability: 0.658128[0m
Step Time: 6082.1 sec


>>> Computing Best Response 2...

Precomputing generator trajectories...
Precomputed 3 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (5/64 done, idx=8)...Solving BVP batch (13/64 done, idx=16)...Solving BVP batch (18/64 done, idx=24)...
High failure rate (4/8), Ns_sol=22, retraining HJB...
Iteration     0: Loss = 7.3917e-02
Iteration  1000: Loss = 5.6037e-04

Solving BVP batch (22/64 done, idx=32)...Solving BVP batch (27/64 done, idx=40)...Solving BVP batch (34/64 done, idx=48)...Solving BVP batch (41/64 done, idx=56)...Solving BVP batch (46/64 done, idx=64)...Solving BVP batch (51/64 done, idx=72)...Solving BVP batch (57/64 done, idx=80)...Solving BVP batch (62/64 done, idx=87)...
Generated 44346 data from 64 BVP solutions in 1425.9 sec
Total failures: 25, HJB retrains: 1


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 1.1492e-02, Loss_V_x = 1.3825e-02, Loss_HJB = 2.6472e-02, Loss_total = 5.1788e-02
Iteration  1000: Loss_V = 8.2733e-05, Loss_V_x = 1.0266e-03, Loss_HJB = 6.1568e-04, Loss_total = 1.7250e-03
Iteration  2000: Loss_V = 4.5974e-05, Loss_V_x = 8.4937e-04, Loss_HJB = 2.3714e-04, Loss_total = 1.1325e-03
Iteration  3000: Loss_V = 3.6359e-05, Loss_V_x = 7.4211e-04, Loss_HJB = 1.2354e-04, Loss_total = 9.0200e-04
Iteration  4000: Loss_V = 2.9403e-05, Loss_V_x = 6.5485e-04, Loss_HJB = 7.9168e-05, Loss_total = 7.6342e-04
Iteration  5000: Loss_V = 2.5042e-05, Loss_V_x = 5.7958e-04, Loss_HJB = 7.6337e-05, Loss_total = 6.8096e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 45.0 sec.

Iteration     0 | Loss_G = 3.0890e-02 | Loss_ODE = 1.0809e-01 | Loss_total = 3.0998e-02
Iteration  1000 | Loss_G = 4.2587e-05 | Loss_ODE = 1.4301e-02 | Loss_total = 5.6888e-05
Iteration  2000 | Loss_G = 2.4098e-05 | Loss_ODE = 9.8844e-03 | Loss_total = 3.3982e-05
Iteration  3000 | Loss_G = 1.8177e-05 | Loss_ODE = 6.9998e-03 | Loss_total = 2.5176e-05
Iteration  4000 | Loss_G = 1.3316e-05 | Loss_ODE = 5.5007e-03 | Loss_total = 1.8817e-05
Iteration  5000 | Loss_G = 1.6035e-05 | Loss_ODE = 5.2211e-03 | Loss_total = 2.1256e-05

k  2 â”‚ L1=5.303e+00 â”‚ L2=1.295e+00 â”‚ Lâˆž=3.800e-01
Precomputing generator trajectories...
Precomputed 4 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (6/8), Ns_sol=2, retraining HJB...
Iteration     0: Loss = 1.4718e-01
Iteration  1000: Loss = 1.9979e-03

Solving BVP batch (2/64 done, idx=8)...Solving BVP batch (10/64 done, idx=16)...Solving BVP batch (18/64 done, idx=24)...Solving BVP batch (26/64 done, idx=32)...Solving BVP batch (34/64 done, idx=40)...Solving BVP batch (42/64 done, idx=48)...Solving BVP batch (49/64 done, idx=56)...Solving BVP batch (57/64 done, idx=64)...
Generated 14302 data from 64 BVP solutions in 176.4 sec
Total failures: 7, HJB retrains: 1


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.6917e-02, Loss_V_x = 1.9335e-02, Loss_HJB = 7.2991e-02, Loss_total = 1.0924e-01
Iteration  1000: Loss_V = 2.5783e-03, Loss_V_x = 1.6250e-03, Loss_HJB = 1.6500e-03, Loss_total = 5.8533e-03
Iteration  2000: Loss_V = 1.9442e-03, Loss_V_x = 1.3455e-03, Loss_HJB = 7.5818e-04, Loss_total = 4.0479e-03
Iteration  3000: Loss_V = 1.5856e-03, Loss_V_x = 1.2391e-03, Loss_HJB = 4.4019e-04, Loss_total = 3.2649e-03
Iteration  4000: Loss_V = 1.3099e-03, Loss_V_x = 1.1864e-03, Loss_HJB = 2.7136e-04, Loss_total = 2.7677e-03
Iteration  5000: Loss_V = 1.1250e-03, Loss_V_x = 1.1365e-03, Loss_HJB = 1.8015e-04, Loss_total = 2.4417e-03

[1;32mExploitability: 0.873713[0m
Step Time: 1815.1 sec


>>> Computing Best Response 3...

Precomputing generator trajectories...
Precomputed 4 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (8/64 done, idx=8)...
High failure rate (4/8), Ns_sol=12, retraining HJB...
Iteration     0: Loss = 9.9074e-02
Iteration  1000: Loss = 8.7138e-04

Solving BVP batch (12/64 done, idx=16)...
High failure rate (5/8), Ns_sol=15, retraining HJB...
Iteration     0: Loss = 4.4124e-02
Iteration  1000: Loss = 3.8951e-04

Solving BVP batch (15/64 done, idx=24)...
High failure rate (5/8), Ns_sol=18, retraining HJB...
Iteration     0: Loss = 3.3728e-02
Iteration  1000: Loss = 4.2864e-04

Solving BVP batch (18/64 done, idx=32)...
High failure rate (5/8), Ns_sol=21, retraining HJB...
Iteration     0: Loss = 3.6399e-02
Iteration  1000: Loss = 5.1298e-04

Solving BVP batch (21/64 done, idx=40)...Solving BVP batch (26/64 done, idx=48)...Solving BVP batch (31/64 done, idx=56)...Solving BVP batch (37/64 done, idx=64)...
High failure rate (5/8), Ns_sol=40, retraining HJB...
Iteration     0: Loss = 6.0039e-02
Iteration  1000: Loss = 3.9068e-04

Solving BVP batch (40/64 done, idx=72)...Solving BVP batch (45/64 done, idx=80)...Solving BVP batch (50/64 done, idx=88)...Solving BVP batch (52/64 done, idx=96)...Solving BVP batch (56/64 done, idx=104)...Solving BVP batch (62/64 done, idx=112)...Solving BVP batch (63/64 done, idx=114)...
Generated 63623 data from 64 BVP solutions in 3584.9 sec
Total failures: 51, HJB retrains: 5


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 5.1818e-03, Loss_V_x = 1.2692e-02, Loss_HJB = 3.3941e-02, Loss_total = 5.1814e-02
Iteration  1000: Loss_V = 1.1331e-04, Loss_V_x = 1.3640e-03, Loss_HJB = 6.6854e-04, Loss_total = 2.1458e-03
Iteration  2000: Loss_V = 6.7369e-05, Loss_V_x = 1.0370e-03, Loss_HJB = 3.0752e-04, Loss_total = 1.4119e-03
Iteration  3000: Loss_V = 5.0299e-05, Loss_V_x = 8.6544e-04, Loss_HJB = 1.8009e-04, Loss_total = 1.0958e-03
Iteration  4000: Loss_V = 4.0107e-05, Loss_V_x = 7.5909e-04, Loss_HJB = 1.2014e-04, Loss_total = 9.1934e-04
Iteration  5000: Loss_V = 3.4526e-05, Loss_V_x = 6.8463e-04, Loss_HJB = 8.6763e-05, Loss_total = 8.0591e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 40.4 sec.

Iteration     0 | Loss_G = 4.2598e-02 | Loss_ODE = 1.0033e-01 | Loss_total = 4.2699e-02
Iteration  1000 | Loss_G = 4.4994e-05 | Loss_ODE = 1.5753e-02 | Loss_total = 6.0747e-05
Iteration  2000 | Loss_G = 2.4037e-05 | Loss_ODE = 9.1322e-03 | Loss_total = 3.3170e-05
Iteration  3000 | Loss_G = 1.6215e-05 | Loss_ODE = 7.2140e-03 | Loss_total = 2.3429e-05
Iteration  4000 | Loss_G = 1.7581e-05 | Loss_ODE = 6.3741e-03 | Loss_total = 2.3955e-05
Iteration  5000 | Loss_G = 1.1199e-05 | Loss_ODE = 7.1188e-03 | Loss_total = 1.8318e-05

k  3 â”‚ L1=2.597e+00 â”‚ L2=6.287e-01 â”‚ Lâˆž=1.755e-01
Precomputing generator trajectories...
Precomputed 5 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (7/8), Ns_sol=1, retraining HJB...
Iteration     0: Loss = 1.6591e-01
Iteration  1000: Loss = 9.7957e-04

Solving BVP batch (1/64 done, idx=8)...Solving BVP batch (9/64 done, idx=16)...Solving BVP batch (17/64 done, idx=24)...Solving BVP batch (25/64 done, idx=32)...Solving BVP batch (33/64 done, idx=40)...Solving BVP batch (41/64 done, idx=48)...Solving BVP batch (49/64 done, idx=56)...Solving BVP batch (57/64 done, idx=64)...
Generated 13120 data from 64 BVP solutions in 155.0 sec
Total failures: 7, HJB retrains: 1


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.0381e-03, Loss_V_x = 9.5462e-03, Loss_HJB = 2.9677e-02, Loss_total = 4.0262e-02
Iteration  1000: Loss_V = 1.8837e-05, Loss_V_x = 7.1413e-04, Loss_HJB = 3.9479e-04, Loss_total = 1.1278e-03
Iteration  2000: Loss_V = 1.6946e-05, Loss_V_x = 4.9603e-04, Loss_HJB = 4.0869e-04, Loss_total = 9.2167e-04
Iteration  3000: Loss_V = 9.9403e-06, Loss_V_x = 4.1198e-04, Loss_HJB = 9.1479e-05, Loss_total = 5.1340e-04
Iteration  4000: Loss_V = 8.9503e-06, Loss_V_x = 3.6219e-04, Loss_HJB = 6.1990e-05, Loss_total = 4.3313e-04
Iteration  5000: Loss_V = 8.3027e-06, Loss_V_x = 3.2594e-04, Loss_HJB = 4.5696e-05, Loss_total = 3.7994e-04

[1;32mExploitability: 0.885468[0m
Step Time: 3974.9 sec


>>> Computing Best Response 4...

Precomputing generator trajectories...
Precomputed 5 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (5/64 done, idx=8)...Solving BVP batch (10/64 done, idx=16)...
High failure rate (7/8), Ns_sol=11, retraining HJB...
Iteration     0: Loss = 7.9714e-02
Iteration  1000: Loss = 6.4249e-04

Solving BVP batch (11/64 done, idx=24)...Solving BVP batch (16/64 done, idx=32)...
High failure rate (6/8), Ns_sol=18, retraining HJB...
Iteration     0: Loss = 2.0536e-02
Iteration  1000: Loss = 2.1978e-04

Solving BVP batch (18/64 done, idx=40)...
High failure rate (4/8), Ns_sol=22, retraining HJB...
Iteration     0: Loss = 3.9822e-02
Iteration  1000: Loss = 3.8072e-04

Solving BVP batch (22/64 done, idx=48)...
High failure rate (4/8), Ns_sol=26, retraining HJB...
Iteration     0: Loss = 2.1587e-02
Iteration  1000: Loss = 3.1391e-04

Solving BVP batch (26/64 done, idx=56)...
High failure rate (5/8), Ns_sol=29, retraining HJB...
Iteration     0: Loss = 2.5190e-02
Iteration  1000: Loss = 3.5392e-04

Solving BVP batch (29/64 done, idx=64)...Solving BVP batch (34/64 done, idx=72)...
High failure rate (4/8), Ns_sol=38, retraining HJB...
Iteration     0: Loss = 3.7316e-02
Iteration  1000: Loss = 3.4890e-04

Solving BVP batch (38/64 done, idx=80)...
High failure rate (6/8), Ns_sol=40, retraining HJB...
Iteration     0: Loss = 3.3925e-02
Iteration  1000: Loss = 3.4610e-04

Solving BVP batch (40/64 done, idx=88)...Solving BVP batch (45/64 done, idx=96)...Solving BVP batch (48/64 done, idx=104)...Solving BVP batch (51/64 done, idx=112)...Solving BVP batch (57/64 done, idx=120)...Solving BVP batch (62/64 done, idx=127)...
Generated 53762 data from 64 BVP solutions in 5141.6 sec
Total failures: 65, HJB retrains: 7


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 2.8192e-02, Loss_V_x = 2.4475e-02, Loss_HJB = 3.5707e-02, Loss_total = 8.8375e-02
Iteration  1000: Loss_V = 5.9766e-05, Loss_V_x = 1.1421e-03, Loss_HJB = 4.0641e-04, Loss_total = 1.6083e-03
Iteration  2000: Loss_V = 4.7303e-05, Loss_V_x = 8.5253e-04, Loss_HJB = 2.7998e-04, Loss_total = 1.1798e-03
Iteration  3000: Loss_V = 3.2671e-05, Loss_V_x = 7.2803e-04, Loss_HJB = 1.5257e-04, Loss_total = 9.1327e-04
Iteration  4000: Loss_V = 2.9385e-05, Loss_V_x = 6.4198e-04, Loss_HJB = 1.2267e-04, Loss_total = 7.9404e-04
Iteration  5000: Loss_V = 2.5628e-05, Loss_V_x = 5.8067e-04, Loss_HJB = 9.3693e-05, Loss_total = 6.9999e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 46.0 sec.

Iteration     0 | Loss_G = 2.4897e-02 | Loss_ODE = 7.0397e-02 | Loss_total = 2.4968e-02
Iteration  1000 | Loss_G = 3.7460e-05 | Loss_ODE = 1.4364e-02 | Loss_total = 5.1824e-05
Iteration  2000 | Loss_G = 2.2148e-05 | Loss_ODE = 9.2787e-03 | Loss_total = 3.1427e-05
Iteration  3000 | Loss_G = 1.5872e-05 | Loss_ODE = 6.3170e-03 | Loss_total = 2.2189e-05
Iteration  4000 | Loss_G = 1.4524e-05 | Loss_ODE = 5.4595e-03 | Loss_total = 1.9984e-05
Iteration  5000 | Loss_G = 1.0426e-05 | Loss_ODE = 4.6928e-03 | Loss_total = 1.5119e-05

k  4 â”‚ L1=1.802e+00 â”‚ L2=4.519e-01 â”‚ Lâˆž=1.394e-01
Precomputing generator trajectories...
Precomputed 6 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (5/64 done, idx=8)...
High failure rate (6/8), Ns_sol=7, retraining HJB...
Iteration     0: Loss = 4.6814e-02
Iteration  1000: Loss = 2.9224e-04

Solving BVP batch (7/64 done, idx=16)...Solving BVP batch (12/64 done, idx=24)...Solving BVP batch (18/64 done, idx=32)...Solving BVP batch (23/64 done, idx=40)...Solving BVP batch (29/64 done, idx=48)...
High failure rate (4/8), Ns_sol=33, retraining HJB...
Iteration     0: Loss = 2.6852e-02
Iteration  1000: Loss = 2.9832e-04

Solving BVP batch (33/64 done, idx=56)...Solving BVP batch (39/64 done, idx=64)...
High failure rate (4/8), Ns_sol=43, retraining HJB...
Iteration     0: Loss = 1.3432e-01
Iteration  1000: Loss = 6.6334e-04

Solving BVP batch (43/64 done, idx=72)...Solving BVP batch (46/64 done, idx=80)...Solving BVP batch (49/64 done, idx=88)...Solving BVP batch (55/64 done, idx=96)...Solving BVP batch (60/64 done, idx=104)...Solving BVP batch (61/64 done, idx=108)...Solving BVP batch (61/64 done, idx=111)...
Generated 47954 data from 64 BVP solutions in 949.0 sec
Total failures: 50, HJB retrains: 3


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 4.4686e-02, Loss_V_x = 2.5169e-02, Loss_HJB = 2.4571e-02, Loss_total = 9.4427e-02
Iteration  1000: Loss_V = 1.4775e-03, Loss_V_x = 3.8286e-03, Loss_HJB = 1.4634e-03, Loss_total = 6.7696e-03
Iteration  2000: Loss_V = 1.2316e-03, Loss_V_x = 3.0037e-03, Loss_HJB = 6.8104e-04, Loss_total = 4.9163e-03
Iteration  3000: Loss_V = 1.1637e-03, Loss_V_x = 2.5404e-03, Loss_HJB = 5.7795e-04, Loss_total = 4.2821e-03
Iteration  4000: Loss_V = 1.1488e-03, Loss_V_x = 2.2711e-03, Loss_HJB = 3.5551e-04, Loss_total = 3.7754e-03
Iteration  5000: Loss_V = 1.1250e-03, Loss_V_x = 2.0715e-03, Loss_HJB = 3.0160e-04, Loss_total = 3.4981e-03

[1;32mExploitability: 0.317829[0m
Step Time: 6352.9 sec


>>> Computing Best Response 5...

Precomputing generator trajectories...
Precomputed 6 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (5/64 done, idx=8)...
High failure rate (4/8), Ns_sol=9, retraining HJB...
Iteration     0: Loss = 6.8151e-02
Iteration  1000: Loss = 4.4010e-04

Solving BVP batch (9/64 done, idx=16)...Solving BVP batch (15/64 done, idx=24)...Solving BVP batch (21/64 done, idx=32)...Solving BVP batch (26/64 done, idx=40)...Solving BVP batch (33/64 done, idx=48)...Solving BVP batch (38/64 done, idx=56)...Solving BVP batch (44/64 done, idx=64)...Solving BVP batch (51/64 done, idx=72)...Solving BVP batch (59/64 done, idx=80)...Solving BVP batch (61/64 done, idx=85)...
Generated 46155 data from 64 BVP solutions in 2685.3 sec
Total failures: 24, HJB retrains: 1


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 5.1637e-03, Loss_V_x = 1.0963e-02, Loss_HJB = 3.0076e-02, Loss_total = 4.6203e-02
Iteration  1000: Loss_V = 5.8139e-05, Loss_V_x = 1.1361e-03, Loss_HJB = 5.1129e-04, Loss_total = 1.7055e-03
Iteration  2000: Loss_V = 4.6595e-05, Loss_V_x = 9.1941e-04, Loss_HJB = 2.7925e-04, Loss_total = 1.2453e-03
Iteration  3000: Loss_V = 3.9210e-05, Loss_V_x = 7.8754e-04, Loss_HJB = 1.7641e-04, Loss_total = 1.0032e-03
Iteration  4000: Loss_V = 3.3411e-05, Loss_V_x = 6.8845e-04, Loss_HJB = 1.3912e-04, Loss_total = 8.6099e-04
Iteration  5000: Loss_V = 2.9565e-05, Loss_V_x = 6.1484e-04, Loss_HJB = 8.5952e-05, Loss_total = 7.3036e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 47.3 sec.

Iteration     0 | Loss_G = 1.4057e-02 | Loss_ODE = 5.8966e-02 | Loss_total = 1.4116e-02
Iteration  1000 | Loss_G = 6.8926e-05 | Loss_ODE = 1.8888e-02 | Loss_total = 8.7814e-05
Iteration  2000 | Loss_G = 3.6211e-05 | Loss_ODE = 1.2667e-02 | Loss_total = 4.8878e-05
Iteration  3000 | Loss_G = 3.0651e-05 | Loss_ODE = 1.7648e-02 | Loss_total = 4.8299e-05
Iteration  4000 | Loss_G = 2.2732e-05 | Loss_ODE = 7.8717e-02 | Loss_total = 1.0145e-04
Iteration  5000 | Loss_G = 2.2825e-05 | Loss_ODE = 2.2588e-02 | Loss_total = 4.5413e-05

k  5 â”‚ L1=5.322e-01 â”‚ L2=1.550e-01 â”‚ Lâˆž=7.653e-02
Precomputing generator trajectories...
Precomputed 7 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (5/8), Ns_sol=3, retraining HJB...
Iteration     0: Loss = 5.3523e-02
Iteration  1000: Loss = 3.7001e-04

Solving BVP batch (3/64 done, idx=8)...Solving BVP batch (10/64 done, idx=16)...
High failure rate (4/8), Ns_sol=14, retraining HJB...
Iteration     0: Loss = 2.7912e-02
Iteration  1000: Loss = 2.4310e-04

Solving BVP batch (14/64 done, idx=24)...
High failure rate (4/8), Ns_sol=18, retraining HJB...
Iteration     0: Loss = 2.9775e-02
Iteration  1000: Loss = 1.8622e-04

Solving BVP batch (18/64 done, idx=32)...Solving BVP batch (24/64 done, idx=40)...
High failure rate (7/8), Ns_sol=25, retraining HJB...
Iteration     0: Loss = 2.7506e-02
Iteration  1000: Loss = 2.8092e-04

Solving BVP batch (25/64 done, idx=48)...
High failure rate (4/8), Ns_sol=29, retraining HJB...
Iteration     0: Loss = 2.1106e-02
Iteration  1000: Loss = 3.1190e-04

Solving BVP batch (29/64 done, idx=56)...
High failure rate (7/8), Ns_sol=30, retraining HJB...
Iteration     0: Loss = 2.2557e-02
Iteration  1000: Loss = 1.9842e-04

Solving BVP batch (30/64 done, idx=64)...
High failure rate (5/8), Ns_sol=33, retraining HJB...
Iteration     0: Loss = 1.9835e-02
Iteration  1000: Loss = 1.6093e-04

Solving BVP batch (33/64 done, idx=72)...Solving BVP batch (38/64 done, idx=80)...Solving BVP batch (44/64 done, idx=88)...Solving BVP batch (48/64 done, idx=96)...Solving BVP batch (55/64 done, idx=104)...Solving BVP batch (60/64 done, idx=112)...Solving BVP batch (63/64 done, idx=116)...Solving BVP batch (63/64 done, idx=117)...
Generated 52541 data from 64 BVP solutions in 989.2 sec
Total failures: 54, HJB retrains: 7


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.3913e-03, Loss_V_x = 1.0470e-02, Loss_HJB = 2.5086e-02, Loss_total = 3.6947e-02
Iteration  1000: Loss_V = 1.5941e-05, Loss_V_x = 6.5090e-04, Loss_HJB = 3.0386e-04, Loss_total = 9.7070e-04
Iteration  2000: Loss_V = 9.8968e-06, Loss_V_x = 4.5015e-04, Loss_HJB = 1.2493e-04, Loss_total = 5.8497e-04
Iteration  3000: Loss_V = 7.8104e-06, Loss_V_x = 3.5915e-04, Loss_HJB = 7.0510e-05, Loss_total = 4.3747e-04
Iteration  4000: Loss_V = 7.1868e-06, Loss_V_x = 3.0713e-04, Loss_HJB = 5.1760e-05, Loss_total = 3.6607e-04
Iteration  5000: Loss_V = 6.4664e-06, Loss_V_x = 2.7117e-04, Loss_HJB = 3.6318e-05, Loss_total = 3.1396e-04

[1;32mExploitability: 0.574523[0m
Step Time: 3954.2 sec


>>> Computing Best Response 6...

Precomputing generator trajectories...
Precomputed 7 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (5/64 done, idx=8)...Solving BVP batch (10/64 done, idx=16)...Solving BVP batch (17/64 done, idx=24)...Solving BVP batch (22/64 done, idx=32)...
High failure rate (5/8), Ns_sol=25, retraining HJB...
Iteration     0: Loss = 6.7229e-02
Iteration  1000: Loss = 2.4189e-04

Solving BVP batch (25/64 done, idx=40)...
High failure rate (5/8), Ns_sol=28, retraining HJB...
Iteration     0: Loss = 2.1284e-02
Iteration  1000: Loss = 2.3087e-04

Solving BVP batch (28/64 done, idx=48)...Solving BVP batch (33/64 done, idx=56)...Solving BVP batch (38/64 done, idx=64)...Solving BVP batch (44/64 done, idx=72)...Solving BVP batch (49/64 done, idx=80)...Solving BVP batch (50/64 done, idx=88)...Solving BVP batch (56/64 done, idx=96)...Solving BVP batch (60/64 done, idx=104)...Solving BVP batch (63/64 done, idx=108)...
Generated 72464 data from 64 BVP solutions in 5692.2 sec
Total failures: 45, HJB retrains: 2


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 7.2921e-03, Loss_V_x = 1.4205e-02, Loss_HJB = 3.0104e-02, Loss_total = 5.1601e-02
Iteration  1000: Loss_V = 6.4954e-05, Loss_V_x = 6.8689e-04, Loss_HJB = 3.3754e-04, Loss_total = 1.0894e-03
Iteration  2000: Loss_V = 3.1728e-05, Loss_V_x = 5.4342e-04, Loss_HJB = 1.6860e-04, Loss_total = 7.4375e-04
Iteration  3000: Loss_V = 2.5382e-05, Loss_V_x = 4.6890e-04, Loss_HJB = 1.1423e-04, Loss_total = 6.0851e-04
Iteration  4000: Loss_V = 2.0034e-05, Loss_V_x = 4.2153e-04, Loss_HJB = 8.0980e-05, Loss_total = 5.2255e-04
Iteration  5000: Loss_V = 2.2839e-05, Loss_V_x = 3.9044e-04, Loss_HJB = 8.7025e-05, Loss_total = 5.0030e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 47.8 sec.

Iteration     0 | Loss_G = 2.2222e-02 | Loss_ODE = 1.7827e+00 | Loss_total = 2.4005e-02
Iteration  1000 | Loss_G = 3.7171e-05 | Loss_ODE = 1.2616e-02 | Loss_total = 4.9788e-05
Iteration  2000 | Loss_G = 2.1631e-05 | Loss_ODE = 1.0297e-02 | Loss_total = 3.1928e-05
Iteration  3000 | Loss_G = 1.5790e-05 | Loss_ODE = 7.5462e-03 | Loss_total = 2.3336e-05
Iteration  4000 | Loss_G = 1.2686e-05 | Loss_ODE = 6.5874e-03 | Loss_total = 1.9274e-05
Iteration  5000 | Loss_G = 2.3806e-05 | Loss_ODE = 2.4112e-02 | Loss_total = 4.7918e-05

k  6 â”‚ L1=6.806e-01 â”‚ L2=1.751e-01 â”‚ Lâˆž=7.050e-02
Precomputing generator trajectories...
Precomputed 8 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (5/8), Ns_sol=3, retraining HJB...
Iteration     0: Loss = 2.2673e-02
Iteration  1000: Loss = 3.4320e-04

Solving BVP batch (3/64 done, idx=8)...Solving BVP batch (8/64 done, idx=16)...Solving BVP batch (13/64 done, idx=24)...
High failure rate (5/8), Ns_sol=16, retraining HJB...
Iteration     0: Loss = 2.2579e-02
Iteration  1000: Loss = 1.1465e-04

Solving BVP batch (16/64 done, idx=32)...
High failure rate (7/8), Ns_sol=17, retraining HJB...
Iteration     0: Loss = 2.1454e-02
Iteration  1000: Loss = 2.3752e-04

Solving BVP batch (17/64 done, idx=40)...Solving BVP batch (24/64 done, idx=48)...Solving BVP batch (29/64 done, idx=56)...
High failure rate (4/8), Ns_sol=33, retraining HJB...
Iteration     0: Loss = 2.8701e-02
Iteration  1000: Loss = 1.7401e-04

Solving BVP batch (33/64 done, idx=64)...
High failure rate (4/8), Ns_sol=37, retraining HJB...
Iteration     0: Loss = 4.6444e-02
Iteration  1000: Loss = 2.2888e-04

Solving BVP batch (37/64 done, idx=72)...Solving BVP batch (42/64 done, idx=80)...Solving BVP batch (48/64 done, idx=88)...Solving BVP batch (52/64 done, idx=96)...Solving BVP batch (56/64 done, idx=104)...Solving BVP batch (59/64 done, idx=112)...Solving BVP batch (63/64 done, idx=117)...
Generated 70085 data from 64 BVP solutions in 1161.0 sec
Total failures: 54, HJB retrains: 5


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.0246e-02, Loss_V_x = 1.6364e-02, Loss_HJB = 1.6961e-02, Loss_total = 4.3571e-02
Iteration  1000: Loss_V = 1.9910e-05, Loss_V_x = 5.0343e-04, Loss_HJB = 3.3704e-04, Loss_total = 8.6038e-04
Iteration  2000: Loss_V = 1.1379e-05, Loss_V_x = 3.8641e-04, Loss_HJB = 1.5956e-04, Loss_total = 5.5735e-04
Iteration  3000: Loss_V = 1.0121e-05, Loss_V_x = 3.2728e-04, Loss_HJB = 1.0329e-04, Loss_total = 4.4069e-04
Iteration  4000: Loss_V = 8.1696e-06, Loss_V_x = 2.8563e-04, Loss_HJB = 7.2165e-05, Loss_total = 3.6596e-04
Iteration  5000: Loss_V = 6.3414e-06, Loss_V_x = 2.5362e-04, Loss_HJB = 4.9136e-05, Loss_total = 3.0910e-04

[1;32mExploitability: 0.400249[0m
Step Time: 7169.3 sec


>>> Computing Best Response 7...

Precomputing generator trajectories...
Precomputed 8 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (6/64 done, idx=8)...
High failure rate (4/8), Ns_sol=10, retraining HJB...
Iteration     0: Loss = 4.9207e-02
Iteration  1000: Loss = 2.4098e-04

Solving BVP batch (10/64 done, idx=16)...Solving BVP batch (17/64 done, idx=24)...Solving BVP batch (22/64 done, idx=32)...Solving BVP batch (27/64 done, idx=40)...Solving BVP batch (32/64 done, idx=48)...Solving BVP batch (37/64 done, idx=56)...Solving BVP batch (45/64 done, idx=64)...Solving BVP batch (51/64 done, idx=72)...Solving BVP batch (56/64 done, idx=80)...Solving BVP batch (63/64 done, idx=88)...
Generated 41079 data from 64 BVP solutions in 3732.2 sec
Total failures: 25, HJB retrains: 1


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 2.3189e-03, Loss_V_x = 5.5269e-03, Loss_HJB = 2.3191e-02, Loss_total = 3.1037e-02
Iteration  1000: Loss_V = 2.4101e-05, Loss_V_x = 5.9267e-04, Loss_HJB = 2.9339e-04, Loss_total = 9.1016e-04
Iteration  2000: Loss_V = 1.9694e-05, Loss_V_x = 4.8468e-04, Loss_HJB = 1.3624e-04, Loss_total = 6.4061e-04
Iteration  3000: Loss_V = 1.4200e-05, Loss_V_x = 4.2483e-04, Loss_HJB = 8.2693e-05, Loss_total = 5.2172e-04
Iteration  4000: Loss_V = 1.3626e-05, Loss_V_x = 3.8343e-04, Loss_HJB = 1.3818e-04, Loss_total = 5.3523e-04
Iteration  5000: Loss_V = 1.6099e-05, Loss_V_x = 4.2826e-04, Loss_HJB = 2.4743e-04, Loss_total = 6.9179e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 44.6 sec.

Iteration     0 | Loss_G = 6.5609e-03 | Loss_ODE = 4.0350e-02 | Loss_total = 6.6013e-03
Iteration  1000 | Loss_G = 2.7569e-05 | Loss_ODE = 1.8954e-02 | Loss_total = 4.6523e-05
Iteration  2000 | Loss_G = 1.6085e-05 | Loss_ODE = 8.9482e-03 | Loss_total = 2.5033e-05
Iteration  3000 | Loss_G = 1.2497e-05 | Loss_ODE = 7.0861e-03 | Loss_total = 1.9583e-05
Iteration  4000 | Loss_G = 1.0461e-05 | Loss_ODE = 5.5568e-03 | Loss_total = 1.6018e-05
Iteration  5000 | Loss_G = 1.0465e-05 | Loss_ODE = 4.8692e-03 | Loss_total = 1.5334e-05

k  7 â”‚ L1=2.853e-01 â”‚ L2=9.196e-02 â”‚ Lâˆž=5.183e-02
Precomputing generator trajectories...
Precomputed 9 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (4/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 4.8609e-02
Iteration  1000: Loss = 1.9592e-04

Solving BVP batch (4/64 done, idx=8)...Solving BVP batch (10/64 done, idx=16)...
High failure rate (5/8), Ns_sol=13, retraining HJB...
Iteration     0: Loss = 1.7502e-02
Iteration  1000: Loss = 2.2764e-04

Solving BVP batch (13/64 done, idx=24)...
High failure rate (5/8), Ns_sol=16, retraining HJB...
Iteration     0: Loss = 2.7502e-02
Iteration  1000: Loss = 2.6500e-04

Solving BVP batch (16/64 done, idx=32)...Solving BVP batch (21/64 done, idx=40)...
High failure rate (6/8), Ns_sol=23, retraining HJB...
Iteration     0: Loss = 1.4361e-02
Iteration  1000: Loss = 2.0543e-04

Solving BVP batch (23/64 done, idx=48)...Solving BVP batch (30/64 done, idx=56)...Solving BVP batch (36/64 done, idx=64)...
High failure rate (4/8), Ns_sol=40, retraining HJB...
Iteration     0: Loss = 2.1936e-02
Iteration  1000: Loss = 1.6602e-04

Solving BVP batch (40/64 done, idx=72)...Solving BVP batch (45/64 done, idx=80)...Solving BVP batch (51/64 done, idx=88)...Solving BVP batch (56/64 done, idx=96)...
Generated 55986 data from 64 BVP solutions in 844.7 sec
Total failures: 40, HJB retrains: 5


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.0863e-03, Loss_V_x = 5.5980e-03, Loss_HJB = 2.6677e-02, Loss_total = 3.3362e-02
Iteration  1000: Loss_V = 3.1838e-05, Loss_V_x = 5.7500e-04, Loss_HJB = 4.6944e-04, Loss_total = 1.0763e-03
Iteration  2000: Loss_V = 2.2256e-05, Loss_V_x = 4.2048e-04, Loss_HJB = 2.3791e-04, Loss_total = 6.8065e-04
Iteration  3000: Loss_V = 1.7968e-05, Loss_V_x = 3.5401e-04, Loss_HJB = 1.4889e-04, Loss_total = 5.2086e-04
Iteration  4000: Loss_V = 1.5701e-05, Loss_V_x = 3.1439e-04, Loss_HJB = 1.0295e-04, Loss_total = 4.3304e-04
Iteration  5000: Loss_V = 1.4031e-05, Loss_V_x = 2.8727e-04, Loss_HJB = 7.7471e-05, Loss_total = 3.7877e-04

[1;32mExploitability: 0.314347[0m
Step Time: 4888.9 sec


>>> Computing Best Response 8...

Precomputing generator trajectories...
Precomputed 9 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (6/64 done, idx=8)...
High failure rate (4/8), Ns_sol=10, retraining HJB...
Iteration     0: Loss = 2.6239e-02
Iteration  1000: Loss = 1.9916e-04

Solving BVP batch (10/64 done, idx=16)...Solving BVP batch (16/64 done, idx=24)...Solving BVP batch (21/64 done, idx=32)...
High failure rate (5/8), Ns_sol=24, retraining HJB...
Iteration     0: Loss = 2.8473e-02
Iteration  1000: Loss = 2.9240e-04

Solving BVP batch (24/64 done, idx=40)...Solving BVP batch (29/64 done, idx=48)...Solving BVP batch (35/64 done, idx=56)...Solving BVP batch (43/64 done, idx=64)...Solving BVP batch (48/64 done, idx=72)...Solving BVP batch (51/64 done, idx=80)...Solving BVP batch (54/64 done, idx=88)...Solving BVP batch (59/64 done, idx=96)...Solving BVP batch (62/64 done, idx=101)...
Generated 52467 data from 64 BVP solutions in 6072.8 sec
Total failures: 39, HJB retrains: 2


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 5.6142e-03, Loss_V_x = 1.1268e-02, Loss_HJB = 1.8739e-02, Loss_total = 3.5621e-02
Iteration  1000: Loss_V = 5.6777e-05, Loss_V_x = 4.9230e-04, Loss_HJB = 3.1443e-04, Loss_total = 8.6351e-04
Iteration  2000: Loss_V = 3.2052e-05, Loss_V_x = 4.2069e-04, Loss_HJB = 1.4275e-04, Loss_total = 5.9549e-04
Iteration  3000: Loss_V = 2.5058e-05, Loss_V_x = 3.7446e-04, Loss_HJB = 8.6562e-05, Loss_total = 4.8608e-04
Iteration  4000: Loss_V = 2.1713e-05, Loss_V_x = 3.3945e-04, Loss_HJB = 6.2668e-05, Loss_total = 4.2384e-04
Iteration  5000: Loss_V = 1.9118e-05, Loss_V_x = 3.1155e-04, Loss_HJB = 4.9016e-05, Loss_total = 3.7968e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 45.3 sec.

Iteration     0 | Loss_G = 5.3104e-03 | Loss_ODE = 6.0372e-02 | Loss_total = 5.3708e-03
Iteration  1000 | Loss_G = 1.9698e-05 | Loss_ODE = 8.3380e-03 | Loss_total = 2.8036e-05
Iteration  2000 | Loss_G = 1.8135e-05 | Loss_ODE = 6.4791e-03 | Loss_total = 2.4614e-05
Iteration  3000 | Loss_G = 9.3747e-06 | Loss_ODE = 4.9130e-03 | Loss_total = 1.4288e-05
Iteration  4000 | Loss_G = 7.8778e-06 | Loss_ODE = 3.9605e-03 | Loss_total = 1.1838e-05
Iteration  5000 | Loss_G = 6.8743e-06 | Loss_ODE = 3.6998e-03 | Loss_total = 1.0574e-05

k  8 â”‚ L1=4.733e-01 â”‚ L2=1.238e-01 â”‚ Lâˆž=5.256e-02
Precomputing generator trajectories...
Precomputed 10 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (5/8), Ns_sol=3, retraining HJB...
Iteration     0: Loss = 1.9514e-02
Iteration  1000: Loss = 2.1987e-04

Solving BVP batch (3/64 done, idx=8)...Solving BVP batch (9/64 done, idx=16)...
High failure rate (5/8), Ns_sol=12, retraining HJB...
Iteration     0: Loss = 3.9267e-02
Iteration  1000: Loss = 3.5684e-04

Solving BVP batch (12/64 done, idx=24)...
High failure rate (7/8), Ns_sol=13, retraining HJB...
Iteration     0: Loss = 1.6817e-02
Iteration  1000: Loss = 2.1244e-04

Solving BVP batch (13/64 done, idx=32)...Solving BVP batch (19/64 done, idx=40)...Solving BVP batch (24/64 done, idx=48)...
High failure rate (6/8), Ns_sol=26, retraining HJB...
Iteration     0: Loss = 2.0687e-02
Iteration  1000: Loss = 2.6255e-04

Solving BVP batch (26/64 done, idx=56)...
High failure rate (6/8), Ns_sol=28, retraining HJB...
Iteration     0: Loss = 2.4796e-02
Iteration  1000: Loss = 2.0119e-04

Solving BVP batch (28/64 done, idx=64)...
High failure rate (5/8), Ns_sol=31, retraining HJB...
Iteration     0: Loss = 3.8852e-02
Iteration  1000: Loss = 2.2360e-04

Solving BVP batch (31/64 done, idx=72)...Solving BVP batch (37/64 done, idx=80)...
High failure rate (8/8), Ns_sol=37, retraining HJB...
Iteration     0: Loss = 1.9903e-02
Iteration  1000: Loss = 1.1244e-04

Solving BVP batch (37/64 done, idx=88)...Solving BVP batch (43/64 done, idx=96)...Solving BVP batch (50/64 done, idx=104)...Solving BVP batch (54/64 done, idx=112)...Solving BVP batch (58/64 done, idx=120)...Solving BVP batch (62/64 done, idx=126)...Solving BVP batch (63/64 done, idx=128)...
Generated 82774 data from 64 BVP solutions in 1294.9 sec
Total failures: 65, HJB retrains: 7


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 8.9974e-03, Loss_V_x = 1.4159e-02, Loss_HJB = 1.3356e-02, Loss_total = 3.6513e-02
Iteration  1000: Loss_V = 3.9230e-05, Loss_V_x = 5.9840e-04, Loss_HJB = 4.1242e-04, Loss_total = 1.0500e-03
Iteration  2000: Loss_V = 2.3958e-05, Loss_V_x = 4.4469e-04, Loss_HJB = 1.5642e-04, Loss_total = 6.2507e-04
Iteration  3000: Loss_V = 1.8557e-05, Loss_V_x = 3.8082e-04, Loss_HJB = 8.0959e-05, Loss_total = 4.8033e-04
Iteration  4000: Loss_V = 3.0299e-05, Loss_V_x = 3.4374e-04, Loss_HJB = 1.5253e-04, Loss_total = 5.2657e-04
Iteration  5000: Loss_V = 5.1251e-05, Loss_V_x = 4.8150e-04, Loss_HJB = 4.9705e-04, Loss_total = 1.0298e-03

[1;32mExploitability: 0.164537[0m
Step Time: 7713.8 sec


>>> Computing Best Response 9...

Precomputing generator trajectories...
Precomputed 10 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (8/64 done, idx=8)...Solving BVP batch (14/64 done, idx=16)...Solving BVP batch (22/64 done, idx=24)...Solving BVP batch (27/64 done, idx=32)...
High failure rate (4/8), Ns_sol=31, retraining HJB...
Iteration     0: Loss = 1.2982e-02
Iteration  1000: Loss = 1.0723e-04

Solving BVP batch (31/64 done, idx=40)...Solving BVP batch (38/64 done, idx=48)...
High failure rate (4/8), Ns_sol=42, retraining HJB...
Iteration     0: Loss = 1.3475e-02
Iteration  1000: Loss = 1.3947e-04

Solving BVP batch (42/64 done, idx=56)...Solving BVP batch (49/64 done, idx=64)...Solving BVP batch (54/64 done, idx=72)...Solving BVP batch (57/64 done, idx=80)...Solving BVP batch (61/64 done, idx=87)...Solving BVP batch (63/64 done, idx=90)...Solving BVP batch (63/64 done, idx=91)...Solving BVP batch (63/64 done, idx=92)...
Generated 41277 data from 64 BVP solutions in 5363.4 sec
Total failures: 29, HJB retrains: 2


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 1.4619e-03, Loss_V_x = 6.9132e-03, Loss_HJB = 9.9289e-03, Loss_total = 1.8304e-02
Iteration  1000: Loss_V = 2.2111e-05, Loss_V_x = 5.2765e-04, Loss_HJB = 1.8853e-04, Loss_total = 7.3829e-04
Iteration  2000: Loss_V = 1.7832e-05, Loss_V_x = 4.5028e-04, Loss_HJB = 9.8723e-05, Loss_total = 5.6683e-04
Iteration  3000: Loss_V = 1.5319e-05, Loss_V_x = 4.0389e-04, Loss_HJB = 6.7575e-05, Loss_total = 4.8678e-04
Iteration  4000: Loss_V = 1.3756e-05, Loss_V_x = 3.6871e-04, Loss_HJB = 5.0655e-05, Loss_total = 4.3313e-04
Iteration  5000: Loss_V = 1.2680e-05, Loss_V_x = 3.4048e-04, Loss_HJB = 3.9455e-05, Loss_total = 3.9261e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 52.3 sec.

Iteration     0 | Loss_G = 3.1415e-03 | Loss_ODE = 2.5487e-02 | Loss_total = 3.1669e-03
Iteration  1000 | Loss_G = 1.8692e-05 | Loss_ODE = 7.6643e-03 | Loss_total = 2.6357e-05
Iteration  2000 | Loss_G = 1.1786e-05 | Loss_ODE = 4.8192e-03 | Loss_total = 1.6605e-05
Iteration  3000 | Loss_G = 1.1071e-05 | Loss_ODE = 4.0035e-03 | Loss_total = 1.5074e-05
Iteration  4000 | Loss_G = 8.1192e-06 | Loss_ODE = 3.7880e-03 | Loss_total = 1.1907e-05
Iteration  5000 | Loss_G = 8.9096e-06 | Loss_ODE = 3.4136e-03 | Loss_total = 1.2323e-05

k  9 â”‚ L1=1.966e-01 â”‚ L2=6.627e-02 â”‚ Lâˆž=3.896e-02
Precomputing generator trajectories...
Precomputed 11 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (4/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 1.6231e-02
Iteration  1000: Loss = 1.0941e-04

Solving BVP batch (4/64 done, idx=8)...Solving BVP batch (10/64 done, idx=16)...
High failure rate (5/8), Ns_sol=13, retraining HJB...
Iteration     0: Loss = 1.5173e-02
Iteration  1000: Loss = 9.1607e-05

Solving BVP batch (13/64 done, idx=24)...
High failure rate (5/8), Ns_sol=16, retraining HJB...
Iteration     0: Loss = 2.1362e-02
Iteration  1000: Loss = 1.6153e-04

Solving BVP batch (16/64 done, idx=32)...
High failure rate (5/8), Ns_sol=19, retraining HJB...
Iteration     0: Loss = 2.5512e-02
Iteration  1000: Loss = 2.0161e-04

Solving BVP batch (19/64 done, idx=40)...Solving BVP batch (26/64 done, idx=48)...
High failure rate (6/8), Ns_sol=28, retraining HJB...
Iteration     0: Loss = 2.3456e-02
Iteration  1000: Loss = 1.1164e-04

Solving BVP batch (28/64 done, idx=56)...
High failure rate (5/8), Ns_sol=31, retraining HJB...
Iteration     0: Loss = 2.1646e-02
Iteration  1000: Loss = 6.3809e-05

Solving BVP batch (31/64 done, idx=64)...Solving BVP batch (36/64 done, idx=72)...Solving BVP batch (42/64 done, idx=80)...Solving BVP batch (47/64 done, idx=88)...Solving BVP batch (52/64 done, idx=96)...Solving BVP batch (56/64 done, idx=104)...Solving BVP batch (59/64 done, idx=112)...Solving BVP batch (62/64 done, idx=117)...Solving BVP batch (63/64 done, idx=119)...
Generated 67717 data from 64 BVP solutions in 1202.8 sec
Total failures: 56, HJB retrains: 6


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.0412e-03, Loss_V_x = 7.2597e-03, Loss_HJB = 1.2170e-02, Loss_total = 2.0471e-02
Iteration  1000: Loss_V = 2.1406e-05, Loss_V_x = 4.6191e-04, Loss_HJB = 1.5768e-04, Loss_total = 6.4100e-04
Iteration  2000: Loss_V = 1.5115e-05, Loss_V_x = 3.7548e-04, Loss_HJB = 8.4511e-05, Loss_total = 4.7511e-04
Iteration  3000: Loss_V = 1.2023e-05, Loss_V_x = 3.2988e-04, Loss_HJB = 5.7268e-05, Loss_total = 3.9917e-04
Iteration  4000: Loss_V = 1.0365e-05, Loss_V_x = 2.9902e-04, Loss_HJB = 4.3056e-05, Loss_total = 3.5244e-04
Iteration  5000: Loss_V = 1.0241e-05, Loss_V_x = 2.7440e-04, Loss_HJB = 6.1230e-05, Loss_total = 3.4588e-04

[1;32mExploitability: 0.185393[0m
Step Time: 6927.1 sec


>>> Computing Best Response 10...

Precomputing generator trajectories...
Precomputed 11 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (4/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 4.1585e-02
Iteration  1000: Loss = 1.6765e-04

Solving BVP batch (4/64 done, idx=8)...
High failure rate (5/8), Ns_sol=7, retraining HJB...
Iteration     0: Loss = 1.2031e-02
Iteration  1000: Loss = 1.3036e-04

Solving BVP batch (7/64 done, idx=16)...
High failure rate (4/8), Ns_sol=11, retraining HJB...
Iteration     0: Loss = 8.6968e-03
Iteration  1000: Loss = 8.4910e-05

Solving BVP batch (11/64 done, idx=24)...Solving BVP batch (16/64 done, idx=32)...Solving BVP batch (21/64 done, idx=40)...Solving BVP batch (28/64 done, idx=48)...Solving BVP batch (35/64 done, idx=56)...
High failure rate (4/8), Ns_sol=39, retraining HJB...
Iteration     0: Loss = 8.9287e-03
Iteration  1000: Loss = 9.8345e-05

Solving BVP batch (39/64 done, idx=64)...
High failure rate (4/8), Ns_sol=43, retraining HJB...
Iteration     0: Loss = 2.0049e-02
Iteration  1000: Loss = 1.1750e-04

Solving BVP batch (43/64 done, idx=72)...Solving BVP batch (47/64 done, idx=80)...Solving BVP batch (52/64 done, idx=88)...Solving BVP batch (55/64 done, idx=96)...Solving BVP batch (61/64 done, idx=104)...Solving BVP batch (63/64 done, idx=107)...
Generated 48863 data from 64 BVP solutions in 7754.3 sec
Total failures: 44, HJB retrains: 5


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 2.2433e-03, Loss_V_x = 6.9844e-03, Loss_HJB = 2.7881e-02, Loss_total = 3.7109e-02
Iteration  1000: Loss_V = 2.4428e-05, Loss_V_x = 4.8306e-04, Loss_HJB = 2.8213e-04, Loss_total = 7.8962e-04
Iteration  2000: Loss_V = 1.6859e-05, Loss_V_x = 3.7828e-04, Loss_HJB = 1.3149e-04, Loss_total = 5.2663e-04
Iteration  3000: Loss_V = 1.4965e-05, Loss_V_x = 3.3639e-04, Loss_HJB = 7.8154e-05, Loss_total = 4.2951e-04
Iteration  4000: Loss_V = 1.3998e-05, Loss_V_x = 3.0831e-04, Loss_HJB = 5.5628e-05, Loss_total = 3.7793e-04
Iteration  5000: Loss_V = 1.4835e-05, Loss_V_x = 2.8726e-04, Loss_HJB = 5.6670e-05, Loss_total = 3.5876e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 45.3 sec.

Iteration     0 | Loss_G = 1.0866e-03 | Loss_ODE = 7.2139e-02 | Loss_total = 1.1587e-03
Iteration  1000 | Loss_G = 1.2620e-05 | Loss_ODE = 3.8536e-03 | Loss_total = 1.6473e-05
Iteration  2000 | Loss_G = 8.3998e-06 | Loss_ODE = 2.9356e-03 | Loss_total = 1.1335e-05
Iteration  3000 | Loss_G = 1.0151e-05 | Loss_ODE = 2.6783e-03 | Loss_total = 1.2829e-05
Iteration  4000 | Loss_G = 5.8931e-06 | Loss_ODE = 3.3133e-03 | Loss_total = 9.2065e-06
Iteration  5000 | Loss_G = 5.3224e-06 | Loss_ODE = 2.4869e-03 | Loss_total = 7.8093e-06

k 10 â”‚ L1=1.856e-01 â”‚ L2=6.049e-02 â”‚ Lâˆž=3.572e-02
Precomputing generator trajectories...
Precomputed 12 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (15/64 done, idx=16)...Solving BVP batch (23/64 done, idx=24)...Solving BVP batch (29/64 done, idx=32)...Solving BVP batch (37/64 done, idx=40)...Solving BVP batch (44/64 done, idx=48)...Solving BVP batch (49/64 done, idx=56)...Solving BVP batch (56/64 done, idx=64)...Solving BVP batch (63/64 done, idx=72)...
Generated 29236 data from 64 BVP solutions in 288.5 sec
Total failures: 9, HJB retrains: 0


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 4.9682e-05, Loss_V_x = 4.8337e-04, Loss_HJB = 3.6505e-02, Loss_total = 3.7038e-02
Iteration  1000: Loss_V = 1.3585e-05, Loss_V_x = 3.7091e-04, Loss_HJB = 1.4223e-04, Loss_total = 5.2673e-04
Iteration  2000: Loss_V = 1.0594e-05, Loss_V_x = 3.1531e-04, Loss_HJB = 6.7481e-05, Loss_total = 3.9339e-04
Iteration  3000: Loss_V = 3.3521e-05, Loss_V_x = 2.8249e-04, Loss_HJB = 3.4385e-04, Loss_total = 6.5987e-04
Iteration  4000: Loss_V = 4.3097e-05, Loss_V_x = 3.2981e-04, Loss_HJB = 2.1194e-04, Loss_total = 5.8484e-04
Iteration  5000: Loss_V = 2.6488e-05, Loss_V_x = 3.3869e-04, Loss_HJB = 2.2115e-04, Loss_total = 5.8633e-04

[1;32mExploitability: 0.079067[0m
Step Time: 8400.1 sec


>>> Computing Best Response 11...

Precomputing generator trajectories...
Precomputed 12 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (13/64 done, idx=16)...Solving BVP batch (20/64 done, idx=24)...Solving BVP batch (25/64 done, idx=32)...Solving BVP batch (31/64 done, idx=40)...Solving BVP batch (37/64 done, idx=48)...Solving BVP batch (43/64 done, idx=56)...Solving BVP batch (51/64 done, idx=64)...Solving BVP batch (58/64 done, idx=72)...Solving BVP batch (63/64 done, idx=78)...Solving BVP batch (63/64 done, idx=79)...
Generated 27598 data from 64 BVP solutions in 3567.9 sec
Total failures: 16, HJB retrains: 0


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 3.7898e-05, Loss_V_x = 6.7604e-04, Loss_HJB = 1.4839e-02, Loss_total = 1.5553e-02
Iteration  1000: Loss_V = 3.8975e-05, Loss_V_x = 4.6029e-04, Loss_HJB = 2.2059e-04, Loss_total = 7.1985e-04
Iteration  2000: Loss_V = 3.2119e-05, Loss_V_x = 3.8941e-04, Loss_HJB = 1.3015e-04, Loss_total = 5.5168e-04
Iteration  3000: Loss_V = 2.4570e-05, Loss_V_x = 3.4949e-04, Loss_HJB = 8.7270e-05, Loss_total = 4.6133e-04
Iteration  4000: Loss_V = 1.9261e-05, Loss_V_x = 3.2280e-04, Loss_HJB = 7.4378e-05, Loss_total = 4.1644e-04
Iteration  5000: Loss_V = 1.8569e-05, Loss_V_x = 3.0290e-04, Loss_HJB = 5.1855e-05, Loss_total = 3.7333e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 44.4 sec.

Iteration     0 | Loss_G = 9.6168e-04 | Loss_ODE = 2.5861e-02 | Loss_total = 9.8754e-04
Iteration  1000 | Loss_G = 1.0616e-05 | Loss_ODE = 4.7415e-03 | Loss_total = 1.5357e-05
Iteration  2000 | Loss_G = 7.1264e-06 | Loss_ODE = 4.0080e-03 | Loss_total = 1.1134e-05
Iteration  3000 | Loss_G = 5.6112e-06 | Loss_ODE = 2.9015e-03 | Loss_total = 8.5127e-06
Iteration  4000 | Loss_G = 4.8062e-06 | Loss_ODE = 2.6532e-03 | Loss_total = 7.4594e-06
Iteration  5000 | Loss_G = 4.8646e-06 | Loss_ODE = 2.2139e-03 | Loss_total = 7.0785e-06

k 11 â”‚ L1=2.620e-01 â”‚ L2=7.624e-02 â”‚ Lâˆž=3.656e-02
Precomputing generator trajectories...
Precomputed 13 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (6/64 done, idx=8)...Solving BVP batch (13/64 done, idx=16)...Solving BVP batch (21/64 done, idx=24)...Solving BVP batch (26/64 done, idx=32)...Solving BVP batch (32/64 done, idx=40)...Solving BVP batch (39/64 done, idx=48)...Solving BVP batch (44/64 done, idx=56)...Solving BVP batch (52/64 done, idx=64)...Solving BVP batch (57/64 done, idx=72)...Solving BVP batch (61/64 done, idx=79)...Solving BVP batch (63/64 done, idx=82)...
Generated 25145 data from 64 BVP solutions in 396.1 sec
Total failures: 19, HJB retrains: 0


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.1119e-03, Loss_V_x = 1.0772e-03, Loss_HJB = 1.3322e-02, Loss_total = 1.5511e-02
Iteration  1000: Loss_V = 4.2800e-05, Loss_V_x = 4.8757e-04, Loss_HJB = 2.3059e-04, Loss_total = 7.6096e-04
Iteration  2000: Loss_V = 3.6720e-05, Loss_V_x = 4.2926e-04, Loss_HJB = 1.1082e-04, Loss_total = 5.7680e-04
Iteration  3000: Loss_V = 3.4024e-05, Loss_V_x = 3.9172e-04, Loss_HJB = 6.8062e-05, Loss_total = 4.9381e-04
Iteration  4000: Loss_V = 3.2255e-05, Loss_V_x = 3.6559e-04, Loss_HJB = 4.7988e-05, Loss_total = 4.4583e-04
Iteration  5000: Loss_V = 3.3717e-05, Loss_V_x = 3.4562e-04, Loss_HJB = 5.6334e-05, Loss_total = 4.3567e-04

[1;32mExploitability: 0.077753[0m
Step Time: 4327.5 sec


>>> Computing Best Response 12...

Precomputing generator trajectories...
Precomputed 13 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (14/64 done, idx=16)...Solving BVP batch (19/64 done, idx=24)...Solving BVP batch (26/64 done, idx=32)...
High failure rate (4/8), Ns_sol=30, retraining HJB...
Iteration     0: Loss = 1.9285e-02
Iteration  1000: Loss = 1.7033e-04

Solving BVP batch (30/64 done, idx=40)...Solving BVP batch (36/64 done, idx=48)...
High failure rate (4/8), Ns_sol=40, retraining HJB...
Iteration     0: Loss = 1.9301e-02
Iteration  1000: Loss = 1.5975e-04

Solving BVP batch (40/64 done, idx=56)...
High failure rate (4/8), Ns_sol=44, retraining HJB...
Iteration     0: Loss = 1.7232e-02
Iteration  1000: Loss = 7.5638e-05

Solving BVP batch (44/64 done, idx=64)...Solving BVP batch (49/64 done, idx=72)...Solving BVP batch (53/64 done, idx=80)...Solving BVP batch (58/64 done, idx=88)...Solving BVP batch (61/64 done, idx=94)...
Generated 26354 data from 64 BVP solutions in 6683.2 sec
Total failures: 33, HJB retrains: 3


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 1.3743e-03, Loss_V_x = 5.8978e-03, Loss_HJB = 1.2149e-02, Loss_total = 1.9421e-02
Iteration  1000: Loss_V = 2.1557e-05, Loss_V_x = 4.0465e-04, Loss_HJB = 1.5661e-04, Loss_total = 5.8282e-04
Iteration  2000: Loss_V = 1.7765e-05, Loss_V_x = 3.2790e-04, Loss_HJB = 7.6980e-05, Loss_total = 4.2264e-04
Iteration  3000: Loss_V = 1.8010e-05, Loss_V_x = 2.8684e-04, Loss_HJB = 1.3063e-04, Loss_total = 4.3548e-04
Iteration  4000: Loss_V = 2.5177e-05, Loss_V_x = 3.5794e-04, Loss_HJB = 2.1478e-04, Loss_total = 5.9789e-04
Iteration  5000: Loss_V = 1.9195e-05, Loss_V_x = 2.9588e-04, Loss_HJB = 1.0170e-04, Loss_total = 4.1677e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 47.8 sec.

Iteration     0 | Loss_G = 1.6792e-03 | Loss_ODE = 3.8902e-02 | Loss_total = 1.7181e-03
Iteration  1000 | Loss_G = 1.1509e-05 | Loss_ODE = 6.9555e-03 | Loss_total = 1.8464e-05
Iteration  2000 | Loss_G = 7.7719e-06 | Loss_ODE = 4.7638e-03 | Loss_total = 1.2536e-05
Iteration  3000 | Loss_G = 6.2157e-06 | Loss_ODE = 2.9948e-03 | Loss_total = 9.2104e-06
Iteration  4000 | Loss_G = 1.2558e-05 | Loss_ODE = 3.4414e-03 | Loss_total = 1.5999e-05
Iteration  5000 | Loss_G = 4.6527e-06 | Loss_ODE = 2.5828e-03 | Loss_total = 7.2355e-06

k 12 â”‚ L1=1.368e-01 â”‚ L2=4.754e-02 â”‚ Lâˆž=2.883e-02
Precomputing generator trajectories...
Precomputed 14 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (13/64 done, idx=16)...
High failure rate (4/8), Ns_sol=17, retraining HJB...
Iteration     0: Loss = 1.6448e-02
Iteration  1000: Loss = 5.9228e-05

Solving BVP batch (17/64 done, idx=24)...Solving BVP batch (23/64 done, idx=32)...Solving BVP batch (28/64 done, idx=40)...Solving BVP batch (33/64 done, idx=48)...
High failure rate (5/8), Ns_sol=36, retraining HJB...
Iteration     0: Loss = 1.3235e-02
Iteration  1000: Loss = 7.4349e-05

Solving BVP batch (36/64 done, idx=56)...
High failure rate (4/8), Ns_sol=40, retraining HJB...
Iteration     0: Loss = 1.1240e-02
Iteration  1000: Loss = 6.5383e-05

Solving BVP batch (40/64 done, idx=64)...
High failure rate (4/8), Ns_sol=44, retraining HJB...
Iteration     0: Loss = 4.1265e-02
Iteration  1000: Loss = 1.0162e-04

Solving BVP batch (44/64 done, idx=72)...Solving BVP batch (49/64 done, idx=80)...Solving BVP batch (55/64 done, idx=88)...Solving BVP batch (60/64 done, idx=96)...
Generated 46961 data from 64 BVP solutions in 811.6 sec
Total failures: 36, HJB retrains: 4


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 1.8079e-03, Loss_V_x = 6.3204e-03, Loss_HJB = 3.6648e-02, Loss_total = 4.4777e-02
Iteration  1000: Loss_V = 2.0181e-05, Loss_V_x = 4.3092e-04, Loss_HJB = 1.8056e-04, Loss_total = 6.3166e-04
Iteration  2000: Loss_V = 1.5866e-05, Loss_V_x = 3.5342e-04, Loss_HJB = 8.9838e-05, Loss_total = 4.5912e-04
Iteration  3000: Loss_V = 1.1905e-05, Loss_V_x = 3.1182e-04, Loss_HJB = 1.0291e-04, Loss_total = 4.2664e-04
Iteration  4000: Loss_V = 1.2069e-05, Loss_V_x = 2.8250e-04, Loss_HJB = 4.2078e-05, Loss_total = 3.3665e-04
Iteration  5000: Loss_V = 1.0667e-05, Loss_V_x = 2.5836e-04, Loss_HJB = 3.1815e-05, Loss_total = 3.0084e-04

[1;32mExploitability: 0.135657[0m
Step Time: 7888.2 sec


>>> Computing Best Response 13...

Precomputing generator trajectories...
Precomputed 14 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (12/64 done, idx=16)...Solving BVP batch (17/64 done, idx=24)...Solving BVP batch (22/64 done, idx=32)...Solving BVP batch (28/64 done, idx=40)...
High failure rate (4/8), Ns_sol=32, retraining HJB...
Iteration     0: Loss = 1.0893e-02
Iteration  1000: Loss = 8.3164e-05

Solving BVP batch (32/64 done, idx=48)...Solving BVP batch (37/64 done, idx=56)...
High failure rate (5/8), Ns_sol=40, retraining HJB...
Iteration     0: Loss = 2.7639e-02
Iteration  1000: Loss = 1.2585e-04

Solving BVP batch (40/64 done, idx=64)...Solving BVP batch (45/64 done, idx=72)...Solving BVP batch (48/64 done, idx=80)...Solving BVP batch (54/64 done, idx=88)...Solving BVP batch (59/64 done, idx=96)...Solving BVP batch (63/64 done, idx=101)...
Generated 35948 data from 64 BVP solutions in 7565.4 sec
Total failures: 38, HJB retrains: 2


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 1.4002e-03, Loss_V_x = 5.2776e-03, Loss_HJB = 2.8685e-02, Loss_total = 3.5363e-02
Iteration  1000: Loss_V = 2.6109e-05, Loss_V_x = 3.2449e-04, Loss_HJB = 2.5834e-04, Loss_total = 6.0894e-04
Iteration  2000: Loss_V = 2.1257e-05, Loss_V_x = 2.5727e-04, Loss_HJB = 8.6298e-05, Loss_total = 3.6483e-04
Iteration  3000: Loss_V = 1.8609e-05, Loss_V_x = 2.2913e-04, Loss_HJB = 4.4904e-05, Loss_total = 2.9265e-04
Iteration  4000: Loss_V = 1.6427e-05, Loss_V_x = 2.1119e-04, Loss_HJB = 2.9850e-05, Loss_total = 2.5747e-04
Iteration  5000: Loss_V = 1.5123e-05, Loss_V_x = 1.9816e-04, Loss_HJB = 2.2530e-05, Loss_total = 2.3581e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 45.8 sec.

Iteration     0 | Loss_G = 1.7060e-03 | Loss_ODE = 2.0071e-02 | Loss_total = 1.7260e-03
Iteration  1000 | Loss_G = 1.2110e-05 | Loss_ODE = 4.5080e-03 | Loss_total = 1.6618e-05
Iteration  2000 | Loss_G = 7.0743e-06 | Loss_ODE = 3.5551e-03 | Loss_total = 1.0629e-05
Iteration  3000 | Loss_G = 5.6126e-06 | Loss_ODE = 3.1272e-03 | Loss_total = 8.7398e-06
Iteration  4000 | Loss_G = 4.6196e-06 | Loss_ODE = 2.5289e-03 | Loss_total = 7.1485e-06
Iteration  5000 | Loss_G = 5.7814e-06 | Loss_ODE = 2.5050e-03 | Loss_total = 8.2864e-06

k 13 â”‚ L1=1.960e-01 â”‚ L2=5.648e-02 â”‚ Lâˆž=2.795e-02
Precomputing generator trajectories...
Precomputed 15 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (5/64 done, idx=8)...Solving BVP batch (11/64 done, idx=16)...Solving BVP batch (17/64 done, idx=24)...Solving BVP batch (24/64 done, idx=32)...Solving BVP batch (30/64 done, idx=40)...
High failure rate (4/8), Ns_sol=34, retraining HJB...
Iteration     0: Loss = 2.0245e-02
Iteration  1000: Loss = 9.0489e-05

Solving BVP batch (34/64 done, idx=48)...Solving BVP batch (40/64 done, idx=56)...Solving BVP batch (47/64 done, idx=64)...Solving BVP batch (52/64 done, idx=72)...Solving BVP batch (56/64 done, idx=80)...Solving BVP batch (63/64 done, idx=88)...
Generated 22664 data from 64 BVP solutions in 500.9 sec
Total failures: 25, HJB retrains: 1


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 4.7586e-04, Loss_V_x = 2.1003e-03, Loss_HJB = 2.0182e-02, Loss_total = 2.2758e-02
Iteration  1000: Loss_V = 2.3870e-05, Loss_V_x = 3.1917e-04, Loss_HJB = 1.9939e-04, Loss_total = 5.4243e-04
Iteration  2000: Loss_V = 1.6525e-05, Loss_V_x = 2.6524e-04, Loss_HJB = 8.8873e-05, Loss_total = 3.7063e-04
Iteration  3000: Loss_V = 2.7073e-05, Loss_V_x = 2.3678e-04, Loss_HJB = 1.9312e-04, Loss_total = 4.5697e-04
Iteration  4000: Loss_V = 3.2430e-05, Loss_V_x = 2.6014e-04, Loss_HJB = 1.5807e-04, Loss_total = 4.5064e-04
Iteration  5000: Loss_V = 1.8166e-05, Loss_V_x = 2.5442e-04, Loss_HJB = 2.2825e-04, Loss_total = 5.0084e-04

[1;32mExploitability: 0.154660[0m
Step Time: 8469.5 sec


>>> Computing Best Response 14...

Precomputing generator trajectories...
Precomputed 15 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (8/64 done, idx=8)...Solving BVP batch (16/64 done, idx=16)...Solving BVP batch (22/64 done, idx=24)...Solving BVP batch (28/64 done, idx=32)...Solving BVP batch (34/64 done, idx=40)...Solving BVP batch (41/64 done, idx=48)...Solving BVP batch (47/64 done, idx=56)...Solving BVP batch (53/64 done, idx=64)...Solving BVP batch (59/64 done, idx=72)...Solving BVP batch (63/64 done, idx=77)...
Generated 26421 data from 64 BVP solutions in 3939.8 sec
Total failures: 14, HJB retrains: 0


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 4.1826e-04, Loss_V_x = 5.9858e-04, Loss_HJB = 1.1910e-02, Loss_total = 1.2927e-02
Iteration  1000: Loss_V = 1.3331e-05, Loss_V_x = 2.7160e-04, Loss_HJB = 1.7123e-04, Loss_total = 4.5616e-04
Iteration  2000: Loss_V = 9.9894e-06, Loss_V_x = 2.1890e-04, Loss_HJB = 6.5124e-05, Loss_total = 2.9401e-04
Iteration  3000: Loss_V = 8.5176e-06, Loss_V_x = 1.9384e-04, Loss_HJB = 3.6101e-05, Loss_total = 2.3846e-04
Iteration  4000: Loss_V = 1.3389e-05, Loss_V_x = 1.7794e-04, Loss_HJB = 7.7813e-05, Loss_total = 2.6914e-04
Iteration  5000: Loss_V = 8.3795e-06, Loss_V_x = 2.2325e-04, Loss_HJB = 1.1541e-04, Loss_total = 3.4704e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 45.7 sec.

Iteration     0 | Loss_G = 2.1186e-03 | Loss_ODE = 2.0379e-02 | Loss_total = 2.1390e-03
Iteration  1000 | Loss_G = 1.0111e-05 | Loss_ODE = 3.9751e-03 | Loss_total = 1.4086e-05
Iteration  2000 | Loss_G = 6.8381e-06 | Loss_ODE = 3.1897e-03 | Loss_total = 1.0028e-05
Iteration  3000 | Loss_G = 6.4985e-06 | Loss_ODE = 2.6573e-03 | Loss_total = 9.1558e-06
Iteration  4000 | Loss_G = 5.4986e-06 | Loss_ODE = 2.1907e-03 | Loss_total = 7.6893e-06
Iteration  5000 | Loss_G = 4.1576e-06 | Loss_ODE = 1.7605e-03 | Loss_total = 5.9180e-06

k 14 â”‚ L1=1.542e-01 â”‚ L2=4.588e-02 â”‚ Lâˆž=2.387e-02
Precomputing generator trajectories...
Precomputed 16 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (6/64 done, idx=8)...
High failure rate (6/8), Ns_sol=8, retraining HJB...
Iteration     0: Loss = 1.8040e-02
Iteration  1000: Loss = 7.1850e-05

Solving BVP batch (8/64 done, idx=16)...
High failure rate (4/8), Ns_sol=12, retraining HJB...
Iteration     0: Loss = 1.5510e-02
Iteration  1000: Loss = 1.6223e-04

Solving BVP batch (12/64 done, idx=24)...
High failure rate (4/8), Ns_sol=16, retraining HJB...
Iteration     0: Loss = 1.5145e-02
Iteration  1000: Loss = 8.7027e-05

Solving BVP batch (16/64 done, idx=32)...Solving BVP batch (23/64 done, idx=40)...
High failure rate (5/8), Ns_sol=26, retraining HJB...
Iteration     0: Loss = 1.3304e-02
Iteration  1000: Loss = 9.9871e-05

Solving BVP batch (26/64 done, idx=48)...Solving BVP batch (31/64 done, idx=56)...Solving BVP batch (37/64 done, idx=64)...Solving BVP batch (42/64 done, idx=72)...Solving BVP batch (47/64 done, idx=80)...Solving BVP batch (53/64 done, idx=88)...Solving BVP batch (59/64 done, idx=96)...Solving BVP batch (63/64 done, idx=101)...
Generated 53665 data from 64 BVP solutions in 807.7 sec
Total failures: 38, HJB retrains: 4


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 2.3211e-04, Loss_V_x = 3.1968e-03, Loss_HJB = 5.9174e-02, Loss_total = 6.2603e-02
Iteration  1000: Loss_V = 1.7666e-05, Loss_V_x = 4.1638e-04, Loss_HJB = 1.5740e-04, Loss_total = 5.9145e-04
Iteration  2000: Loss_V = 1.3227e-05, Loss_V_x = 3.2484e-04, Loss_HJB = 7.5306e-05, Loss_total = 4.1338e-04
Iteration  3000: Loss_V = 1.1423e-05, Loss_V_x = 2.8224e-04, Loss_HJB = 4.3808e-05, Loss_total = 3.3747e-04
Iteration  4000: Loss_V = 1.0353e-05, Loss_V_x = 2.5307e-04, Loss_HJB = 2.9536e-05, Loss_total = 2.9296e-04
Iteration  5000: Loss_V = 9.5638e-06, Loss_V_x = 2.3024e-04, Loss_HJB = 2.2524e-05, Loss_total = 2.6233e-04

[1;32mExploitability: 0.214395[0m
Step Time: 5174.3 sec


>>> Computing Best Response 15...

Precomputing generator trajectories...
Precomputed 16 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (4/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 1.2966e-02
Iteration  1000: Loss = 1.4269e-04

Solving BVP batch (4/64 done, idx=8)...Solving BVP batch (9/64 done, idx=16)...
High failure rate (4/8), Ns_sol=13, retraining HJB...
Iteration     0: Loss = 1.2001e-02
Iteration  1000: Loss = 1.0093e-04

Solving BVP batch (13/64 done, idx=24)...Solving BVP batch (19/64 done, idx=32)...Solving BVP batch (25/64 done, idx=40)...
High failure rate (4/8), Ns_sol=29, retraining HJB...
Iteration     0: Loss = 1.4485e-02
Iteration  1000: Loss = 7.2457e-05

Solving BVP batch (29/64 done, idx=48)...
High failure rate (6/8), Ns_sol=31, retraining HJB...
Iteration     0: Loss = 1.5341e-02
Iteration  1000: Loss = 5.9047e-05

Solving BVP batch (31/64 done, idx=56)...Solving BVP batch (36/64 done, idx=64)...Solving BVP batch (42/64 done, idx=72)...Solving BVP batch (47/64 done, idx=80)...Solving BVP batch (51/64 done, idx=88)...Solving BVP batch (54/64 done, idx=96)...Solving BVP batch (58/64 done, idx=104)...Solving BVP batch (60/64 done, idx=110)...Solving BVP batch (62/64 done, idx=114)...Solving BVP batch (63/64 done, idx=116)...
Generated 45459 data from 64 BVP solutions in 11031.0 sec
Total failures: 53, HJB retrains: 4


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 7.1729e-04, Loss_V_x = 3.6997e-03, Loss_HJB = 9.1957e-03, Loss_total = 1.3613e-02
Iteration  1000: Loss_V = 2.0232e-05, Loss_V_x = 3.0109e-04, Loss_HJB = 9.5619e-05, Loss_total = 4.1695e-04
Iteration  2000: Loss_V = 1.4572e-05, Loss_V_x = 2.4929e-04, Loss_HJB = 3.9026e-05, Loss_total = 3.0288e-04
Iteration  3000: Loss_V = 1.2682e-05, Loss_V_x = 2.2508e-04, Loss_HJB = 2.4306e-05, Loss_total = 2.6206e-04
Iteration  4000: Loss_V = 1.1142e-05, Loss_V_x = 2.1004e-04, Loss_HJB = 1.6203e-05, Loss_total = 2.3739e-04
Iteration  5000: Loss_V = 1.0485e-05, Loss_V_x = 1.9908e-04, Loss_HJB = 1.2667e-05, Loss_total = 2.2223e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 47.6 sec.

Iteration     0 | Loss_G = 2.5492e-03 | Loss_ODE = 2.6121e-02 | Loss_total = 2.5753e-03
Iteration  1000 | Loss_G = 1.0861e-05 | Loss_ODE = 4.7814e-03 | Loss_total = 1.5643e-05
Iteration  2000 | Loss_G = 7.3909e-06 | Loss_ODE = 3.2531e-03 | Loss_total = 1.0644e-05
Iteration  3000 | Loss_G = 5.7733e-06 | Loss_ODE = 2.3697e-03 | Loss_total = 8.1430e-06
Iteration  4000 | Loss_G = 5.2948e-06 | Loss_ODE = 2.4112e-03 | Loss_total = 7.7060e-06
Iteration  5000 | Loss_G = 4.3486e-06 | Loss_ODE = 1.8852e-03 | Loss_total = 6.2339e-06

k 15 â”‚ L1=1.760e-01 â”‚ L2=4.747e-02 â”‚ Lâˆž=2.234e-02
Precomputing generator trajectories...
Precomputed 17 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (5/8), Ns_sol=3, retraining HJB...
Iteration     0: Loss = 1.2770e-02
Iteration  1000: Loss = 1.0145e-04

Solving BVP batch (3/64 done, idx=8)...Solving BVP batch (9/64 done, idx=16)...Solving BVP batch (16/64 done, idx=24)...Solving BVP batch (23/64 done, idx=32)...Solving BVP batch (29/64 done, idx=40)...Solving BVP batch (34/64 done, idx=48)...Solving BVP batch (40/64 done, idx=56)...Solving BVP batch (47/64 done, idx=64)...Solving BVP batch (54/64 done, idx=72)...Solving BVP batch (58/64 done, idx=80)...Solving BVP batch (63/64 done, idx=86)...Solving BVP batch (63/64 done, idx=87)...Solving BVP batch (63/64 done, idx=88)...
Generated 30712 data from 64 BVP solutions in 537.0 sec
Total failures: 25, HJB retrains: 1


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 3.6954e-04, Loss_V_x = 2.6092e-03, Loss_HJB = 1.3062e-02, Loss_total = 1.6041e-02
Iteration  1000: Loss_V = 1.5389e-05, Loss_V_x = 3.3850e-04, Loss_HJB = 1.1395e-04, Loss_total = 4.6784e-04
Iteration  2000: Loss_V = 1.3615e-05, Loss_V_x = 2.6517e-04, Loss_HJB = 4.2346e-05, Loss_total = 3.2113e-04
Iteration  3000: Loss_V = 1.7574e-05, Loss_V_x = 2.2994e-04, Loss_HJB = 5.1952e-05, Loss_total = 2.9947e-04
Iteration  4000: Loss_V = 1.3896e-05, Loss_V_x = 2.0816e-04, Loss_HJB = 2.8593e-05, Loss_total = 2.5065e-04
Iteration  5000: Loss_V = 1.0927e-05, Loss_V_x = 1.9322e-04, Loss_HJB = 2.2606e-05, Loss_total = 2.2675e-04

[1;32mExploitability: 0.136818[0m
Step Time: 12014.4 sec


>>> Computing Best Response 16...

Precomputing generator trajectories...
Precomputed 17 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (13/64 done, idx=16)...Solving BVP batch (18/64 done, idx=24)...Solving BVP batch (24/64 done, idx=32)...Solving BVP batch (29/64 done, idx=40)...Solving BVP batch (37/64 done, idx=48)...Solving BVP batch (42/64 done, idx=56)...Solving BVP batch (49/64 done, idx=64)...Solving BVP batch (55/64 done, idx=72)...Solving BVP batch (62/64 done, idx=80)...Solving BVP batch (63/64 done, idx=82)...
Generated 28514 data from 64 BVP solutions in 5918.7 sec
Total failures: 19, HJB retrains: 0


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 6.5647e-04, Loss_V_x = 1.1752e-03, Loss_HJB = 3.1427e-02, Loss_total = 3.3258e-02
Iteration  1000: Loss_V = 2.0821e-05, Loss_V_x = 3.6677e-04, Loss_HJB = 1.7677e-04, Loss_total = 5.6435e-04
Iteration  2000: Loss_V = 1.3663e-05, Loss_V_x = 2.8760e-04, Loss_HJB = 8.4377e-05, Loss_total = 3.8564e-04
Iteration  3000: Loss_V = 1.1857e-05, Loss_V_x = 2.4850e-04, Loss_HJB = 5.2964e-05, Loss_total = 3.1332e-04
Iteration  4000: Loss_V = 1.1826e-05, Loss_V_x = 2.2197e-04, Loss_HJB = 5.9609e-05, Loss_total = 2.9340e-04
Iteration  5000: Loss_V = 1.0187e-05, Loss_V_x = 2.0388e-04, Loss_HJB = 2.6350e-05, Loss_total = 2.4042e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 47.7 sec.

Iteration     0 | Loss_G = 2.9089e-03 | Loss_ODE = 3.2666e-02 | Loss_total = 2.9416e-03
Iteration  1000 | Loss_G = 1.0645e-05 | Loss_ODE = 4.6188e-03 | Loss_total = 1.5264e-05
Iteration  2000 | Loss_G = 6.7712e-06 | Loss_ODE = 3.0100e-03 | Loss_total = 9.7812e-06
Iteration  3000 | Loss_G = 5.3810e-06 | Loss_ODE = 2.4247e-03 | Loss_total = 7.8057e-06
Iteration  4000 | Loss_G = 4.4164e-06 | Loss_ODE = 2.1839e-03 | Loss_total = 6.6003e-06
Iteration  5000 | Loss_G = 3.9042e-06 | Loss_ODE = 1.7837e-03 | Loss_total = 5.6879e-06

k 16 â”‚ L1=1.088e-01 â”‚ L2=3.523e-02 â”‚ Lâˆž=2.039e-02
Precomputing generator trajectories...
Precomputed 18 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (4/8), Ns_sol=4, retraining HJB...
Iteration     0: Loss = 2.0594e-02
Iteration  1000: Loss = 6.4571e-05

Solving BVP batch (4/64 done, idx=8)...Solving BVP batch (9/64 done, idx=16)...
High failure rate (4/8), Ns_sol=13, retraining HJB...
Iteration     0: Loss = 3.1755e-02
Iteration  1000: Loss = 1.1273e-04

Solving BVP batch (13/64 done, idx=24)...Solving BVP batch (18/64 done, idx=32)...Solving BVP batch (24/64 done, idx=40)...
High failure rate (4/8), Ns_sol=28, retraining HJB...
Iteration     0: Loss = 2.3465e-02
Iteration  1000: Loss = 9.7549e-05

Solving BVP batch (28/64 done, idx=48)...Solving BVP batch (34/64 done, idx=56)...Solving BVP batch (40/64 done, idx=64)...Solving BVP batch (47/64 done, idx=72)...Solving BVP batch (51/64 done, idx=80)...Solving BVP batch (54/64 done, idx=88)...Solving BVP batch (61/64 done, idx=96)...Solving BVP batch (63/64 done, idx=99)...Solving BVP batch (63/64 done, idx=100)...
Generated 38515 data from 64 BVP solutions in 762.6 sec
Total failures: 37, HJB retrains: 3


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 5.5481e-04, Loss_V_x = 5.7863e-03, Loss_HJB = 1.8853e-02, Loss_total = 2.5194e-02
Iteration  1000: Loss_V = 2.2035e-05, Loss_V_x = 3.7399e-04, Loss_HJB = 1.9246e-04, Loss_total = 5.8849e-04
Iteration  2000: Loss_V = 1.5027e-05, Loss_V_x = 2.9739e-04, Loss_HJB = 8.8111e-05, Loss_total = 4.0053e-04
Iteration  3000: Loss_V = 1.2383e-05, Loss_V_x = 2.5081e-04, Loss_HJB = 5.2646e-05, Loss_total = 3.1584e-04
Iteration  4000: Loss_V = 1.0988e-05, Loss_V_x = 2.1735e-04, Loss_HJB = 3.4614e-05, Loss_total = 2.6295e-04
Iteration  5000: Loss_V = 9.6280e-06, Loss_V_x = 1.9392e-04, Loss_HJB = 2.5777e-05, Loss_total = 2.2933e-04

[1;32mExploitability: 0.098679[0m
Step Time: 7142.1 sec


>>> Computing Best Response 17...

Precomputing generator trajectories...
Precomputed 18 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (6/64 done, idx=8)...Solving BVP batch (13/64 done, idx=16)...Solving BVP batch (20/64 done, idx=24)...Solving BVP batch (26/64 done, idx=32)...Solving BVP batch (31/64 done, idx=40)...Solving BVP batch (37/64 done, idx=48)...
High failure rate (4/8), Ns_sol=41, retraining HJB...
Iteration     0: Loss = 1.7362e-02
Iteration  1000: Loss = 8.0576e-05

Solving BVP batch (41/64 done, idx=56)...Solving BVP batch (45/64 done, idx=64)...Solving BVP batch (48/64 done, idx=72)...Solving BVP batch (51/64 done, idx=80)...Solving BVP batch (56/64 done, idx=88)...Solving BVP batch (62/64 done, idx=96)...
Generated 20426 data from 64 BVP solutions in 7515.5 sec
Total failures: 34, HJB retrains: 1


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 2.9220e-03, Loss_V_x = 5.9253e-03, Loss_HJB = 1.4546e-02, Loss_total = 2.3393e-02
Iteration  1000: Loss_V = 3.1085e-05, Loss_V_x = 2.9721e-04, Loss_HJB = 1.3730e-04, Loss_total = 4.6559e-04
Iteration  2000: Loss_V = 1.8749e-05, Loss_V_x = 2.3300e-04, Loss_HJB = 6.5930e-05, Loss_total = 3.1768e-04
Iteration  3000: Loss_V = 1.4169e-05, Loss_V_x = 1.9906e-04, Loss_HJB = 4.2655e-05, Loss_total = 2.5588e-04
Iteration  4000: Loss_V = 1.6480e-05, Loss_V_x = 1.7832e-04, Loss_HJB = 7.7867e-05, Loss_total = 2.7266e-04
Iteration  5000: Loss_V = 2.2073e-05, Loss_V_x = 1.9239e-04, Loss_HJB = 1.0537e-04, Loss_total = 3.1984e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 45.6 sec.

Iteration     0 | Loss_G = 2.7566e-03 | Loss_ODE = 1.2719e-02 | Loss_total = 2.7693e-03
Iteration  1000 | Loss_G = 8.9775e-06 | Loss_ODE = 3.6887e-03 | Loss_total = 1.2666e-05
Iteration  2000 | Loss_G = 5.9258e-06 | Loss_ODE = 3.0828e-03 | Loss_total = 9.0086e-06
Iteration  3000 | Loss_G = 4.4230e-06 | Loss_ODE = 2.0093e-03 | Loss_total = 6.4323e-06
Iteration  4000 | Loss_G = 3.7373e-06 | Loss_ODE = 1.4420e-03 | Loss_total = 5.1793e-06
Iteration  5000 | Loss_G = 4.2462e-06 | Loss_ODE = 1.3105e-03 | Loss_total = 5.5567e-06

k 17 â”‚ L1=2.217e-01 â”‚ L2=5.681e-02 â”‚ Lâˆž=2.142e-02
Precomputing generator trajectories...
Precomputed 19 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (12/64 done, idx=16)...
High failure rate (5/8), Ns_sol=15, retraining HJB...
Iteration     0: Loss = 1.5913e-02
Iteration  1000: Loss = 9.7808e-05

Solving BVP batch (15/64 done, idx=24)...Solving BVP batch (22/64 done, idx=32)...Solving BVP batch (29/64 done, idx=40)...Solving BVP batch (34/64 done, idx=48)...Solving BVP batch (39/64 done, idx=56)...
High failure rate (4/8), Ns_sol=43, retraining HJB...
Iteration     0: Loss = 1.5094e-02
Iteration  1000: Loss = 1.5561e-04

Solving BVP batch (43/64 done, idx=64)...Solving BVP batch (48/64 done, idx=72)...Solving BVP batch (54/64 done, idx=80)...Solving BVP batch (57/64 done, idx=88)...Solving BVP batch (63/64 done, idx=95)...
Generated 55555 data from 64 BVP solutions in 693.2 sec
Total failures: 32, HJB retrains: 2


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 2.4066e-03, Loss_V_x = 7.9306e-03, Loss_HJB = 1.9619e-02, Loss_total = 2.9956e-02
Iteration  1000: Loss_V = 5.9297e-05, Loss_V_x = 4.5383e-04, Loss_HJB = 1.5591e-04, Loss_total = 6.6904e-04
Iteration  2000: Loss_V = 4.4504e-05, Loss_V_x = 3.7136e-04, Loss_HJB = 7.1619e-05, Loss_total = 4.8748e-04
Iteration  3000: Loss_V = 3.6738e-05, Loss_V_x = 3.2701e-04, Loss_HJB = 4.9880e-05, Loss_total = 4.1363e-04
Iteration  4000: Loss_V = 3.3182e-05, Loss_V_x = 2.9527e-04, Loss_HJB = 3.5963e-05, Loss_total = 3.6442e-04
Iteration  5000: Loss_V = 3.2890e-05, Loss_V_x = 2.7353e-04, Loss_HJB = 7.0599e-05, Loss_total = 3.7702e-04

[1;32mExploitability: 0.088938[0m
Step Time: 8685.4 sec


>>> Computing Best Response 18...

Precomputing generator trajectories...
Precomputed 19 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (6/64 done, idx=8)...Solving BVP batch (12/64 done, idx=16)...Solving BVP batch (20/64 done, idx=24)...Solving BVP batch (25/64 done, idx=32)...Solving BVP batch (32/64 done, idx=40)...Solving BVP batch (39/64 done, idx=48)...Solving BVP batch (44/64 done, idx=56)...Solving BVP batch (48/64 done, idx=64)...Solving BVP batch (53/64 done, idx=72)...Solving BVP batch (61/64 done, idx=80)...
Generated 28433 data from 64 BVP solutions in 5269.8 sec
Total failures: 19, HJB retrains: 0


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 5.5251e-04, Loss_V_x = 1.3056e-03, Loss_HJB = 1.7950e-02, Loss_total = 1.9808e-02
Iteration  1000: Loss_V = 1.9029e-05, Loss_V_x = 3.0245e-04, Loss_HJB = 1.3729e-04, Loss_total = 4.5878e-04
Iteration  2000: Loss_V = 1.2515e-05, Loss_V_x = 2.3682e-04, Loss_HJB = 4.6032e-05, Loss_total = 2.9537e-04
Iteration  3000: Loss_V = 1.0215e-05, Loss_V_x = 2.0834e-04, Loss_HJB = 2.4491e-05, Loss_total = 2.4304e-04
Iteration  4000: Loss_V = 9.1407e-06, Loss_V_x = 1.9016e-04, Loss_HJB = 1.4584e-05, Loss_total = 2.1388e-04
Iteration  5000: Loss_V = 8.3948e-06, Loss_V_x = 1.7720e-04, Loss_HJB = 1.0201e-05, Loss_total = 1.9580e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 49.2 sec.

Iteration     0 | Loss_G = 2.9642e-03 | Loss_ODE = 2.5539e-02 | Loss_total = 2.9897e-03
Iteration  1000 | Loss_G = 9.4897e-06 | Loss_ODE = 5.0857e-03 | Loss_total = 1.4575e-05
Iteration  2000 | Loss_G = 7.6616e-06 | Loss_ODE = 2.7759e-03 | Loss_total = 1.0438e-05
Iteration  3000 | Loss_G = 4.7329e-06 | Loss_ODE = 1.8823e-03 | Loss_total = 6.6152e-06
Iteration  4000 | Loss_G = 3.8888e-06 | Loss_ODE = 1.9182e-03 | Loss_total = 5.8071e-06
Iteration  5000 | Loss_G = 3.7124e-06 | Loss_ODE = 1.6007e-03 | Loss_total = 5.3132e-06

k 18 â”‚ L1=1.135e-01 â”‚ L2=3.469e-02 â”‚ Lâˆž=1.864e-02
Precomputing generator trajectories...
Precomputed 20 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...
High failure rate (5/8), Ns_sol=3, retraining HJB...
Iteration     0: Loss = 2.2098e-02
Iteration  1000: Loss = 7.1099e-05

Solving BVP batch (3/64 done, idx=8)...Solving BVP batch (9/64 done, idx=16)...Solving BVP batch (14/64 done, idx=24)...
High failure rate (4/8), Ns_sol=18, retraining HJB...
Iteration     0: Loss = 3.9109e-02
Iteration  1000: Loss = 8.2314e-05

Solving BVP batch (18/64 done, idx=32)...Solving BVP batch (25/64 done, idx=40)...Solving BVP batch (30/64 done, idx=48)...Solving BVP batch (36/64 done, idx=56)...
High failure rate (5/8), Ns_sol=39, retraining HJB...
Iteration     0: Loss = 2.0067e-02
Iteration  1000: Loss = 5.7485e-05

Solving BVP batch (39/64 done, idx=64)...Solving BVP batch (45/64 done, idx=72)...Solving BVP batch (49/64 done, idx=80)...Solving BVP batch (53/64 done, idx=88)...Solving BVP batch (56/64 done, idx=96)...Solving BVP batch (62/64 done, idx=104)...Solving BVP batch (63/64 done, idx=106)...
Generated 34843 data from 64 BVP solutions in 871.2 sec
Total failures: 43, HJB retrains: 3


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 3.8671e-04, Loss_V_x = 3.6326e-03, Loss_HJB = 1.1791e-02, Loss_total = 1.5810e-02
Iteration  1000: Loss_V = 2.4686e-05, Loss_V_x = 3.7627e-04, Loss_HJB = 2.0142e-04, Loss_total = 6.0238e-04
Iteration  2000: Loss_V = 1.6641e-05, Loss_V_x = 2.8359e-04, Loss_HJB = 9.5602e-05, Loss_total = 3.9583e-04
Iteration  3000: Loss_V = 1.3016e-05, Loss_V_x = 2.3463e-04, Loss_HJB = 5.4403e-05, Loss_total = 3.0204e-04
Iteration  4000: Loss_V = 1.0599e-05, Loss_V_x = 2.0438e-04, Loss_HJB = 3.3139e-05, Loss_total = 2.4812e-04
Iteration  5000: Loss_V = 1.4821e-05, Loss_V_x = 1.8623e-04, Loss_HJB = 1.0180e-04, Loss_total = 3.0285e-04

[1;32mExploitability: 0.136063[0m
Step Time: 6637.4 sec


>>> Computing Best Response 19...

Precomputing generator trajectories...
Precomputed 20 generator trajectories on 51 time points.

Training V1 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (7/64 done, idx=8)...Solving BVP batch (12/64 done, idx=16)...
High failure rate (4/8), Ns_sol=16, retraining HJB...
Iteration     0: Loss = 2.1676e-02
Iteration  1000: Loss = 1.1165e-04

Solving BVP batch (16/64 done, idx=24)...Solving BVP batch (23/64 done, idx=32)...Solving BVP batch (28/64 done, idx=40)...
High failure rate (5/8), Ns_sol=31, retraining HJB...
Iteration     0: Loss = 7.8238e-03
Iteration  1000: Loss = 6.7553e-05

Solving BVP batch (31/64 done, idx=48)...Solving BVP batch (37/64 done, idx=56)...
High failure rate (4/8), Ns_sol=41, retraining HJB...
Iteration     0: Loss = 1.4416e-02
Iteration  1000: Loss = 4.8209e-05

Solving BVP batch (41/64 done, idx=64)...
High failure rate (5/8), Ns_sol=44, retraining HJB...
Iteration     0: Loss = 1.4470e-02
Iteration  1000: Loss = 8.7524e-05

Solving BVP batch (44/64 done, idx=72)...Solving BVP batch (51/64 done, idx=80)...Solving BVP batch (55/64 done, idx=88)...Solving BVP batch (59/64 done, idx=96)...Solving BVP batch (63/64 done, idx=101)...Solving BVP batch (63/64 done, idx=102)...
Generated 29729 data from 64 BVP solutions in 9440.0 sec
Total failures: 39, HJB retrains: 4


Training V1 via BVP Approximation...

Iteration     0: Loss_V = 7.3685e-04, Loss_V_x = 4.4400e-03, Loss_HJB = 3.5393e-02, Loss_total = 4.0570e-02
Iteration  1000: Loss_V = 2.8954e-05, Loss_V_x = 3.1577e-04, Loss_HJB = 1.5878e-04, Loss_total = 5.0350e-04
Iteration  2000: Loss_V = 2.0377e-05, Loss_V_x = 2.5770e-04, Loss_HJB = 6.4623e-05, Loss_total = 3.4270e-04
Iteration  3000: Loss_V = 1.7473e-05, Loss_V_x = 2.3203e-04, Loss_HJB = 3.9331e-05, Loss_total = 2.8883e-04
Iteration  4000: Loss_V = 1.5654e-05, Loss_V_x = 2.1509e-04, Loss_HJB = 2.7950e-05, Loss_total = 2.5870e-04
Iteration  5000: Loss_V = 1.4421e-05, Loss_V_x = 2.0191e-04, Loss_HJB = 2.8107e-05, Loss_total = 2.4444e-04

Generating data via closed-loop simulation...
Solving IVP #1...Solving IVP #2...Solving IVP #3...Solving IVP #4...Solving IVP #5...Solving IVP #6...Solving IVP #7...Solving IVP #8...Solving IVP #9...Solving IVP #10...Solving IVP #11...Solving IVP #12...Solving IVP #13...Solving IVP #14...Solving IVP #15...Solving IVP #16...Solving IVP #17...Solving IVP #18...Solving IVP #19...Solving IVP #20...Solving IVP #21...Solving IVP #22...Solving IVP #23...Solving IVP #24...Solving IVP #25...Solving IVP #26...Solving IVP #27...Solving IVP #28...Solving IVP #29...Solving IVP #30...Solving IVP #31...Solving IVP #32...Solving IVP #33...Solving IVP #34...Solving IVP #35...Solving IVP #36...Solving IVP #37...Solving IVP #38...Solving IVP #39...Solving IVP #40...Solving IVP #41...Solving IVP #42...Solving IVP #43...Solving IVP #44...Solving IVP #45...Solving IVP #46...Solving IVP #47...Solving IVP #48...Solving IVP #49...Solving IVP #50...Solving IVP #51...Solving IVP #52...Solving IVP #53...Solving IVP #54...Solving IVP #55...Solving IVP #56...Solving IVP #57...Solving IVP #58...Solving IVP #59...Solving IVP #60...Solving IVP #61...Solving IVP #62...Solving IVP #63...Solving IVP #64...Solving IVP #65...Solving IVP #66...Solving IVP #67...Solving IVP #68...Solving IVP #69...Solving IVP #70...Solving IVP #71...Solving IVP #72...Solving IVP #73...Solving IVP #74...Solving IVP #75...Solving IVP #76...Solving IVP #77...Solving IVP #78...Solving IVP #79...Solving IVP #80...Solving IVP #81...Solving IVP #82...Solving IVP #83...Solving IVP #84...Solving IVP #85...Solving IVP #86...Solving IVP #87...Solving IVP #88...Solving IVP #89...Solving IVP #90...Solving IVP #91...Solving IVP #92...Solving IVP #93...Solving IVP #94...Solving IVP #95...Solving IVP #96...Solving IVP #97...Solving IVP #98...Solving IVP #99...Solving IVP #100...Solving IVP #101...Solving IVP #102...Solving IVP #103...Solving IVP #104...Solving IVP #105...Solving IVP #106...Solving IVP #107...Solving IVP #108...Solving IVP #109...Solving IVP #110...Solving IVP #111...Solving IVP #112...Solving IVP #113...Solving IVP #114...Solving IVP #115...Solving IVP #116...Solving IVP #117...Solving IVP #118...Solving IVP #119...Solving IVP #120...Solving IVP #121...Solving IVP #122...Solving IVP #123...Solving IVP #124...Solving IVP #125...Solving IVP #126...Solving IVP #127...Solving IVP #128...Solving IVP #129...Solving IVP #130...Solving IVP #131...Solving IVP #132...Solving IVP #133...Solving IVP #134...Solving IVP #135...Solving IVP #136...Solving IVP #137...Solving IVP #138...Solving IVP #139...Solving IVP #140...Solving IVP #141...Solving IVP #142...Solving IVP #143...Solving IVP #144...Solving IVP #145...Solving IVP #146...Solving IVP #147...Solving IVP #148...Solving IVP #149...Solving IVP #150...Solving IVP #151...Solving IVP #152...Solving IVP #153...Solving IVP #154...Solving IVP #155...Solving IVP #156...Solving IVP #157...Solving IVP #158...Solving IVP #159...Solving IVP #160...Solving IVP #161...Solving IVP #162...Solving IVP #163...Solving IVP #164...Solving IVP #165...Solving IVP #166...Solving IVP #167...Solving IVP #168...Solving IVP #169...Solving IVP #170...Solving IVP #171...Solving IVP #172...Solving IVP #173...Solving IVP #174...Solving IVP #175...Solving IVP #176...Solving IVP #177...Solving IVP #178...Solving IVP #179...Solving IVP #180...Solving IVP #181...Solving IVP #182...Solving IVP #183...Solving IVP #184...Solving IVP #185...Solving IVP #186...Solving IVP #187...Solving IVP #188...Solving IVP #189...Solving IVP #190...Solving IVP #191...Solving IVP #192...Solving IVP #193...Solving IVP #194...Solving IVP #195...Solving IVP #196...Solving IVP #197...Solving IVP #198...Solving IVP #199...Solving IVP #200...Solving IVP #201...Solving IVP #202...Solving IVP #203...Solving IVP #204...Solving IVP #205...Solving IVP #206...Solving IVP #207...Solving IVP #208...Solving IVP #209...Solving IVP #210...Solving IVP #211...Solving IVP #212...Solving IVP #213...Solving IVP #214...Solving IVP #215...Solving IVP #216...Solving IVP #217...Solving IVP #218...Solving IVP #219...Solving IVP #220...Solving IVP #221...Solving IVP #222...Solving IVP #223...Solving IVP #224...Solving IVP #225...Solving IVP #226...Solving IVP #227...Solving IVP #228...Solving IVP #229...Solving IVP #230...Solving IVP #231...Solving IVP #232...Solving IVP #233...Solving IVP #234...Solving IVP #235...Solving IVP #236...Solving IVP #237...Solving IVP #238...Solving IVP #239...Solving IVP #240...Solving IVP #241...Solving IVP #242...Solving IVP #243...Solving IVP #244...Solving IVP #245...Solving IVP #246...Solving IVP #247...Solving IVP #248...Solving IVP #249...Solving IVP #250...Solving IVP #251...Solving IVP #252...Solving IVP #253...Solving IVP #254...Solving IVP #255...Solving IVP #256...Generated 5376 points from 256 IVP solutions in 44.6 sec.

Iteration     0 | Loss_G = 1.1894e-03 | Loss_ODE = 2.4056e-02 | Loss_total = 1.2135e-03
Iteration  1000 | Loss_G = 7.0482e-06 | Loss_ODE = 2.9457e-03 | Loss_total = 9.9939e-06
Iteration  2000 | Loss_G = 5.0520e-06 | Loss_ODE = 2.3092e-03 | Loss_total = 7.3612e-06
Iteration  3000 | Loss_G = 3.8290e-06 | Loss_ODE = 1.6286e-03 | Loss_total = 5.4576e-06
Iteration  4000 | Loss_G = 3.8866e-06 | Loss_ODE = 1.2964e-03 | Loss_total = 5.1830e-06
Iteration  5000 | Loss_G = 3.7746e-06 | Loss_ODE = 1.2823e-03 | Loss_total = 5.0569e-06

k 19 â”‚ L1=1.356e-01 â”‚ L2=3.743e-02 â”‚ Lâˆž=1.801e-02
Precomputing generator trajectories...
Precomputed 21 generator trajectories on 51 time points.

Training V2 via HJB...

Generating data (parallel)...
Solving BVP batch (0/64 done, idx=0)...Solving BVP batch (5/64 done, idx=8)...Solving BVP batch (10/64 done, idx=16)...Solving BVP batch (15/64 done, idx=24)...Solving BVP batch (20/64 done, idx=32)...Solving BVP batch (27/64 done, idx=40)...Solving BVP batch (33/64 done, idx=48)...
High failure rate (4/8), Ns_sol=37, retraining HJB...
Iteration     0: Loss = 1.2481e-02
Iteration  1000: Loss = 6.8052e-05

Solving BVP batch (37/64 done, idx=56)...Solving BVP batch (45/64 done, idx=64)...Solving BVP batch (51/64 done, idx=72)...Solving BVP batch (57/64 done, idx=80)...Solving BVP batch (62/64 done, idx=87)...
Generated 25138 data from 64 BVP solutions in 490.7 sec
Total failures: 25, HJB retrains: 1


Training V2 via BVP Approximation...

Iteration     0: Loss_V = 9.7290e-04, Loss_V_x = 3.1256e-03, Loss_HJB = 1.3848e-02, Loss_total = 1.7946e-02
Iteration  1000: Loss_V = 3.8434e-05, Loss_V_x = 3.2712e-04, Loss_HJB = 1.3375e-04, Loss_total = 4.9931e-04
Iteration  2000: Loss_V = 3.4992e-05, Loss_V_x = 2.7512e-04, Loss_HJB = 5.8348e-05, Loss_total = 3.6846e-04
Iteration  3000: Loss_V = 3.1016e-05, Loss_V_x = 2.4475e-04, Loss_HJB = 3.7572e-05, Loss_total = 3.1333e-04
Iteration  4000: Loss_V = 2.9029e-05, Loss_V_x = 2.2537e-04, Loss_HJB = 2.6963e-05, Loss_total = 2.8136e-04
Iteration  5000: Loss_V = 2.7508e-05, Loss_V_x = 2.1081e-04, Loss_HJB = 2.3747e-05, Loss_total = 2.6207e-04

[1;32mExploitability: 0.083636[0m
Step Time: 10433.3 sec

